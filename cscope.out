cscope 16 E:\GitHub\ChromeFuzzer               0000337574
	@E:\GitHub\ChromeFuzzer\PocSmplify\GrayHatPython-master\ghpython_src\src\addnum.cpp

1 
	~<°dlib.h
>

2 
	~<°dio.h
>

3 
	~<wödows.h
>

5 
	$add_numbî
–
num1
, 
num2
 )

7 
sum
;

9 
sum
 = 
num1
 - 
num2
;

11  
sum
;

12 
	}
}

14 
	$maö
(
¨gc
, * 
¨gv
[])

16 
num1
, 
num2
;

17 
ªtu∫_vÆue
;

19 if–
¨gc
 < 2 )

21 
	`¥ötf
("YouÇeedÅoÉnterÅwoÇumbersÅoádd.\n");

22 
	`¥ötf
("addnum.exeÇum1Çum2\n");

27 
num1
 = 
	`©oi
(
¨gv
[1]);

28 
num2
 = 
	`©oi
(
¨gv
[2]);

30 
ªtu∫_vÆue
 = 
	`add_numbî
–
num1
, 
num2
 );

32 
	`¥ötf
("Sum o‡%d + %d = %d",
num1
, 
num2
, 
ªtu∫_vÆue
 );

35 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\GrayHatPython-master\ghpython_src\src\ghp_inject.cpp

2 
	~"°dafx.h
"

4 
BOOL
 
APIENTRY
 
	$DŒMaö
–
HMODULE
 
hModuÀ
,

5 
DWORD
 
ul_ªas⁄_f‹_ˇŒ
,

6 
LPVOID
 
ÕRe£rved


9 
ul_ªas⁄_f‹_ˇŒ
)

11 
DLL_PROCESS_ATTACH
:

12 
	`MesßgeBoxA
(
NULL
,"Hñlÿ‰omÅhê¥o˚ss!","Iám insidêthê¥o˚s†you inje˘ed!",
MB_OK
);

13 
DLL_THREAD_ATTACH
:

14 
DLL_THREAD_DETACH
:

15 
DLL_PROCESS_DETACH
:

18  
TRUE
;

19 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\Exception.c

78 
	~<as£π.h
>

79 
	~<°dio.h
>

80 
	~<°dlib.h
>

81 
	~<mach/mach.h
>

82 
	~<±hªad.h
>

83 
	~<uni°d.h
>

84 
	~<°dboﬁ.h
>

89 
	~"MachEx˚±i⁄sSîvî.h
"

91 
	~"Ex˚±i⁄.h
"

92 
	~"im∂emíèti⁄.h
"

94 
	gthªad_id
;

95 
	gex˚±i⁄_code
;

96 
	gex˚±i⁄_©
;

97 
	gex˚±i⁄_ªf
;

100 
	#EXCEPTION_ACCESS_VIOLATION
 0xC0000005

	)

101 
	#EXCEPTION_BREAKPOINT
 0x80000003

	)

102 
	#EXCEPTION_GUARD_PAGE
 0x80000001

	)

103 
	#EXCEPTION_SINGLE_STEP
 0x80000004

	)

104 
	#EFLAGS_TRAP
 0x00000100

	)

106 
	$XToWöEx˚±i⁄
(
ec
){

107 
ªt
;

108 
ec
){

109 
EXC_BAD_ACCESS
:

110 
ªt
 = 
EXCEPTION_ACCESS_VIOLATION
;

112 
EXC_BREAKPOINT
:

113 
ªt
 = 
EXCEPTION_BREAKPOINT
;

115 
EXCEPTION_SINGLE_STEP
:

116 
ªt
 = 
EXCEPTION_SINGLE_STEP
;

119 
ªt
 = 
EXC_SOFTWARE
;

121  
ªt
;

122 
	}
}

129 
kîn_ªtu∫_t
 
	$ˇtch_ex˚±i⁄_øi£
(

130 
mach_p‹t_t
 
ex˚±i⁄_p‹t
,

131 
mach_p‹t_t
 
thªad
,

132 
mach_p‹t_t
 
èsk
,

133 
ex˚±i⁄_ty≥_t
 
ex˚±i⁄
,

134 
ex˚±i⁄_d©a_t
 
code
,

135 
mach_msg_ty≥_numbî_t
 
codeC¡


138 
	`as£π
(
Ál£
);

139  
KERN_FAILURE
;

165 
	}
}

167 
kîn_ªtu∫_t
 
	$ˇtch_ex˚±i⁄_øi£_°©e
(

168 
mach_p‹t_t
 
ex˚±i⁄_p‹t
,

169 
ex˚±i⁄_ty≥_t
 
ex˚±i⁄
,

170 c⁄° 
ex˚±i⁄_d©a_t
 
code
,

171 
mach_msg_ty≥_numbî_t
 
codeC¡
,

172 * 
Êav‹
,

173 c⁄° 
thªad_°©e_t
 
ﬁd_°©e
,

174 
mach_msg_ty≥_numbî_t
 
ﬁd_°©eC¡
,

175 
thªad_°©e_t
 
√w_°©e
,

176 
mach_msg_ty≥_numbî_t
 *
√w_°©eC¡


179 
	`as£π
(
Ál£
);

180  
KERN_FAILURE
;

181 
	}
}

183 
kîn_ªtu∫_t
 
	$ˇtch_ex˚±i⁄_øi£_°©e_idítôy
(

184 
mach_p‹t_t
 
ex˚±i⁄_p‹t
,

185 
mach_p‹t_t
 
thªad
,

186 
mach_p‹t_t
 
èsk
,

187 
ex˚±i⁄_ty≥_t
 
ex˚±i⁄
,

188 
ex˚±i⁄_d©a_t
 
code
,

189 
mach_msg_ty≥_numbî_t
 
codeC¡
,

190 * 
Êav‹
,

191 
thªad_°©e_t
 
ﬁd_°©e
,

192 
mach_msg_ty≥_numbî_t
 
ﬁd_°©eC¡
,

193 
thªad_°©e_t
 
√w_°©e
,

194 
mach_msg_ty≥_numbî_t
 *
√w_°©eC¡


263 
kîn_ªtu∫_t
 
ªsu…
;

264 
i
;

265 
i386_thªad_°©e_t
 * 
°©e
;

273 
i
 = 0; i < 
codeC¡
; i++) {

283 
	`as£π
–
ﬁd_°©eC¡
 =
i386_THREAD_STATE_COUNT
 );

284 
°©e
 = (
i386_thªad_°©e_t
 *Ë
ﬁd_°©e
;

290 i‡(
ex˚±i⁄
 =
EXC_BREAKPOINT
) {

291 
i386_thªad_°©e_t
 * 
√wSèã
;

297 
	`as£π
–
ﬁd_°©eC¡
 <*
√w_°©eC¡
 );

298 *
√w_°©eC¡
 = 
ﬁd_°©eC¡
;

300 
√wSèã
 = (
i386_thªad_°©e_t
 *Ë
√w_°©e
;

301 *
√wSèã
 = *
°©e
;

303 
	`su•íd_thªad
(
thªad
);

306 
thªad_id
 = 
thªad
;

307 
ex˚±i⁄_code
 = 
ex˚±i⁄
;

309 if(
°©e
->
eÊags
 & 
EFLAGS_TRAP
 || 
code
[0] =
EXC_I386_SGL
){

310 
ex˚±i⁄_code
 = 
EXCEPTION_SINGLE_STEP
;

312 
ex˚±i⁄_©
 = 
°©e
->
eù
 - 1;

313 
thªad_°©e_Êav‹_t
 
Êav‹
 = 
i386_EXCEPTION_STATE
;

314 
mach_msg_ty≥_numbî_t
 
exc_°©e_cou¡
 = 
i386_EXCEPTION_STATE_COUNT
;

315 
i386_ex˚±i⁄_°©e_t
 
exc_°©e
;

316 
	`thªad_gë_°©e
(
thªad
,
Êav‹
, (
«tuøl_t
*)&
exc_°©e
, &
exc_°©e_cou¡
);

317 
ex˚±i⁄_ªf
 = 
exc_°©e
.
Áu…vaddr
;

319 
ªsu…
 = 
KERN_SUCCESS
;

322 } i‡(
ex˚±i⁄
 =
EXC_BAD_ACCESS
){

325 
thªad_id
 = 
thªad
;

326 
ex˚±i⁄_code
 = 
ex˚±i⁄
;

327 
ex˚±i⁄_©
 = 
°©e
->
eù
;

328 
thªad_°©e_Êav‹_t
 
Êav‹
 = 
i386_EXCEPTION_STATE
;

329 
mach_msg_ty≥_numbî_t
 
exc_°©e_cou¡
 = 
i386_EXCEPTION_STATE_COUNT
;

330 
i386_ex˚±i⁄_°©e_t
 
exc_°©e
;

331 
	`thªad_gë_°©e
(
thªad
,
Êav‹
, (
«tuøl_t
*)&
exc_°©e
, &
exc_°©e_cou¡
);

332 
ex˚±i⁄_ªf
 = 
exc_°©e
.
Áu…vaddr
;

333 
ªsu…
 = 
KERN_SUCCESS
;

338 
ªsu…
 = 
KERN_FAILURE
;

343  
ªsu…
;

344 
	}
}

346 
	#MAX_EXCEPTION_PORTS
 16

	)

349 
mach_msg_ty≥_numbî_t
 
cou¡
;

350 
ex˚±i⁄_mask_t
 
masks
[
MAX_EXCEPTION_PORTS
];

351 
ex˚±i⁄_h™dÀr_t
 
p‹ts
[
MAX_EXCEPTION_PORTS
];

352 
ex˚±i⁄_behavi‹_t
 
behavi‹s
[
MAX_EXCEPTION_PORTS
];

353 
thªad_°©e_Êav‹_t
 
Êav‹s
[
MAX_EXCEPTION_PORTS
];

354 } 
ﬁd_exc_p‹ts
;

356 
mach_p‹t_t
 
	$öô
(
pid
){

357 
mach_p‹t_t
 * 
ex˚±i⁄P‹t
 = 
	`mÆloc
((mach_port_t));

358 
mach_p‹t_t
 
me
;

359 
èsk_t
 
èrgëTask
;

360 
ex˚±i⁄_mask_t
 
mask
 = 
EXC_MASK_BAD_ACCESS
 | 
EXC_MASK_BAD_INSTRUCTION
 | 
EXC_MASK_ARITHMETIC
 | 
EXC_MASK_SOFTWARE
 | 
EXC_MASK_BREAKPOINT
 | 
EXC_MASK_SYSCALL
;

368 
me
 = 
	`mach_èsk_£lf
();

369 
	`mach_p‹t_Æloˇã
(
me
, 
MACH_PORT_RIGHT_RECEIVE
, 
ex˚±i⁄P‹t
);

370 
	`mach_p‹t_ö£π_right
(
me
, *
ex˚±i⁄P‹t
, *ex˚±i⁄P‹t, 
MACH_MSG_TYPE_MAKE_SEND
);

373 if(
	`èsk_f‹_pid
(
me
, 
pid
, &
èrgëTask
)!=
KERN_SUCCESS
){

379 
	`èsk_gë_ex˚±i⁄_p‹ts
(
èrgëTask
, 
mask
, 
ﬁd_exc_p‹ts
.
masks
, &ﬁd_exc_p‹ts.
cou¡
, old_exc_p‹ts.
p‹ts
, old_exc_p‹ts.
behavi‹s
, old_exc_p‹ts.
Êav‹s
);

382 
	`èsk_£t_ex˚±i⁄_p‹ts
(
èrgëTask
, 
mask
, *
ex˚±i⁄P‹t
, 
EXCEPTION_STATE_IDENTITY
, 
i386_THREAD_STATE
);

385  *
ex˚±i⁄P‹t
;

386 
	}
}

392 
mach_msg_hódî_t
 
	mhód
;

393 
	md©a
[256];

394 } 
	gª∂y
;

397 
mach_msg_hódî_t
 
	mhód
;

398 
mach_msg_body_t
 
	mmsgh_body
;

399 
	md©a
[1024];

400 } 
	gmsg
;

403 
	$my_msg_£rvî
(
mach_p‹t_t
 
ex˚±i⁄_p‹t
, 
mûli£c⁄ds
, *
id
, *
ec
, *
ót
, *
îef
){

404 
mach_msg_ªtu∫_t
 
r
;

406 
r
 = 
	`mach_msg
(&
msg
.
hód
,

407 
MACH_RCV_MSG
|
MACH_RCV_LARGE
|
MACH_RCV_TIMEOUT
,

409 (
msg
),

410 
ex˚±i⁄_p‹t
,

411 
mûli£c⁄ds
,

412 
MACH_PORT_NULL
);

414 if(
r
 =
MACH_RCV_TIMED_OUT
){

416 } if(
r
 !
MACH_MSG_SUCCESS
){

422 if(!
	`exc_£rvî
(&
msg
.
hód
,&
ª∂y
.head)){

427 *
id
 = 
thªad_id
;

428 *
ec
 = 
	`XToWöEx˚±i⁄
(
ex˚±i⁄_code
);

429 *
ót
 = 
ex˚±i⁄_©
;

430 *
îef
 = 
ex˚±i⁄_ªf
;

434 
r
 = 
	`mach_msg
(

435 &
ª∂y
.
hód
,

436 
MACH_SEND_MSG
|
MACH_SEND_TIMEOUT
,

437 
ª∂y
.
hód
.
msgh_size
,

439 
MACH_PORT_NULL
,

440 
mûli£c⁄ds
,

441 
MACH_PORT_NULL
);

443 if(
r
 =
MACH_SEND_TIMED_OUT
){

445 } if(
r
 !
MACH_MSG_SUCCESS
){

451 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\Exception.h

10 
my_msg_£rvî
(
mach_p‹t_t
 
ex˚±i⁄_p‹t
, 
mûli£c⁄ds
, *
id
, *
ec
, *
ót
, *
îef
);

11 
ˇŒ_msg_£rvî
(
mach_p‹t_t
 
ex˚±i⁄P‹t
);

12 
mach_p‹t_t
 
öô
(
pid
);

13 
XToWöEx˚±i⁄
(
ec
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\MacDll.c

1 
	~<°dio.h
>

2 
	~<sys/ty≥s.h
>

3 
	~<sys/°©.h
>

4 
	~<sys/±ø˚.h
>

5 
	~<°dio.h
>

7 
	~"MacDŒ.h
"

8 
	~"dyld.h
"

10 
	#EXPORT
 
	`__©åibuã__
((
	`visibûôy
("deÁu…")))

	)

13 
mach_p‹t_t
 
	gex˚±i⁄_p‹t
;

14 
	gcuºít_pid
;

15 
BOOL
 
	gkûl_⁄_exô
;

16 
köfo_¥oc
 *
	gköfo
;

17 
	gköfo_max
;

18 
	gköfo_cur
;

19 
thªad_a˘_p‹t_¨øy_t
 
	gthªad_li°
;

20 
mach_msg_ty≥_numbî_t
 
	gthªad_max
;

21 
	gthªad_cur
;

22 
	gÆloˇãd_fs_ba£
;

26 
__©åibuã__
((
c⁄°ru˘‹
))

27 
	$öôülizî
() {

28 
köfo
 = 0;

29 
Æloˇãd_fs_ba£
 = 0;

31 
	}
}

34 
__©åibuã__
((
de°ru˘‹
))

35 
	$föÆizî
() {

37 
	}
}

39 
EXPORT


40 
	$GëSy°emInfo
(
LPSYSTEM_INFO
 
ÕSy°emInfo
){

41 
ho°_«me_p‹t_t
 
myho°
;

42 
ho°_basic_öfo_d©a_t
 
höfo
;

43 
vm_size_t
 
∑ge_size
;

44 
mach_msg_ty≥_numbî_t
 
cou¡
;

46 
myho°
 = 
	`mach_ho°_£lf
();

47 
cou¡
 = 
HOST_BASIC_INFO_COUNT
;

48 
	`ho°_öfo
(
myho°
, 
HOST_BASIC_INFO
, (
ho°_öfo_t
Ë&
höfo
, &
cou¡
);

49 
	`ho°_∑ge_size
(
myho°
, &
∑ge_size
);

51 
ÕSy°emInfo
->
dwPageSize
 = 
∑ge_size
;

52 
ÕSy°emInfo
->
dwNumbîOfPro˚ss‹s
 = 
höfo
.
avaû_˝us
;

54 
	}
}

56 
EXPORT


57 
BOOL
 
	$Clo£H™dÀ
(
HANDLE
 
hObje˘
){

58 if(
köfo
){

59 
	`‰ì
(
köfo
);

60 
köfo
 = 0;

65 
	}
}

67 
EXPORT


68 
BOOL
 
	$DebugA˘ivePro˚ss
(
DWORD
 
dwPro˚ssId
){

69 
kûl_⁄_exô
 = 0;

70 
cuºít_pid
 = 
dwPro˚ssId
;

73 
köfo
 = 0;

74 
Æloˇãd_fs_ba£
 = 0;

76  
	`©èch
(
dwPro˚ssId
, &
ex˚±i⁄_p‹t
);

77 
	}
}

79 
EXPORT


80 
BOOL
 
	$WaôF‹DebugEvít
(
LPDEBUG_EVENT
 
ÕDebugEvít
, 
DWORD
 
dwMûli£c⁄ds
){

81 
ªt
, 
ec
, 
id
;

82 
ót
, 
îef
;

83 
ªt
 = 
	`my_msg_£rvî
(
ex˚±i⁄_p‹t
, 
dwMûli£c⁄ds
, &
id
, &
ec
, &
ót
, &
îef
);

85 
ÕDebugEvít
->
dwThªadId
 = 
id
;

86 
ÕDebugEvít
->
dwDebugEvítCode
 = 
EXCEPTION_DEBUG_EVENT
;

87 
ÕDebugEvít
->
u
.
Ex˚±i⁄
.
Ex˚±i⁄Rec‹d
.
Ex˚±i⁄Code
 = 
ec
;

88 
ÕDebugEvít
->
u
.
Ex˚±i⁄
.
Ex˚±i⁄Rec‹d
.
Ex˚±i⁄Addªss
 = 
ót
;

89 
ÕDebugEvít
->
u
.
Ex˚±i⁄
.
Ex˚±i⁄Rec‹d
.
Ex˚±i⁄Inf‹m©i⁄
[0] = 0;

90 
ÕDebugEvít
->
u
.
Ex˚±i⁄
.
Ex˚±i⁄Rec‹d
.
Ex˚±i⁄Inf‹m©i⁄
[1] = (
ULONG_PTR
Ë
îef
;

91 
ÕDebugEvít
->
dwPro˚ssId
 = 0;

93  
ªt
;

94 
	}
}

96 
EXPORT


97 
BOOL
 
	$C⁄töueDebugEvít
(
DWORD
 
dwPro˚ssId
, DWORD 
dwThªadId
, DWORD 
dwC⁄töueSètus
){

98 
i386_thªad_°©e_t
 
°©e
;

99 
	`gë_c⁄ãxt
(
dwThªadId
, &
°©e
);

100  
	`ªsume_thªad
(
dwThªadId
);

101 
	}
}

103 
EXPORT


104 
BOOL
 
	$DebugSëPro˚ssKûlOnExô
(
BOOL
 
KûlOnExô
){

105 
kûl_⁄_exô
 = 
KûlOnExô
;

107 
	}
}

109 
EXPORT


110 
BOOL
 
	$DebugA˘ivePro˚ssSt›
(
DWORD
 
dwPro˚ssId
){

111 
ªt
 = 
	`dëach
(
dwPro˚ssId
, &
ex˚±i⁄_p‹t
);

112 if(
kûl_⁄_exô
){

113 
	`Tîmö©ePro˚ss
(
dwPro˚ssId
, 0);

115  
ªt
;

116 
	}
}

118 
EXPORT


119 
BOOL
 
	$Tîmö©ePro˚ss
(
HANDLE
 
hPro˚ss
, 
UINT
 
uExôCode
){

120 
°s
 = 
	`kûl
(
hPro˚ss
, 9);

122 
°s
++;

123  
°s
;

124 
	}
}

126 
EXPORT


127 
HANDLE
 
	$Cª©eToﬁhñp32S«pshŸ
(
DWORD
 
dwFœgs
, DWORD 
th32Pro˚ssID
){

129 
˘l
[4] = {0};

130 
size
 = 0;

133 
˘l
[0] = 
CTL_KERN
;

134 
˘l
[1] = 
KERN_PROC
;

135 
˘l
[2] = 
KERN_PROC_ALL
;

136 
	`sys˘l
(
˘l
, 3, 
NULL
, (
size_t
 *Ë&
size
, NULL, 0);

137 
köfo
 = 
	`ˇŒoc
(1, 
size
);

138 
	`sys˘l
(
˘l
, 3, 
köfo
, (
size_t
 *Ë&
size
, 
NULL
, 0);

139 
köfo_max
 = 
size
 / (
köfo_¥oc
);

140 
köfo_cur
 = 0;

143 
	`gë_èsk_thªads
(
th32Pro˚ssID
, &
thªad_li°
, &
thªad_max
);

144 
thªad_cur
 = 0;

147 
	}
}

149 
EXPORT


150 
BOOL
 
	$Thªad32Fú°
(
HANDLE
 
hS«pshŸ
, 
LPTHREADENTRY32
 
Õã
){

151 if(
thªad_cur
 < 
thªad_max
){

152 
Õã
->
th32ThªadID
 = 
thªad_li°
[
thªad_cur
];

153 
Õã
->
th32Ow√rPro˚ssID
 = 
cuºít_pid
;

154 
thªad_cur
++;

159 
	}
}

161 
EXPORT


162 
BOOL
 
	$Thªad32Next
(
HANDLE
 
hS«pshŸ
, 
LPTHREADENTRY32
 
Õã
){

163 if(
thªad_cur
 < 
thªad_max
){

164 
Õã
->
th32ThªadID
 = 
thªad_li°
[
thªad_cur
];

165 
Õã
->
th32Ow√rPro˚ssID
 = 
cuºít_pid
;

166 
thªad_cur
++;

171 
	}
}

173 
EXPORT


174 
BOOL
 
	$Pro˚ss32Fú°
(
HANDLE
 
hS«pshŸ
, 
LPPROCESSENTRY32
 
Õ≥
){

175 if(
köfo_cur
 < 
köfo_max
){

176 
Õ≥
->
th32Pro˚ssID
 = 
köfo
[
köfo_cur
].
kp_¥oc
.
p_pid
;

177 
	`°∫˝y
(
Õ≥
->
szExeFûe
, 
köfo
[
köfo_cur
].
kp_¥oc
.
p_comm
, 
MAX_PATH
-1);

178 
Õ≥
->
szExeFûe
[
MAX_PATH
-1] = 0;

179 
köfo_cur
++;

184 
	}
}

186 
EXPORT


187 
BOOL
 
	$Pro˚ss32Next
(
HANDLE
 
hS«pshŸ
, 
LPPROCESSENTRY32
 
Õ≥
){

188 if(
köfo_cur
 < 
köfo_max
){

189 
Õ≥
->
th32Pro˚ssID
 = 
köfo
[
köfo_cur
].
kp_¥oc
.
p_pid
;

190 
	`°∫˝y
(
Õ≥
->
szExeFûe
, 
köfo
[
köfo_cur
].
kp_¥oc
.
p_comm
, 
MAX_PATH
-1);

191 
Õ≥
->
szExeFûe
[
MAX_PATH
-1] = 0;

192 
köfo_cur
++;

197 
	}
}

199 
EXPORT


200 
BOOL
 
	$GëThªadC⁄ãxt
(
HANDLE
 
hThªad
, 
LPCONTEXT
 
ÕC⁄ãxt
){

201 
mach_msg_ty≥_numbî_t
 
sc
;

203 
i386_thªad_°©e_t
 
°©e
;

204 
sc
 = 
i386_THREAD_STATE_COUNT
;

205 
	`thªad_gë_°©e
–
hThªad
, 
i386_THREAD_STATE
, (
thªad_°©e_t
Ë&
°©e
, &
sc
);

206 
ÕC⁄ãxt
->
Eax
 = 
°©e
.
óx
;

207 
ÕC⁄ãxt
->
Ebx
 = 
°©e
.
ebx
;

208 
ÕC⁄ãxt
->
Ecx
 = 
°©e
.
ecx
;

209 
ÕC⁄ãxt
->
Edx
 = 
°©e
.
edx
;

210 
ÕC⁄ãxt
->
Edi
 = 
°©e
.
edi
;

211 
ÕC⁄ãxt
->
Esi
 = 
°©e
.
esi
;

212 
ÕC⁄ãxt
->
Ebp
 = 
°©e
.
ebp
;

213 
ÕC⁄ãxt
->
E•
 = 
°©e
.
e•
;

214 
ÕC⁄ãxt
->
SegSs
 = 
°©e
.
ss
;

215 
ÕC⁄ãxt
->
EFœgs
 = 
°©e
.
eÊags
;

216 
ÕC⁄ãxt
->
Eù
 = 
°©e
.
eù
;

217 
ÕC⁄ãxt
->
SegCs
 = 
°©e
.
cs
;

218 
ÕC⁄ãxt
->
SegDs
 = 
°©e
.
ds
;

219 
ÕC⁄ãxt
->
SegEs
 = 
°©e
.
es
;

220 
ÕC⁄ãxt
->
SegFs
 = 
°©e
.
fs
;

221 
ÕC⁄ãxt
->
SegGs
 = 
°©e
.
gs
;

223 
x86_debug_°©e32_t
 
debug
;

224 
sc
 = 
x86_DEBUG_STATE32_COUNT
;

225 
	`thªad_gë_°©e
–
hThªad
, 
x86_DEBUG_STATE32
, (
thªad_°©e_t
Ë&
debug
, &
sc
);

226 
ÕC⁄ãxt
->
Dr0
 = 
debug
.
dr0
;

227 
ÕC⁄ãxt
->
Dr1
 = 
debug
.
dr1
;

228 
ÕC⁄ãxt
->
Dr2
 = 
debug
.
dr2
;

229 
ÕC⁄ãxt
->
Dr3
 = 
debug
.
dr3
;

230 
ÕC⁄ãxt
->
Dr6
 = 
debug
.
dr6
;

231 
ÕC⁄ãxt
->
Dr7
 = 
debug
.
dr7
;

234 
	}
}

236 
EXPORT


237 
BOOL
 
	$SëThªadC⁄ãxt
(
HANDLE
 
hThªad
, c⁄° 
CONTEXT
* 
ÕC⁄ãxt
){

238 
mach_msg_ty≥_numbî_t
 
sc
;

239 
kîn_ªtu∫_t
 
ªsu…
;

241 
i386_thªad_°©e_t
 
°©e
;

242 
°©e
.
óx
 = 
ÕC⁄ãxt
->
Eax
;

243 
°©e
.
ebx
 = 
ÕC⁄ãxt
->
Ebx
;

244 
°©e
.
ecx
 = 
ÕC⁄ãxt
->
Ecx
;

245 
°©e
.
edx
 = 
ÕC⁄ãxt
->
Edx
;

246 
°©e
.
edi
 = 
ÕC⁄ãxt
->
Edi
;

247 
°©e
.
esi
 = 
ÕC⁄ãxt
->
Esi
;

248 
°©e
.
ebp
 = 
ÕC⁄ãxt
->
Ebp
;

249 
°©e
.
e•
 = 
ÕC⁄ãxt
->
E•
;

250 
°©e
.
ss
 = 
ÕC⁄ãxt
->
SegSs
;

251 
°©e
.
eÊags
 = 
ÕC⁄ãxt
->
EFœgs
;

252 
°©e
.
eù
 = 
ÕC⁄ãxt
->
Eù
;

253 
°©e
.
cs
 = 
ÕC⁄ãxt
->
SegCs
;

254 
°©e
.
ds
 = 
ÕC⁄ãxt
->
SegDs
;

255 
°©e
.
es
 = 
ÕC⁄ãxt
->
SegEs
;

256 
°©e
.
fs
 = 
ÕC⁄ãxt
->
SegFs
;

257 
°©e
.
gs
 = 
ÕC⁄ãxt
->
SegGs
;

258 
sc
 = 
i386_THREAD_STATE_COUNT
;

259 
ªsu…
 = 
	`thªad_£t_°©e
–
hThªad
, 
i386_THREAD_STATE
, (
thªad_°©e_t
Ë&
°©e
, 
sc
);

260 if(
ªsu…
 !
KERN_SUCCESS
){

264 
x86_debug_°©e32_t
 
debug
;

265 
debug
.
dr0
 = 
ÕC⁄ãxt
->
Dr0
;

266 
debug
.
dr1
 = 
ÕC⁄ãxt
->
Dr1
;

267 
debug
.
dr2
 = 
ÕC⁄ãxt
->
Dr2
;

268 
debug
.
dr3
 = 
ÕC⁄ãxt
->
Dr3
;

269 
debug
.
dr6
 = 
ÕC⁄ãxt
->
Dr6
;

270 
debug
.
dr7
 = 
ÕC⁄ãxt
->
Dr7
;

271 
sc
 = 
x86_DEBUG_STATE32_COUNT
;

272 
ªsu…
 = 
	`thªad_£t_°©e
–
hThªad
, 
x86_DEBUG_STATE32
, (
thªad_°©e_t
Ë&
debug
, 
sc
);

273 if(
ªsu…
 !
KERN_SUCCESS
){

278 
	}
}

280 
EXPORT


281 
BOOL
 
	$Cª©ePro˚ssA
(
LPCTSTR
 
ÕAµliˇti⁄Name
, 
LPTSTR
 
ÕComm™dLöe
, 
LPSECURITY_ATTRIBUTES
 
ÕPro˚ssAâribuãs
, LPSECURITY_ATTRIBUTES 
ÕThªadAâribuãs
, 
BOOL
 
bInhîôH™dÀs
, 
DWORD
 
dwCª©i⁄Fœgs
, 
LPVOID
 
ÕEnvú⁄mít
, LPCTSTR 
ÕCuºítDúe˘‹y
, 
LPSTARTUPINFO
 
ÕSèπupInfo
, 
LPPROCESS_INFORMATION
 
ÕPro˚ssInf‹m©i⁄
){

282 
pid_t
 
pid
 = 
	`vf‹k
();

284 if(
pid
 == 0){

285 
comm™dlöe
[256];

286 
	`°∫˝y
(
comm™dlöe
, 
ÕComm™dLöe
, 255);

287 
comm™dlöe
[255] = 0;

290 
i
=0;

291 *
p
 = 
	`°rchr
(
comm™dlöe
, ' ');

292 *
q
 = 
comm™dlöe
;

293 *
¨gv
[16];

294 
p
){

295 *
p
 = 0;

296 
¨gv
[
i
++] = 
q
;

297 
	`fÊush
(
°dout
);

298 
q
 = 
p
 + 1;

299 
p
 = 
	`°rchr
(
comm™dlöe
, ' ');

301 
¨gv
[
i
] = 
q
;

302 
¨gv
[
i
+1] = 0;

304 
	`fÊush
(
°dout
);

305 
	`execv
(
¨gv
[0],árgv);

306 
	`≥º‹
("FailedÅoÉxecv!");

308 
	`DebugA˘ivePro˚ss
(
pid
);

311 
ÕPro˚ssInf‹m©i⁄
->
dwPro˚ssId
 = 
pid
;

312 
ÕPro˚ssInf‹m©i⁄
->
hPro˚ss
 = 
pid
;

315 
	}
}

317 
EXPORT


318 
HANDLE
 
	$O≥nPro˚ss
(
DWORD
 
dwDesúedAc˚ss
, 
BOOL
 
bInhîôH™dÀ
, DWORD 
dwPro˚ssId
){

319  
dwPro˚ssId
;

320 
	}
}

322 
EXPORT


323 
HANDLE
 
	$O≥nThªad
(
DWORD
 
dwDesúedAc˚ss
, 
BOOL
 
bInhîôH™dÀ
, DWORD 
dwThªadId
){

324  
dwThªadId
;

325 
	}
}

327 
EXPORT


328 
BOOL
 
	$RódPro˚ssMem‹y
(
HANDLE
 
hPro˚ss
, 
LPCVOID
 
ÕBa£Addªss
, 
LPVOID
 
ÕBuf„r
, 
SIZE_T
 
nSize
, SIZE_T* 
ÕNumbîOfByãsRód
){

329 
°s
;

330 
°s
 = 
	`ªad_mem‹y
(
hPro˚ss
, (Ë
ÕBa£Addªss
, 
nSize
, 
ÕBuf„r
);

331 *
ÕNumbîOfByãsRód
 = 
nSize
;

332  
°s
;

333 
	}
}

335 
EXPORT


336 
BOOL
 
	$WrôePro˚ssMem‹y
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
ÕBa£Addªss
, 
LPCVOID
 
ÕBuf„r
, 
SIZE_T
 
nSize
, SIZE_T* 
ÕNumbîOfByãsWrôãn
){

337 
°s
 = 
	`wrôe_mem‹y
(
hPro˚ss
, (Ë
ÕBa£Addªss
, 
nSize
, (*Ë
ÕBuf„r
);

338 *
ÕNumbîOfByãsWrôãn
 = 
nSize
;

339  
°s
;

340 
	}
}

342 
EXPORT


343 
DWORD
 
	$ResumeThªad
(
HANDLE
 
hThªad
){

344  
	`ªsume_thªad
(
hThªad
);

345 
	}
}

347 
EXPORT


348 
DWORD
 
	$Su•ídThªad
(
HANDLE
 
hThªad
){

349  
	`su•íd_thªad
(
hThªad
);

350 
	}
}

353 
EXPORT


354 
LPVOID
 
	$VútuÆAŒocEx
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
ÕAddªss
, 
SIZE_T
 
dwSize
, 
DWORD
 
ÊAŒoˇti⁄Ty≥
, DWORD 
ÊPrŸe˘
){

356 
addy
 = (Ë
	`Æloˇã
(
hPro˚ss
, (Ë
ÕAddªss
, 
dwSize
);

357  (
LPVOID
Ë
addy
;

358 
	}
}

360 
EXPORT


361 
BOOL
 
	$VútuÆFªeEx
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
ÕAddªss
, 
SIZE_T
 
dwSize
, 
DWORD
 
dwFªeTy≥
){

362  
	`vútuÆ_‰ì
(
hPro˚ss
, (Ë
ÕAddªss
, 
dwSize
);

363 
	}
}

365 
EXPORT


366 
SIZE_T
 
	$VútuÆQuîyEx
(
HANDLE
 
hPro˚ss
, 
LPCVOID
 
ÕAddªss
, 
PMEMORY_BASIC_INFORMATION
 
ÕBuf„r
, 
SIZE_T
 
dwLígth
){

367 
addr
, 
¥Ÿ
, 
size
 = 0;

368 
addr
 = (Ë
ÕAddªss
;

370 if(
	`vútuÆ_quîy
(
hPro˚ss
, &
addr
, &
¥Ÿ
, &
size
)){

374 
ÕBuf„r
->
Ba£Addªss
 = 
addr
;

375 
ÕBuf„r
->
PrŸe˘
 = 
¥Ÿ
;

376 
ÕBuf„r
->
Regi⁄Size
 = 
size
;

377 
ÕBuf„r
->
Sèã
 = 
MEM_COMMIT
;

379  (
MEMORY_BASIC_INFORMATION
);

380 
	}
}

382 
EXPORT


383 
DWORD
 
	$GëFûeSize
(
HANDLE
 
hFûe
, 
LPDWORD
 
ÕFûeSizeHigh
){

384 
°©
 
sb
;

385 
	`f°©
(
hFûe
, &
sb
);

386  
sb
.
°_size
;

387 
	}
}

389 
EXPORT


390 
BOOL
 
	$VútuÆPrŸe˘Ex
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
ÕAddªss
, 
SIZE_T
 
dwSize
, 
DWORD
 
ÊNewPrŸe˘
, 
PDWORD
 
ÕÊOldPrŸe˘
){

392 
MEMORY_BASIC_INFORMATION
 
Buf„r
;

393 
	`VútuÆQuîyEx
(
hPro˚ss
, 
ÕAddªss
, &
Buf„r
, 
dwSize
);

394 *
ÕÊOldPrŸe˘
 = 
Buf„r
.
PrŸe˘
;

396  
	`vútuÆ_¥Ÿe˘
(
hPro˚ss
, (Ë
ÕAddªss
, 
dwSize
, 
ÊNewPrŸe˘
);

397 
	}
}

399 
EXPORT


400 
BOOL
 
	$GëThªadSñe˘‹E¡ry
(
HANDLE
 
hThªad
, 
DWORD
 
dwSñe˘‹
, 
LPLDT_ENTRY
 
ÕSñe˘‹E¡ry
){

407 if(!
Æloˇãd_fs_ba£
){

408 *
Áke_d©a
 = (*Ë
	`mÆloc
(0x40);

411 
Æloˇãd_fs_ba£
 = (Ë
	`Æloˇã
(
hThªad
, 0, 128);

412 if(!
Æloˇãd_fs_ba£
){

416 
	`vútuÆ_¥Ÿe˘
(
hThªad
, 
Æloˇãd_fs_ba£
, 128, 
PAGE_READWRITE
);

418 
	`mem£t
(
Áke_d©a
, 0x0, 0x40);

419 
	`mem˝y
(
Áke_d©a
, "\xff\xff\xff\xff"

423 *
p
 = (*Ë(
Áke_d©a
 + 0x30);

424 *
p
 = 
	`ht⁄l
(
Æloˇãd_fs_ba£
);

425 
	`wrôe_mem‹y
(
hThªad
, 
Æloˇãd_fs_ba£
, 0x40, 
Áke_d©a
);

428 
ÕSñe˘‹E¡ry
->
Ba£Low
 = 
Æloˇãd_fs_ba£
 & 0xffff;

429 
ÕSñe˘‹E¡ry
->
HighW‹d
.
Byãs
.
Ba£Mid
 = (
Æloˇãd_fs_ba£
 & 0xff0000) >> 16;

430 
ÕSñe˘‹E¡ry
->
HighW‹d
.
Byãs
.
Ba£Hi
 = (
Æloˇãd_fs_ba£
 & 0xff000000) >> 24;

433 
	}
}

437 
EXPORT


438 
HMODULE
 
	$LﬂdLibøryA
(
LPCTSTR
 
ÕFûeName
){

440 
	}
}

442 
EXPORT


443 
BOOL
 
	$FªeLibøry
(
HMODULE
 
hModuÀ
){

445 
	}
}

447 
EXPORT


448 
FARPROC
 
	$GëProcAddªss
(
HMODULE
 
hModuÀ
, 
LPCSTR
 
ÕProcName
){

450 
	}
}

452 
EXPORT


453 
BOOL
 
	$FlushIn°ru˘i⁄Cache
(
HANDLE
 
hPro˚ss
, 
LPCVOID
 
ÕBa£Addªss
, 
SIZE_T
 
dwSize
){

455 
	}
}

458 
EXPORT


459 
BOOL
 
	$ModuÀ32Fú°
(
HANDLE
 
hS«pshŸ
, 
LPMODULEENTRY32
 
Õme
){

461 
	}
}

463 
EXPORT


464 
BOOL
 
	$ModuÀ32Next
(
HANDLE
 
hS«pshŸ
, 
LPMODULEENTRY32
 
Õme
){

466 
	}
}

468 
EXPORT


469 
HANDLE
 
	$GëCuºítPro˚ss
(){

471 
	}
}

473 
EXPORT


474 
DWORD
 
	$GëLa°Eº‹
(){

476 
	}
}

478 
EXPORT


479 
DWORD
 
	$F‹m©MesßgeA
(
DWORD
 
dwFœgs
, 
LPCVOID
 
ÕSour˚
, DWORD 
dwMesßgeId
, DWORD 
dwL™guageId
, 
LPTSTR
 
ÕBuf„r
, DWORD 
nSize
, 
va_li°
* 
Argumíts
){

481 
	`exô
(1);

482 
	}
}

484 
EXPORT


485 
HANDLE
 
	$Cª©eFûeM≠pögA
(
HANDLE
 
hFûe
, 
LPSECURITY_ATTRIBUTES
 
ÕAâribuãs
, 
DWORD
 
ÊPrŸe˘
, DWORD 
dwMaximumSizeHigh
, DWORD 
dwMaximumSizeLow
, 
LPCTSTR
 
ÕName
){

487 
	}
}

489 
EXPORT


490 
LPVOID
 
	$M≠VõwOfFûe
(
HANDLE
 
hFûeM≠pögObje˘
, 
DWORD
 
dwDesúedAc˚ss
, DWORD 
dwFûeOff£tHigh
, DWORD 
dwFûeOff£tLow
, 
SIZE_T
 
dwNumbîOfByãsToM≠
){

492 
	}
}

494 
EXPORT


495 
DWORD
 
	$GëM≠≥dFûeName
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
Õv
, 
LPTSTR
 
ÕFûíame
, 
DWORD
 
nSize
){

497 
	}
}

499 
EXPORT


500 
BOOL
 
	$Unm≠VõwOfFûe
(
LPCVOID
 
ÕBa£Addªss
){

502 
	}
}

504 
EXPORT


505 
BOOL
 
	$O≥nPro˚ssTokí
(
HANDLE
 
Pro˚ssH™dÀ
, 
DWORD
 
DesúedAc˚ss
, 
PHANDLE
 
TokíH™dÀ
){

507 
	}
}

509 
EXPORT


510 
BOOL
 
	$LookupPrivûegeVÆueA
(
LPCTSTR
 
ÕSy°emName
, LPCTSTR 
ÕName
, 
PLUID
 
ÕLuid
){

512 
	}
}

514 
EXPORT


515 
BOOL
 
	$Adju°TokíPrivûeges
(
HANDLE
 
TokíH™dÀ
, 
BOOL
 
DißbÀAŒPrivûeges
, 
PTOKEN_PRIVILEGES
 
NewSèã
, 
DWORD
 
Buf„rLígth
, PTOKEN_PRIVILEGES 
PªviousSèã
, 
PDWORD
 
Rëu∫Lígth
){

517 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\MacDll.h

10 
	~<mach/mach.h
>

11 
	~"wödows.h
"

12 
	~"im∂emíèti⁄.h
"

13 
	~"Ex˚±i⁄.h
"

14 
	~<sig«l.h
>

15 
	~<°dlib.h
>

16 
	~<°dio.h
>

17 
	~<mach/mach_å≠s.h
>

18 
	~<mach/mach_ty≥s.h
>

19 
	~<°rög.h
>

20 
	~<mach/thªad_°©us.h
>

21 
	~<uni°d.h
>

22 
	~<mach/mach.h
>

23 
	~<sys/ty≥s.h
>

24 
	~<sys/sys˘l.h
>

29 
GëSy°emInfo
(
LPSYSTEM_INFO
 
ÕSy°emInfo
);

30 
BOOL
 
Clo£H™dÀ
(
HANDLE
 
hObje˘
);

31 
BOOL
 
DebugA˘ivePro˚ss
(
DWORD
 
dwPro˚ssId
);

32 
BOOL
 
WaôF‹DebugEvít
(
LPDEBUG_EVENT
 
ÕDebugEvít
, 
DWORD
 
dwMûli£c⁄ds
);

33 
BOOL
 
C⁄töueDebugEvít
(
DWORD
 
dwPro˚ssId
, DWORD 
dwThªadId
, DWORD 
dwC⁄töueSètus
);

34 
BOOL
 
DebugSëPro˚ssKûlOnExô
(BOOL 
KûlOnExô
);

35 
BOOL
 
DebugA˘ivePro˚ssSt›
(
DWORD
 
dwPro˚ssId
);

36 
BOOL
 
Tîmö©ePro˚ss
(
HANDLE
 
hPro˚ss
, 
UINT
 
uExôCode
);

37 
HANDLE
 
Cª©eToﬁhñp32S«pshŸ
(
DWORD
 
dwFœgs
, DWORD 
th32Pro˚ssID
);

38 
BOOL
 
Pro˚ss32Fú°
(
HANDLE
 
hS«pshŸ
, 
LPPROCESSENTRY32
 
Õ≥
);

39 
BOOL
 
Pro˚ss32Next
(
HANDLE
 
hS«pshŸ
, 
LPPROCESSENTRY32
 
Õ≥
);

40 
BOOL
 
Thªad32Fú°
(
HANDLE
 
hS«pshŸ
, 
LPTHREADENTRY32
 
Õã
);

41 
BOOL
 
Thªad32Next
(
HANDLE
 
hS«pshŸ
, 
LPTHREADENTRY32
 
Õã
);

42 
BOOL
 
GëThªadC⁄ãxt
(
HANDLE
 
hThªad
, 
LPCONTEXT
 
ÕC⁄ãxt
);

43 
BOOL
 
Cª©ePro˚ssA
(
LPCTSTR
 
ÕAµliˇti⁄Name
, 
LPTSTR
 
ÕComm™dLöe
, 
LPSECURITY_ATTRIBUTES
 
ÕPro˚ssAâribuãs
, LPSECURITY_ATTRIBUTES 
ÕThªadAâribuãs
, BOOL 
bInhîôH™dÀs
, 
DWORD
 
dwCª©i⁄Fœgs
, 
LPVOID
 
ÕEnvú⁄mít
, LPCTSTR 
ÕCuºítDúe˘‹y
, 
LPSTARTUPINFO
 
ÕSèπupInfo
, 
LPPROCESS_INFORMATION
 
ÕPro˚ssInf‹m©i⁄
);

44 
HANDLE
 
O≥nPro˚ss
(
DWORD
 
dwDesúedAc˚ss
, 
BOOL
 
bInhîôH™dÀ
, DWORD 
dwPro˚ssId
);

45 
HANDLE
 
O≥nThªad
(
DWORD
 
dwDesúedAc˚ss
, 
BOOL
 
bInhîôH™dÀ
, DWORD 
dwThªadId
);

46 
BOOL
 
RódPro˚ssMem‹y
(
HANDLE
 
hPro˚ss
, 
LPCVOID
 
ÕBa£Addªss
, 
LPVOID
 
ÕBuf„r
, 
SIZE_T
 
nSize
, SIZE_T* 
ÕNumbîOfByãsRód
);

47 
DWORD
 
ResumeThªad
(
HANDLE
 
hThªad
);

48 
BOOL
 
SëThªadC⁄ãxt
(
HANDLE
 
hThªad
, c⁄° 
CONTEXT
* 
ÕC⁄ãxt
);

49 
DWORD
 
Su•ídThªad
(
HANDLE
 
hThªad
);

50 
LPVOID
 
VútuÆAŒocEx
(
HANDLE
 
hPro˚ss
, LPVOID 
ÕAddªss
, 
SIZE_T
 
dwSize
, 
DWORD
 
ÊAŒoˇti⁄Ty≥
, DWORD 
ÊPrŸe˘
);

51 
BOOL
 
VútuÆFªeEx
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
ÕAddªss
, 
SIZE_T
 
dwSize
, 
DWORD
 
dwFªeTy≥
);

52 
SIZE_T
 
VútuÆQuîyEx
(
HANDLE
 
hPro˚ss
, 
LPCVOID
 
ÕAddªss
, 
PMEMORY_BASIC_INFORMATION
 
ÕBuf„r
, SIZE_T 
dwLígth
);

53 
BOOL
 
WrôePro˚ssMem‹y
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
ÕBa£Addªss
, 
LPCVOID
 
ÕBuf„r
, 
SIZE_T
 
nSize
, SIZE_T* 
ÕNumbîOfByãsWrôãn
);

54 
DWORD
 
GëFûeSize
(
HANDLE
 
hFûe
, 
LPDWORD
 
ÕFûeSizeHigh
);

55 
BOOL
 
VútuÆPrŸe˘Ex
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
ÕAddªss
, 
SIZE_T
 
dwSize
, 
DWORD
 
ÊNewPrŸe˘
, 
PDWORD
 
ÕÊOldPrŸe˘
);

56 
BOOL
 
GëThªadSñe˘‹E¡ry
(
HANDLE
 
hThªad
, 
DWORD
 
dwSñe˘‹
, 
LPLDT_ENTRY
 
ÕSñe˘‹E¡ry
);

61 
HMODULE
 
LﬂdLibøryA
(
LPCTSTR
 
ÕFûeName
);

62 
BOOL
 
FªeLibøry
(
HMODULE
 
hModuÀ
);

63 
FARPROC
 
GëProcAddªss
(
HMODULE
 
hModuÀ
, 
LPCSTR
 
ÕProcName
);

64 
BOOL
 
FlushIn°ru˘i⁄Cache
(
HANDLE
 
hPro˚ss
, 
LPCVOID
 
ÕBa£Addªss
, 
SIZE_T
 
dwSize
);

65 
BOOL
 
ModuÀ32Fú°
(
HANDLE
 
hS«pshŸ
, 
LPMODULEENTRY32
 
Õme
);

66 
BOOL
 
ModuÀ32Next
(
HANDLE
 
hS«pshŸ
, 
LPMODULEENTRY32
 
Õme
);

67 
HANDLE
 
GëCuºítPro˚ss
();

68 
DWORD
 
GëLa°Eº‹
();

69 
DWORD
 
F‹m©MesßgeA
(DWORD 
dwFœgs
, 
LPCVOID
 
ÕSour˚
, DWORD 
dwMesßgeId
, DWORD 
dwL™guageId
, 
LPTSTR
 
ÕBuf„r
, DWORD 
nSize
, 
va_li°
* 
Argumíts
);

70 
HANDLE
 
Cª©eFûeM≠pögA
(HANDLE 
hFûe
, 
LPSECURITY_ATTRIBUTES
 
ÕAâribuãs
, 
DWORD
 
ÊPrŸe˘
, DWORD 
dwMaximumSizeHigh
, DWORD 
dwMaximumSizeLow
, 
LPCTSTR
 
ÕName
);

71 
LPVOID
 
M≠VõwOfFûe
(
HANDLE
 
hFûeM≠pögObje˘
, 
DWORD
 
dwDesúedAc˚ss
, DWORD 
dwFûeOff£tHigh
, DWORD 
dwFûeOff£tLow
, 
SIZE_T
 
dwNumbîOfByãsToM≠
);

72 
DWORD
 
GëM≠≥dFûeName
(
HANDLE
 
hPro˚ss
, 
LPVOID
 
Õv
, 
LPTSTR
 
ÕFûíame
, DWORD 
nSize
);

73 
BOOL
 
Unm≠VõwOfFûe
(
LPCVOID
 
ÕBa£Addªss
);

74 
BOOL
 
O≥nPro˚ssTokí
(
HANDLE
 
Pro˚ssH™dÀ
, 
DWORD
 
DesúedAc˚ss
, 
PHANDLE
 
TokíH™dÀ
);

75 
BOOL
 
LookupPrivûegeVÆueA
(
LPCTSTR
 
ÕSy°emName
, LPCTSTR 
ÕName
, 
PLUID
 
ÕLuid
);

76 
BOOL
 
Adju°TokíPrivûeges
(
HANDLE
 
TokíH™dÀ
, BOOL 
DißbÀAŒPrivûeges
, 
PTOKEN_PRIVILEGES
 
NewSèã
, 
DWORD
 
Buf„rLígth
, PTOKEN_PRIVILEGES 
PªviousSèã
, 
PDWORD
 
Rëu∫Lígth
);

78 
ã°
(
pid
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\MacX.c

1 
	~<Pyth⁄.h
>

2 
	~<°dlib.h
>

3 
	~<°dio.h
>

4 
	~<mach/mach_å≠s.h
>

5 
	~<mach/mach_ty≥s.h
>

6 
	~<°rög.h
>

7 
	~<mach/thªad_°©us.h
>

8 
	~<uni°d.h
>

9 
	~<mach/mach.h
>

10 
	~<sys/ty≥s.h
>

11 
	~<sys/sys˘l.h
>

12 
	~"im∂emíèti⁄.h
"

14 
mach_p‹t_t
 
	gex˚±i⁄_p‹t
;

16 
PyObje˘
 *
	$C⁄töueDebugEvít
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

18 c⁄° 
pid
, 
thªad
, 
°©us
;

19 
°s
;

20 
i386_thªad_°©e_t
 
°©e
;

21 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "I", &
thªad
))

22  
NULL
;

23 
	`gë_c⁄ãxt
(
thªad
, &
°©e
);

24 
°s
 = 
	`ªsume_thªad
(
thªad
);

25  
	`Py_BuûdVÆue
("i", 
°s
);

26 
	}
}

28 
PyObje˘
 *
	$DebugA˘ivePro˚ss
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

30 c⁄° 
pid
;

31 
°s
;

33 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

34  
NULL
;

35 
°s
 = 
	`©èch
(
pid
, &
ex˚±i⁄_p‹t
);

36  
	`Py_BuûdVÆue
("i", 
°s
);

37 
	}
}

39 
PyObje˘
 *
	$Enumî©ePro˚s£s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

41 
˘l
[4] = {0};

42 
size
 = 0;

43 
köfo_¥oc
 *
köfo
 = 
NULL
;

44 
i
, 
cou¡
;

46 
˘l
[0] = 
CTL_KERN
;

47 
˘l
[1] = 
KERN_PROC
;

48 
˘l
[2] = 
KERN_PROC_ALL
;

49 
	`sys˘l
(
˘l
, 3, 
NULL
, (
size_t
 *Ë&
size
, NULL, 0);

50 
köfo
 = 
	`ˇŒoc
(1, 
size
);

51 
	`sys˘l
(
˘l
, 3, 
köfo
, (
size_t
 *Ë&
size
, 
NULL
, 0);

53 
cou¡
 = 
size
 / (
köfo_¥oc
);

55 
PyObje˘
 *
ªt
 = 
	`PyTu∂e_New
(
cou¡
);

56 
i
=0; i < 
cou¡
; i++){

57 
	`PyTu∂e_SëIãm
(
ªt
, 
i
, 
	`Py_BuûdVÆue
("(Is)", 
köfo
[i].
kp_¥oc
.
p_pid
, köfo[i].kp_¥oc.
p_comm
));

59 
	`‰ì
(
köfo
);

61  
ªt
;

62 
	}
}

64 
PyObje˘
 *
	$DebugA˘ivePro˚ssSt›
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

66 c⁄° 
pid
;

67 
°s
;

69 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

70  
NULL
;

71 
°s
 = 
	`dëach
(
pid
);

72  
	`Py_BuûdVÆue
("i", 
°s
);

73 
	}
}

76 
PyObje˘
 *
	$VútuÆFªeEx
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

78 c⁄° 
pid
, 
addªss
, 
size
, 
ty≥
;

79 
°s
;

81 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "iiii", &
pid
, &
addªss
, &
size
, &
ty≥
))

82  
NULL
;

84 
°s
 = 
	`vútuÆ_‰ì
(
pid
, 
addªss
, 
size
);

86  
	`Py_BuûdVÆue
("i", 
°s
);

87 
	}
}

89 
PyObje˘
 *
	$VútuÆPrŸe˘Ex
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

91 c⁄° 
pid
, 
size
, 
ty≥
;

92 *
ﬁd
;

93 
°s
;

94 c⁄° 
addªss
;

96 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "iiii", &
pid
, &
addªss
, &
size
, &
ty≥
)){

97 
	`¥ötf
("Couldn'tÖarse inputs,Ñeturning NULL!\n");

98 
	`¥ötf
("Was itá kerneláddress?\n");

99  
NULL
;

102 
°s
 = 
	`vútuÆ_¥Ÿe˘
(
pid
, 
addªss
, 
size
, 
ty≥
);

103  
	`Py_BuûdVÆue
("i", 
°s
);

104 
	}
}

107 
PyObje˘
 *
	$VútuÆAŒocEx
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

109 c⁄° 
pid
, 
addªss
, 
size
, 
ty≥
, 
¥Ÿ
;

110 
°s
;

112 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "iiiii", &
pid
, &
addªss
, &
size
, &
ty≥
, &
¥Ÿ
))

113  
NULL
;

115 
addy
 = (Ë
	`Æloˇã
(
pid
, 
addªss
, 
size
);

117  
	`Py_BuûdVÆue
("I", 
addy
);

118 
	}
}

120 
PyObje˘
 *
	$WaôF‹DebugEvít
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

122 c⁄° 
pid
, 
timeout
;

123 
ªt
;

124 
ec
, 
id
;

125 
ót
, 
îef
;

127 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "ii", &
pid
, &
timeout
))

128  
NULL
;

129 
ªt
 = 
	`my_msg_£rvî
(
ex˚±i⁄_p‹t
, 
timeout
, &
id
, &
ec
, &
ót
, &
îef
);

130  
	`Py_BuûdVÆue
("[i,i,i,I,I]", 
ªt
, 
id
, 
ec
, 
ót
, 
îef
);

131 
	}
}

133 
PyObje˘
 *
	$RódPro˚ssMem‹y
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

135 c⁄° 
pid
, 
Àn
;

136 c⁄° 
addr
;

137 
°s
;

138 *
d©a
;

139 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "iIwi", &
pid
, &
addr
, &
d©a
, &
Àn
)){

140 
	`¥ötf
("Coudn'tÖarse\n");

141  
NULL
;

143 
°s
 = 
	`ªad_mem‹y
(
pid
, 
addr
, 
Àn
, 
d©a
);

144  
	`Py_BuûdVÆue
("i", 
°s
);

145 
	}
}

147 
PyObje˘
 *
	$WrôePro˚ssMem‹y
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

149 c⁄° 
pid
, 
Àn
;

150 c⁄° 
addr
;

151 **
d©a
;

152 
°s
;

154 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "iIwi", &
pid
, &
addr
, &
d©a
, &
Àn
)){

155 
	`¥ötf
("CouldÇotÖarse\n");

156  
NULL
;

158 
°s
 = 
	`wrôe_mem‹y
(
pid
, 
addr
, 
Àn
, *
d©a
);

159 
PyObje˘
 *
ªt
 = 
	`Py_BuûdVÆue
("i", 
°s
);

160  
ªt
;

161 
	}
}

163 
PyObje˘
 *
	$Enumî©eThªads
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

165 c⁄° 
pid
;

166 
i
;

168 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

169  
NULL
;

171 
thªad_a˘_p‹t_¨øy_t
 
thªad_li°
;

172 
mach_msg_ty≥_numbî_t
 
thªad_cou¡
;

174 
	`gë_èsk_thªads
(
pid
, &
thªad_li°
, &
thªad_cou¡
);

176 
PyObje˘
 *
ªt
 = 
	`PyTu∂e_New
(
thªad_cou¡
);

177 
i
=0; i < 
thªad_cou¡
; i++){

178 
	`PyTu∂e_SëIãm
(
ªt
, 
i
, 
	`Py_BuûdVÆue
("I", 
thªad_li°
[i]));

180  
ªt
;

181 
	}
}

183 
PyObje˘
 *
	$Su•ídThªad
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

185 c⁄° 
thªad
;

186 
i386_thªad_°©e_t
 
°©e
;

187 
°s
;

189 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "I", &
thªad
))

190  
NULL
;

191 
°s
 = 
	`su•íd_thªad
(
thªad
);

192  
	`Py_BuûdVÆue
("i", 
°s
);

193 
	}
}

195 
PyObje˘
 *
	$ResumeThªad
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

197 c⁄° 
thªad
;

198 
i386_thªad_°©e_t
 
°©e
;

199 
°s
, 
i
;

200 
kîn_ªtu∫_t
 
ªt
;

201 
size
 = 
THREAD_BASIC_INFO_COUNT
;

202 
thªad_basic_öfo
 
öfo
;

204 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "I", &
thªad
))

205  
NULL
;

207 
°s
 = 
	`ªsume_thªad
(
thªad
);

208  
	`Py_BuûdVÆue
("i", 
°s
);

209 
	}
}

211 
PyObje˘
 *
	$Tîmö©ePro˚ss
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

213 
pid
, 
exôcode
, 
°s
;

215 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "ii", &
pid
, &
exôcode
))

216  
NULL
;

217 
°s
 = 
	`kûl
(
pid
, 9);

218 
°s
++;

219  
	`Py_BuûdVÆue
("i", 
°s
);

220 
	}
}

222 
	$¥ötc⁄ãxt
(
i386_thªad_°©e_t
 *
°©e
){

223 
	`¥ötf
("óx: %x\√bx: %x\√cx: %x\√dx: %x\√di: %x\√si: %x\√bp: %x\√•: %x\nss: %x\√Êags: %x\√ù: %x\ncs: %x\nds: %x\√s: %x\nfs: %x\ngs: %x\n", 
°©e
->
óx
, sèã->
ebx
, sèã->
ecx
, sèã->
edx
, sèã->
edi
, sèã->
esi
, sèã->
ebp
, sèã->
e•
, sèã->
ss
, sèã->
eÊags
, sèã->
eù
, sèã->
cs
, sèã->
ds
, sèã->
es
, sèã->
fs
, sèã->
gs
);

224 
	}
}

227 
PyObje˘
 *
	$GëThªadC⁄ãxt
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

229 c⁄° 
thªad
;

230 
i386_thªad_°©e_t
 
°©e
;

232 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "I", &
thªad
))

233  
NULL
;

235 
	`gë_c⁄ãxt
(
thªad
, &
°©e
);

237 
s
}

239 
PyObje˘
 *
	$SëThªadC⁄ãxt
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

241 c⁄° 
thªad
;

242 
i386_thªad_°©e_t
 
°©e
;

243 
°s
;

244 
x
;

247 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "i(IIIIIIIIIIIIIIII)", &
thªad
, &
°©e
.
óx
, &°©e.
ebx
, &°©e.
ecx
, &°©e.
edx
, &°©e.
edi
, &°©e.
esi
, &°©e.
ebp
, &°©e.
e•
, &°©e.
ss
, &°©e.
eÊags
, &°©e.
eù
, &°©e.
cs
, &°©e.
ds
, &°©e.
es
, &°©e.
fs
, &°©e.
gs
))

248  
NULL
;

249 
°s
 = 
	`£t_c⁄ãxt
(
thªad
, &
°©e
);

250  
	`Py_BuûdVÆue
("i", 
°s
);

251 
	}
}

253 
PyObje˘
 *
	$VútuÆQuîyEx
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
){

254 c⁄° 
pid
;

255 
addr
;

256 
¥Ÿ
;

257 
size
;

258 
°s
;

259 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "iI", &
pid
, &
addr
)){

260 
	`¥ötf
("Couldn'tÖarseárguments in VirtualQuery\nWas itá kerneláddress?");

261  
NULL
;

263 
	`vútuÆ_quîy
(
pid
, &
addr
, &
¥Ÿ
, &
size
);

265 
PyObje˘
 *
ªt
 = 
	`Py_BuûdVÆue
("[I,I]", 
addr
, 
¥Ÿ
);

266  
ªt
;

267 
	}
}

269 
PyMëhodDef
 
	gMacXMëhods
[] = {

270 {"C⁄töueDebugEvít", 
C⁄töueDebugEvít
, 
METH_VARARGS
, "Continue debugÉvent"},

271 {"DebugA˘ivePro˚ss", 
DebugA˘ivePro˚ss
, 
METH_VARARGS
, "AttachÅoáÖrocess"},

272 {"Enumî©eThªads", 
Enumî©eThªads
, 
METH_VARARGS
, "GetÜisting ofÅhreads"},

273 {"Enumî©ePro˚s£s", 
Enumî©ePro˚s£s
, 
METH_VARARGS
, "GetÖrocessÜisting"},

274 {"DebugA˘ivePro˚ssSt›", 
DebugA˘ivePro˚ssSt›
, 
METH_VARARGS
, "Detach fromáÖrocess"},

275 {"WaôF‹DebugEvít", 
WaôF‹DebugEvít
, 
METH_VARARGS
, "ContinueánáttachedÖrocess"},

276 {"Su•ídThªad", 
Su•ídThªad
, 
METH_VARARGS
, "SuspendÅhread"},

277 {"ResumeThªad", 
ResumeThªad
, 
METH_VARARGS
, "ResumeÅhread"},

278 {"Tîmö©ePro˚ss", 
Tîmö©ePro˚ss
, 
METH_VARARGS
, "TerminateáÖrocess"},

279 {"RódPro˚ssMem‹y", 
RódPro˚ssMem‹y
, 
METH_VARARGS
, "Read 4 bytes from memory ofáttachedÖrocess"},

280 {"WrôePro˚ssMem‹y", 
WrôePro˚ssMem‹y
, 
METH_VARARGS
, "Write 4 bytes intoáttachedÖrocess's memory"},

281 {"GëThªadC⁄ãxt", 
GëThªadC⁄ãxt
, 
METH_VARARGS
, "Get context foráÅhread"},

282 {"SëThªadC⁄ãxt", 
SëThªadC⁄ãxt
, 
METH_VARARGS
, "Set context foráÅhread"},

283 {"VútuÆQuîyEx", 
VútuÆQuîyEx
, 
METH_VARARGS
, "Get memoryÑegion information"},

284 {"VútuÆAŒocEx", 
VútuÆAŒocEx
, 
METH_VARARGS
, "Allocate memory"},

285 {"VútuÆFªeEx", 
VútuÆFªeEx
, 
METH_VARARGS
, "Free memory"},

286 {"VútuÆPrŸe˘Ex", 
VútuÆPrŸe˘Ex
, 
METH_VARARGS
, "VirtualProtect"},

287 {
NULL
, NULL, 0, NULL}

290 
PyMODINIT_FUNC
 
	$öôMacX
(){

291 (Ë
	`Py_InôModuÀ
("MacX", 
MacXMëhods
);

292 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\dyld.c

10 
	~<mach-o/ldsyms.h
>

11 
	~"MacDŒ.h
"

12 
	~"dyld.h
"

13 
	~"im∂emíèti⁄.h
"

15 
EXPORT


16 
	$macosx_loˇã_dyld
(
pid
, *
addr
){

17 
kîn_ªtu∫_t
 
kªt
 = 
KERN_SUCCESS
;

18 
vm_ªgi⁄_basic_öfo
 
öfo
;

19 
mach_msg_ty≥_numbî_t
 
öfo_˙t
 = 
VM_REGION_BASIC_INFO_COUNT
;

20 
mach_vm_addªss_t
 
ã°_addr
 = 
VM_MIN_ADDRESS
;

21 
mach_vm_size_t
 
size
 = 0;

22 
mach_p‹t_t
 
obje˘_«me
 = 
MACH_PORT_NULL
;

24 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

27 
kªt
 = 
	`vm_ªgi⁄
 (
p‹t
, (*Ë&
ã°_addr
, (*Ë&
size
, 
VM_REGION_BASIC_INFO
, (
vm_ªgi⁄_öfo_t
Ë&
öfo
, &
öfo_˙t
, &
obje˘_«me
);

29 i‡(
kªt
 !
KERN_SUCCESS
)

32 i‡(
	`dyld_°¨ts_hîe_p
 (
p‹t
, 
ã°_addr
)){

33 *
addr
 = 
ã°_addr
;

37 
ã°_addr
 +
size
;

39 } 
size
 != 0);

41 
	}
}

43 
	$dyld_°¨ts_hîe_p
 (
èsk_t
 
p‹t
, 
mach_vm_addªss_t
 
addr
)

45 
mach_vm_addªss_t
 
addªss
 = 
addr
;

46 
mach_vm_size_t
 
size
 = 0;

47 
vm_ªgi⁄_basic_öfo
 
öfo
;

48 
mach_msg_ty≥_numbî_t
 
öfo_˙t
 = 
VM_REGION_BASIC_INFO_COUNT
;

49 
kîn_ªtu∫_t
 
ªt
;

50 
mach_p‹t_t
 
obje˘_«me
;

51 
vm_addªss_t
 
d©a
;

52 
vm_size_t
 
d©a_cou¡
;

54 
mach_hódî
 *
mh
;

56 
ªt
 = 
	`vm_ªgi⁄
 (
p‹t
, (*Ë&
addªss
, (*Ë&
size
, 
VM_REGION_BASIC_INFO
, (
vm_ªgi⁄_öfo_t
Ë& 
öfo
, &
öfo_˙t
, &
obje˘_«me
);

58 i‡(
ªt
 !
KERN_SUCCESS
)

63 i‡((
öfo
.
¥Ÿe˘i⁄
 & 
VM_PROT_READ
) == 0)

66 
ªt
 = 
	`vm_ªad
 (
p‹t
, 
addªss
, 
size
, &
d©a
, &
d©a_cou¡
);

68 i‡(
ªt
 !
KERN_SUCCESS
){

77 i‡(
d©a_cou¡
 <  (
mach_hódî
)){

78 
ªt
 = 
	`vm_dóŒoˇã
 (
	`mach_èsk_£lf
 (), 
d©a
, 
d©a_cou¡
);

82 
mh
 = (
mach_hódî
 *Ë
d©a
;

87 i‡((
mh
->
magic
 !
MH_MAGIC
 && mh->magi¯!
MH_CIGAM
 &&

88 
mh
->
magic
 !
MH_MAGIC_64
 && mh->magi¯!
MH_CIGAM_64
) ||

89 
mh
->
fûëy≥
 !
MH_DYLINKER
 ||

90 
d©a_cou¡
 <  (
mach_hódî
Ë+ 
mh
->
sizeofcmds
)

92 
ªt
 = 
	`vm_dóŒoˇã
 (
	`mach_èsk_£lf
 (), 
d©a
, 
d©a_cou¡
);

97 
ªt
 = 
	`vm_dóŒoˇã
 (
	`mach_èsk_£lf
 (), 
d©a
, 
d©a_cou¡
);

100 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\dyld.h

9 
	#EXPORT
 
	`__©åibuã__
((
	`visibûôy
("deÁu…")))

	)

12 
dyld_°¨ts_hîe_p
 (
èsk_t
 
p‹t
, 
mach_vm_addªss_t
 
addr
);

13 
macosx_loˇã_dyld
(
pid
, *
addr
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\implementation.c

1 
	~<°dlib.h
>

2 
	~<sys/ty≥s.h
>

3 
	~<sys/±ø˚.h
>

4 
	~<°dio.h
>

5 
	~<mach/mach.h
>

6 
	~<mach/mach_å≠s.h
>

7 
	~<mach/mach_ty≥s.h
>

8 
	~<°rög.h
>

9 
	~<mach/thªad_°©us.h
>

10 
	~<uni°d.h
>

11 
	~<sig«l.h
>

12 
	~<£tjmp.h
>

13 
	~<im∂emíèti⁄.h
>

14 
	~"Ex˚±i⁄.h
"

16 
	#EXPORT
 
	`__©åibuã__
((
	`visibûôy
("deÁu…")))

	)

25 
èsk_t
 
	gour_p‹t
 = -1;

27 
èsk_t
 
	$gëp‹t
(
pid
){

28 if(
our_p‹t
 == -1){

29 
èsk_t
 
p‹t
;

30 if(
	`èsk_f‹_pid
(
	`mach_èsk_£lf
(), 
pid
, &
p‹t
)){

34 
our_p‹t
 = 
p‹t
;

36  
our_p‹t
;

37 
	}
}

39 
	$©èch
(
pid
, 
mach_p‹t_t
 *
ï
){

41 
our_p‹t
 = -1;

42 
	`gëp‹t
(
pid
);

44 *
ï
 = 
	`öô
(
pid
);

51 
	}
}

53 
	$dëach
(
pid
, 
mach_p‹t_t
 *
ï
){

55 
mach_p‹t_t
 
me
;

56 
me
 = 
	`mach_èsk_£lf
();

73 
kîn_ªtu∫_t
 
îr
 = 
	`mach_p‹t_dóŒoˇã
(
me
, *
ï
);

74 if(
îr
!
KERN_SUCCESS
){

76 i‡(
îr
==
KERN_INVALID_TASK
){

78 } i‡(
îr
==
KERN_INVALID_NAME
) {

80 } i‡(
îr
==
KERN_INVALID_RIGHT
) {

91 
	}
}

93 
	$gë_èsk_thªads
(
pid
, 
thªad_a˘_p‹t_¨øy_t
 *
thªad_li°
, 
mach_msg_ty≥_numbî_t
 *
thªad_cou¡
){

95 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

96 
	`èsk_thªads
(
p‹t
, 
thªad_li°
, 
thªad_cou¡
);

98 
	}
}

100 
	$vútuÆ_‰ì
(
pid
, 
addªss
, 
size
){

101 
°s
;

102 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

104 
kîn_ªtu∫_t
 
îr
 = 
	`vm_dóŒoˇã
(
p‹t
, 
addªss
, 
size
);

105 if(
îr
!
KERN_SUCCESS
){

106 
°s
 = 0;

108 
°s
 = 1;

110  
°s
;

111 
	}
}

113 
vm_¥Ÿ_t
 
	$wöToXPrŸe˘i⁄
(
ty≥
){

114 
vm_¥Ÿ_t
 
mac_¥Ÿ
 = 0;

115 
ty≥
){

116 
PAGE_NOACCESS
:

118 
PAGE_READONLY
:

119 
mac_¥Ÿ
 = 
VM_PROT_READ
;

121 
PAGE_READWRITE
:

122 
mac_¥Ÿ
 = 
VM_PROT_READ
 | 
VM_PROT_WRITE
;

124 
PAGE_EXECUTE
:

125 
mac_¥Ÿ
 = 
VM_PROT_EXECUTE
;

127 
PAGE_EXECUTE_READ
:

128 
mac_¥Ÿ
 = 
VM_PROT_EXECUTE
 | 
VM_PROT_READ
;

130 
PAGE_EXECUTE_READWRITE
:

131 
mac_¥Ÿ
 = 
VM_PROT_EXECUTE
 | 
VM_PROT_READ
 | 
VM_PROT_WRITE
;

133 
PAGE_GUARD
:

134 
PAGE_NOCACHE
:

135 
PAGE_WRITECOMBINE
:

139  
mac_¥Ÿ
;

140 
	}
}

142 
	$XToWöPrŸe˘i⁄
(
vm_¥Ÿ_t
 
mac
){

143 
ªt
;

144 
mac
){

145 
VM_PROT_READ
:

146 
ªt
 = 
PAGE_READONLY
;

148 
VM_PROT_READ
 | 
VM_PROT_WRITE
:

149 
ªt
 = 
PAGE_READWRITE
;

151 
VM_PROT_EXECUTE
:

152 
ªt
 = 
PAGE_EXECUTE
;

154 
VM_PROT_EXECUTE
 | 
VM_PROT_READ
:

155 
ªt
 = 
PAGE_EXECUTE_READ
;

157 
VM_PROT_EXECUTE
 | 
VM_PROT_READ
 | 
VM_PROT_WRITE
:

158 
ªt
 = 
PAGE_EXECUTE_READWRITE
;

161 
ªt
 = 
PAGE_NOACCESS
;

163  
ªt
;

164 
	}
}

166 
	$vútuÆ_¥Ÿe˘
(
pid
, 
addªss
, 
size
, 
ty≥
){

167 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

169 
°s
;

170 
vm_¥Ÿ_t
 
mac_¥Ÿ
 = 
	`wöToXPrŸe˘i⁄
(
ty≥
);

173 
kîn_ªtu∫_t
 
îr
 = 
	`vm_¥Ÿe˘
(
p‹t
, 
addªss
, 
size
, 
FALSE
, 
mac_¥Ÿ
);

174 if(
îr
 =
KERN_SUCCESS
){

175 
°s
 = 1;

176 } if(
îr
 =
KERN_PROTECTION_FAILURE
){

177 
°s
 = 1;

181 
°s
 = 1;

183  
°s
;

184 
	}
}

186 *
	$Æloˇã
(
pid
, 
addªss
, 
size
){

187 *
d©a
;

189 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

190 
kîn_ªtu∫_t
 
îr
 = 
	`vm_Æloˇã
(
p‹t
, (
vm_addªss_t
*Ë&
d©a
, 
size
, 
VM_FLAGS_ANYWHERE
);

191 if(
îr
!
KERN_SUCCESS
){

192 
d©a
 = 
NULL
;

195  
d©a
;

196 
	}
}

198 
	$ªad_mem‹y
(
pid
, 
addr
, 
Àn
, *
d©a
){

200 
mach_msg_ty≥_numbî_t
 
ƒód
;

201 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

202 
	`vm_ªad_ovîwrôe
(
p‹t
, 
addr
, 
Àn
, (Ë
d©a
, &
ƒód
);

203 if(
ƒód
 !
Àn
){

208 
	}
}

210 
	$wrôe_mem‹y
(
pid
, 
addr
, 
Àn
, *
d©a
){

212 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

213 
kîn_ªtu∫_t
 
ªt
 = 
	`vm_wrôe
(
p‹t
, 
addr
, (
poöãr_t
Ë
d©a
, 
Àn
);

214 if(
ªt
){

216 if(
ªt
 =
KERN_PROTECTION_FAILURE
)

218 if(
ªt
 =
KERN_INVALID_ADDRESS
)

223 
	}
}

225 
	$gë_c⁄ãxt
(
thªad_a˘_t
 
thªad
, 
i386_thªad_°©e_t
 *
°©e
){

227 
mach_msg_ty≥_numbî_t
 
sc
 = 
i386_THREAD_STATE_COUNT
;

228 
	`thªad_gë_°©e
–
thªad
, 
i386_THREAD_STATE
, (
thªad_°©e_t
Ë
°©e
, &
sc
);

230 
	}
}

232 
	$su•íd_thªad
(
thªad
){

233 
°s
;

235 
°s
 = 
	`thªad_su•íd
(
thªad
);

236 if(
°s
 =
KERN_SUCCESS
){

237 
°s
 = 0;

240 
°s
 = -1;

242  
°s
;

243 
	}
}

245 
	$ªsume_thªad
(
thªad
){

246 
i
;

247 
kîn_ªtu∫_t
 
ªt
;

249 
size
 = 
THREAD_BASIC_INFO_COUNT
;

250 
thªad_basic_öfo
 
öfo
;

252 
ªt
 = 
	`thªad_öfo
(
thªad
, 
THREAD_BASIC_INFO
, (
thªad_öfo_t
Ë&
öfo
, &
size
);

253 if(
ªt
 !
KERN_SUCCESS
){

258 
i
 = 0; i < 
öfo
.
su•íd_cou¡
; i++){

259 
ªt
 = 
	`thªad_ªsume
(
thªad
);

260 if(
ªt
 !
KERN_SUCCESS
){

266 
	}
}

268 
	$vútuÆ_quîy
(
pid
, *
ba£addr
, *
¥Ÿ
, *
size
){

269 
èsk_t
 
p‹t
 = 
	`gëp‹t
(
pid
);

271 
mach_msg_ty≥_numbî_t
 
cou¡
 = 
VM_REGION_BASIC_INFO_COUNT
;

272 
vm_ªgi⁄_basic_öfo
 
öfo
;

273 
mach_p‹t_t
 
obje˘Name
 = 
MACH_PORT_NULL
;

274 
ªque°ed_ba£
 = *
ba£addr
;

275 
kîn_ªtu∫_t
 
ªsu…
 = 
	`vm_ªgi⁄
(
p‹t
, 
ba£addr
, 
size
, 
VM_REGION_BASIC_INFO
, (
vm_ªgi⁄_öfo_t
Ë&
öfo
, &
cou¡
, &
obje˘Name
);

280 if(
ªsu…
 !
KERN_SUCCESS
){

282 *
size
 = 0xfffffff‡- 
ªque°ed_ba£
 + 1;

283 *
¥Ÿ
 = 
PAGE_NOACCESS
;

288 if(*
ba£addr
 > 
ªque°ed_ba£
){

290 *
size
 = *
ba£addr
 - 
ªque°ed_ba£
;

291 *
ba£addr
 = 
ªque°ed_ba£
;

292 *
¥Ÿ
 = 
PAGE_NOACCESS
;

297 *
¥Ÿ
 = 
	`XToWöPrŸe˘i⁄
(
öfo
.
¥Ÿe˘i⁄
);

300 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\implementation.h

10 
	#MEM_COMMIT
 0x00001000

	)

11 
	#MEM_DECOMMIT
 0x00004000

	)

12 
	#MEM_IMAGE
 0x01000000

	)

13 
	#MEM_RELEASE
 0x00008000

	)

15 
	#PAGE_NOACCESS
 0x00000001

	)

16 
	#PAGE_READONLY
 0x00000002

	)

17 
	#PAGE_READWRITE
 0x00000004

	)

18 
	#PAGE_WRITECOPY
 0x00000008

	)

19 
	#PAGE_EXECUTE
 0x00000010

	)

20 
	#PAGE_EXECUTE_READ
 0x00000020

	)

21 
	#PAGE_EXECUTE_READWRITE
 0x00000040

	)

22 
	#PAGE_EXECUTE_WRITECOPY
 0x00000080

	)

23 
	#PAGE_GUARD
 0x00000100

	)

24 
	#PAGE_NOCACHE
 0x00000200

	)

25 
	#PAGE_WRITECOMBINE
 0x00000400

	)

27 
©èch
(
pid
, 
mach_p‹t_t
 *
ï
);

28 
dëach
(
pid
, 
mach_p‹t_t
 *
ï
);

29 
gë_èsk_thªads
(
pid
, 
thªad_a˘_p‹t_¨øy_t
 *
thªad_li°
, 
mach_msg_ty≥_numbî_t
 *
thªad_cou¡
);

30 
vútuÆ_‰ì
(
pid
, 
addªss
, 
size
);

31 
vútuÆ_¥Ÿe˘
(
pid
, 
addªss
, 
size
, 
ty≥
);

32 *
Æloˇã
(
pid
, 
addªss
, 
size
);

33 
ªad_mem‹y
(
pid
, 
addr
, 
Àn
, *
d©a
);

34 
wrôe_mem‹y
(
pid
, 
addr
, 
Àn
, *
d©a
);

35 
gë_c⁄ãxt
(
thªad_a˘_t
 
thªad
, 
i386_thªad_°©e_t
 *
°©e
);

36 
su•íd_thªad
(
thªad
);

37 
ªsume_thªad
(
thªad
);

38 
£t_c⁄ãxt
(
thªad_a˘_t
 
thªad
, 
i386_thªad_°©e_t
 *
°©e
);

39 
vútuÆ_quîy
(
pid
, *
ba£addr
, *
¥Ÿ
, *
size
);

40 
Æloˇã_ö_thªad
(
thªadId
, 
size
);

41 
èsk_t
 
gëp‹t
(
pid
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\main.c

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\windows.h

1 
	#BOOL
 

	)

2 
	#WORD
 

	)

3 
	#DWORD
 

	)

4 
	#LPVOID
 *

	)

5 
	#LPDWORD
 *

	)

6 
	#PDWORD
 *

	)

7 
	#DWORD_PTR
 *

	)

8 
	#LPSYSTEM_INFO
 
SYSTEM_INFO
 *

	)

9 
	#HMODULE
 

	)

10 
	#LPCSTR
 *

	)

11 
	#LPCTSTR
 *

	)

12 
	#HANDLE
 

	)

13 
	#FARPROC
 

	)

14 
	#PVOID
 

	)

15 
	#ULONG_PTR
 *

	)

16 
	#LPCVOID
 *

	)

17 
	#SIZE_T
 
size_t


	)

18 
	#UINT
 

	)

19 
	#BYTE
 

	)

20 
	#TCHAR
 

	)

21 
	#LPMODULEENTRY32
 
MODULEENTRY32
 *

	)

22 
	#LPPROCESSENTRY32
 
PROCESSENTRY32
 *

	)

23 
	#LONG
 

	)

24 
	#LPTHREADENTRY32
 
THREADENTRY32
 *

	)

25 
	#LPCONTEXT
 
CONTEXT
 *

	)

26 
	#LPTSTR
 *

	)

27 
	#LPSECURITY_ATTRIBUTES
 *

	)

28 
	#LPBYTE
 *

	)

29 
	#PHANDLE
 

	)

31 
	#MAX_PATH
 260

	)

32 
	#EXCEPTION_MAXIMUM_PARAMETERS
 15

	)

33 
	#MAX_MODULE_NAME32
 255

	)

34 
	#ANYSIZE_ARRAY
 1

	)

36 
	#EXCEPTION_DEBUG_EVENT
 1

	)

39 
	s_SYSTEM_INFO
 {

41 
DWORD
 
	mdwOemId
;

43 
WORD
 
	mwPro˚ss‹Archôe˘uª
;

44 
WORD
 
	mwRe£rved
;

47 
DWORD
 
	mdwPageSize
;

48 
LPVOID
 
	mÕMöimumAµliˇti⁄Addªss
;

49 
LPVOID
 
	mÕMaximumAµliˇti⁄Addªss
;

50 
DWORD_PTR
 
	mdwA˘ivePro˚ss‹Mask
;

51 
DWORD
 
	mdwNumbîOfPro˚ss‹s
;

52 
DWORD
 
	mdwPro˚ss‹Ty≥
;

53 
DWORD
 
	mdwAŒoˇti⁄Gønuœrôy
;

54 
WORD
 
	mwPro˚ss‹Levñ
;

55 
WORD
 
	mwPro˚ss‹Revisi⁄
;

56 } 
	tSYSTEM_INFO
;

58 
	s_EXCEPTION_RECORD
 {

59 
DWORD
 
	mEx˚±i⁄Code
;

60 
DWORD
 
	mEx˚±i⁄Fœgs
;

61 
_EXCEPTION_RECORD
* 
	mEx˚±i⁄Rec‹d
;

62 
PVOID
 
	mEx˚±i⁄Addªss
;

63 
DWORD
 
	mNumbîP¨amëîs
;

64 
ULONG_PTR
 
	mEx˚±i⁄Inf‹m©i⁄
[
EXCEPTION_MAXIMUM_PARAMETERS
];

65 } 
	tEXCEPTION_RECORD
,

66 *
	tPEXCEPTION_RECORD
;

68 
	s_EXCEPTION_DEBUG_INFO
 {

69 
EXCEPTION_RECORD
 
	mEx˚±i⁄Rec‹d
;

70 
DWORD
 
	mdwFú°Ch™˚
;

71 } 
	tEXCEPTION_DEBUG_INFO
,

72 *
	tLPEXCEPTION_DEBUG_INFO
;

74 
	s_DEBUG_EVENT
 {

75 
DWORD
 
	mdwDebugEvítCode
;

76 
DWORD
 
	mdwPro˚ssId
;

77 
DWORD
 
	mdwThªadId
;

80 
EXCEPTION_DEBUG_INFO
 
	mEx˚±i⁄
;

81 } 
	mu
;

82 } 
	tDEBUG_EVENT
,

83 *
	tLPDEBUG_EVENT
;

85 
	sègMODULEENTRY32
 {

86 
DWORD
 
	mdwSize
;

87 
DWORD
 
	mth32ModuÀID
;

88 
DWORD
 
	mth32Pro˚ssID
;

89 
DWORD
 
	mGlbl˙tUßge
;

90 
DWORD
 
	mProc˙tUßge
;

91 
BYTE
* 
	mmodBa£Addr
;

92 
DWORD
 
	mmodBa£Size
;

93 
HMODULE
 
	mhModuÀ
;

94 
TCHAR
 
	mszModuÀ
[
MAX_MODULE_NAME32
 + 1];

95 
TCHAR
 
	mszExeP©h
[
MAX_PATH
];

96 } 
	tMODULEENTRY32
,

97 *
	tPMODULEENTRY32
;

99 
	sègPROCESSENTRY32
 {

100 
DWORD
 
	mdwSize
;

101 
DWORD
 
	m˙tUßge
;

102 
DWORD
 
	mth32Pro˚ssID
;

103 
ULONG_PTR
 
	mth32DeÁu…HópID
;

104 
DWORD
 
	mth32ModuÀID
;

105 
DWORD
 
	m˙tThªads
;

106 
DWORD
 
	mth32P¨ítPro˚ssID
;

107 
LONG
 
	mpcPriCœssBa£
;

108 
DWORD
 
	mdwFœgs
;

109 
TCHAR
 
	mszExeFûe
[
MAX_PATH
];

110 } 
	tPROCESSENTRY32
,

111 *
	tPPROCESSENTRY32
;

113 
	sègTHREADENTRY32
 {

114 
DWORD
 
	mdwSize
;

115 
DWORD
 
	m˙tUßge
;

116 
DWORD
 
	mth32ThªadID
;

117 
DWORD
 
	mth32Ow√rPro˚ssID
;

118 
LONG
 
	mçBa£Pri
;

119 
LONG
 
	mçDñèPri
;

120 
DWORD
 
	mdwFœgs
;

121 } 
	tTHREADENTRY32
,

122 *
	tPTHREADENTRY32
;

124 
	#MAXIMUM_SUPPORTED_EXTENSION
 512

	)

125 
	#SIZE_OF_80387_REGISTERS
 80

	)

127 
	s_FLOATING_SAVE_AREA
 {

128 
DWORD
 
	mC⁄åﬁW‹d
;

129 
DWORD
 
	mSètusW‹d
;

130 
DWORD
 
	mTagW‹d
;

131 
DWORD
 
	mEº‹Off£t
;

132 
DWORD
 
	mEº‹Sñe˘‹
;

133 
DWORD
 
	mD©aOff£t
;

134 
DWORD
 
	mD©aSñe˘‹
;

135 
BYTE
 
	mRegi°îAªa
[
SIZE_OF_80387_REGISTERS
];

136 
DWORD
 
	mCr0NpxSèã
;

137 } 
	tFLOATING_SAVE_AREA
;

139 
	s_CONTEXT
 {

140 
DWORD
 
	mC⁄ãxtFœgs
;

141 
DWORD
 
	mDr0
;

142 
DWORD
 
	mDr1
;

143 
DWORD
 
	mDr2
;

144 
DWORD
 
	mDr3
;

145 
DWORD
 
	mDr6
;

146 
DWORD
 
	mDr7
;

147 
FLOATING_SAVE_AREA
 
	mFlﬂtSave
;

148 
DWORD
 
	mSegGs
;

149 
DWORD
 
	mSegFs
;

150 
DWORD
 
	mSegEs
;

151 
DWORD
 
	mSegDs
;

152 
DWORD
 
	mEdi
;

153 
DWORD
 
	mEsi
;

154 
DWORD
 
	mEbx
;

155 
DWORD
 
	mEdx
;

156 
DWORD
 
	mEcx
;

157 
DWORD
 
	mEax
;

158 
DWORD
 
	mEbp
;

159 
DWORD
 
	mEù
;

160 
DWORD
 
	mSegCs
;

161 
DWORD
 
	mEFœgs
;

162 
DWORD
 
	mE•
;

163 
DWORD
 
	mSegSs
;

164 
BYTE
 
	mExãndedRegi°îs
[
MAXIMUM_SUPPORTED_EXTENSION
];

165 } 
	tCONTEXT
;

168 
	s_STARTUPINFO
 {

169 
DWORD
 
	mcb
;

170 
LPTSTR
 
	mÕRe£rved
;

171 
LPTSTR
 
	mÕDeskt›
;

172 
LPTSTR
 
	mÕTôÀ
;

173 
DWORD
 
	mdwX
;

174 
DWORD
 
	mdwY
;

175 
DWORD
 
	mdwXSize
;

176 
DWORD
 
	mdwYSize
;

177 
DWORD
 
	mdwXCou¡Ch¨s
;

178 
DWORD
 
	mdwYCou¡Ch¨s
;

179 
DWORD
 
	mdwFûlAâribuã
;

180 
DWORD
 
	mdwFœgs
;

181 
WORD
 
	mwShowWödow
;

182 
WORD
 
	mcbRe£rved2
;

183 
LPBYTE
 
	mÕRe£rved2
;

184 
HANDLE
 
	mhStdI≈ut
;

185 
HANDLE
 
	mhStdOuçut
;

186 
HANDLE
 
	mhStdEº‹
;

187 } 
	tSTARTUPINFO
,

188 *
	tLPSTARTUPINFO
;

190 
	s_PROCESS_INFORMATION
 {

191 
HANDLE
 
	mhPro˚ss
;

192 
HANDLE
 
	mhThªad
;

193 
DWORD
 
	mdwPro˚ssId
;

194 
DWORD
 
	mdwThªadId
;

195 } 
	tPROCESS_INFORMATION
,

196 *
	tLPPROCESS_INFORMATION
;

198 
	s_MEMORY_BASIC_INFORMATION
 {

199 
PVOID
 
	mBa£Addªss
;

200 
PVOID
 
	mAŒoˇti⁄Ba£
;

201 
DWORD
 
	mAŒoˇti⁄PrŸe˘
;

202 
SIZE_T
 
	mRegi⁄Size
;

203 
DWORD
 
	mSèã
;

204 
DWORD
 
	mPrŸe˘
;

205 
DWORD
 
	mTy≥
;

206 } 
	tMEMORY_BASIC_INFORMATION
,

207 *
	tPMEMORY_BASIC_INFORMATION
;

209 
	s_LUID
 {

210 
DWORD
 
	mLowP¨t
;

211 
LONG
 
	mHighP¨t
;

212 } 
	tLUID
,

213 *
	tPLUID
;

215 
	s_LUID_AND_ATTRIBUTES
 {

216 
LUID
 
	mLuid
;

217 
DWORD
 
	mAâribuãs
;

218 } 
	tLUID_AND_ATTRIBUTES
,

219 *
	tPLUID_AND_ATTRIBUTES
;

221 
	s_TOKEN_PRIVILEGES
 {

222 
DWORD
 
	mPrivûegeCou¡
;

223 
LUID_AND_ATTRIBUTES
 
	mPrivûeges
[
ANYSIZE_ARRAY
];

224 } 
	tTOKEN_PRIVILEGES
,

225 *
	tPTOKEN_PRIVILEGES
;

227 
	s_T⁄e
{

228 
BYTE
 
	mBa£Mid
;

229 
BYTE
 
	mFœgs1
;

230 
BYTE
 
	mFœgs2
;

231 
BYTE
 
	mBa£Hi
;

232 } 
	tT⁄e
;

234 
	s_Ttwo
{

235 
DWORD
 
	mBa£Mid
;

236 
DWORD
 
	mTy≥
;

237 
DWORD
 
	mD∂
;

238 
DWORD
 
	mPªs
;

239 
DWORD
 
	mLimôHi
;

240 
DWORD
 
	mSys
;

241 
DWORD
 
	mRe£rved_0
;

242 
DWORD
 
	mDeÁu…_big
;

243 
DWORD
 
	mGønuœrôy
;

244 
DWORD
 
	mBa£Hi
;

245 } 
	tTtwo
;

247 
	s_BLAH
{

248 
T⁄e
 
	mByãs
;

249 
Ttwo
 
	mBôs
;

250 } 
	tBLAH
;

252 
	s_LDT_ENTRY
 {

253 
WORD
 
	mLimmôLow
;

254 
WORD
 
	mBa£Low
;

255 
BLAH
 
	mHighW‹d
;

256 } 
	tLDT_ENTRY
,

257 *
	tLPLDT_ENTRY
;

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\olly_callbacks.h

24 
BOOL
 
WINAPI
 
	$DŒE¡ryPoöt
 (
HINSTANCE
 
hi
, 
DWORD
 
ªas⁄
, 
LPVOID
 
ª£rved
)

26 i‡(
ªas⁄
 =
DLL_PROCESS_ATTACH
)

27 
hö°
 = 
hi
;

29  
TRUE
;

30 
	}
}

33 
_exp‹t
 
cde˛
 
	$ODBG_Plugöd©a
 (
sh‹äame
[32])

35 
	`°r˝y
(
sh‹äame
, "PaiMei Connector");

36  
PLUGIN_VERSION
;

37 
	}
}

40 
_exp‹t
 
cde˛
 
	$ODBG_Plugööô
 (
ﬁlydbgvîsi⁄
, 
HWND
 
hw
, 
ul⁄g
 *
„©uªs
)

42 i‡(
ﬁlydbgvîsi⁄
 < 
PLUGIN_VERSION
)

46 
hwmaö
 = 
hw
;

48 
	`ﬁly_add_to_li°
(0, 0, "PaiMeòC⁄√˘‹ Plug-ö compûed o¿" 
__DATE__
);

49 
	`ﬁly_add_to_li°
(0, -1, " Copyright (c) 2006 Pedram Amini <pedram.amini@gmail.com>");

52 
	}
}

55 
_exp‹t
 
cde˛
 
	$ODBG_Plugöde°roy
 ()

57 
	}
}

60 
_exp‹t
 
cde˛
 
	$ODBG_Plugömíu
 (
‹igö
, 
d©a
[4096], *
ôem
)

62 
‹igö
)

64 
PM_MAIN
:

65 
	`°r˝y
(
d©a
,

72 
PM_DISASM
:

73 
PM_CPUDUMP
:

74 
	`°r˝y
(
d©a
,

85 
	}
}

88 
_exp‹t
 
cde˛
 
	$ODBG_Plugöa˘i⁄
 (
‹igö
, 
a˘i⁄
, *
ôem
)

90 
t_dump
 *
pd
;

91 
pd
 = (
t_dump
 *Ë
ôem
;

93 
‹igö
)

95 
PM_MAIN
:

96 
PM_DISASM
:

97 
PM_CPUDUMP
:

98 
a˘i⁄
)

102 
	`∑imei_c⁄√˘
();

107 
	`∑imei_xmô_loˇti⁄
(
pd
);

112 
	`˛o£sockë
(
c⁄√˘i⁄
);

113 
	`WSACÀ™up
();

114 
c⁄√˘i⁄
 = 
NULL
;

119 
	`MesßgeBox
(
hwmaö
,

123 
MB_OK
 | 
MB_ICONINFORMATION
);

130 
	}
}

133 
_exp‹t
 
cde˛
 
	$ODBG_Plugösh‹tcut
(
‹igö
, 
˘æ
, 
Æt
, 
shi·
, 
key
, *
ôem
)

135 
t_dump
 *
pd
;

137 
pd
 = (
t_dump
 *Ë
ôem
;

139 
‹igö
)

141 
PM_DISASM
:

143 i‡(
key
 == 188 || key == 190 || key == 191)

145 i‡(!
c⁄√˘i⁄
)

146 
	`∑imei_c⁄√˘
();

149 i‡(
key
 == 188)

150 
	`Sídsh‹tcut
(
PM_MAIN
, 0, 
WM_KEYDOWN
, 0, 0, 
VK_F7
);

153 i‡(
key
 == 190)

154 
	`Sídsh‹tcut
(
PM_MAIN
, 0, 
WM_KEYDOWN
, 0, 0, 
VK_F8
);

157 
	`∑imei_xmô_loˇti⁄
(
pd
);

164 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\olly_redefines.h

22 #i‚de‡
__OLLY_REDEFINES_H__


23 
	#__OLLY_REDEFINES_H__


	)

25 
	#ﬁly_add_s‹ãd_d©a
 
Adds‹ãdd©a


	)

26 
	#ﬁly_add_to_li°
 
Addtﬁi°


	)

27 
	#ﬁly_©èch_to_a˘ive_¥o˚ss
 
Aâachtﬂ˘ivïro˚ss


	)

28 
	#ﬁly_brow£_fûíame
 
Brow£fûíame


	)

29 
	#ﬁly_¸óã_dump_wödow
 
Cª©edumpwödow


	)

30 
	#ﬁly_¸óã_s‹ãd_d©a
 
Cª©es‹ãdd©a


	)

31 
	#ﬁly_de°roy_s‹ãd_d©a
 
De°roys‹ãdd©a


	)

32 
	#ﬁly_föd_moduÀ
 
FödmoduÀ


	)

33 
	#ﬁly_föd_s‹ãd_d©a
 
Föds‹ãdd©a


	)

34 
	#ﬁly_föd_thªad
 
Födthªad


	)

35 
	#ﬁly_gë_˝u_thªad_id
 
Gë˝uthªadid


	)

36 
	#ﬁly_gë_l⁄g
 
Gël⁄g


	)

37 
	#ﬁly_gë_hex_°rög
 
Gëhex°rög


	)

38 
	#ﬁly_gë_s‹ãd_by_£À˘i⁄
 
Gës‹ãdby£À˘i⁄


	)

39 
	#ﬁly_gë_°©us
 
Gë°©us


	)

40 
	#ﬁly_mesßge
 
Mesßge


	)

41 
	#ﬁly_∑öt_èbÀ
 
PaöâabÀ


	)

42 
	#ﬁly_quick_èbÀ_wödow
 
QuickèbÀwödow


	)

43 
	#ﬁly_ªad_mem‹y
 
Ródmem‹y


	)

44 
	#ﬁly_ªgi°î_∂ugö_˛ass
 
Regi°î∂ugö˛ass


	)

45 
	#ﬁly_èbÀ_fun˘i⁄
 
TabÀfun˘i⁄


	)

46 
	#ﬁly_uƒegi°î_∂ugö_˛ass
 
Uƒegi°î∂ugö˛ass


	)

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\paimei_ollydbg_connector.cpp

22 
	~"°dafx.h
"

23 
	~<°dio.h
>

25 
	~"ﬁly_ªdeföes.h
"

26 
	~"∂ugö.h
"

27 
	~"∑imei_ﬁlydbg_c⁄√˘‹.h
"

28 
	~"ﬁly_ˇŒbacks.h
"

34 
	$∑imei_c⁄√˘
 ()

36 
ho°ít
 *
he
;

37 
sockaddr_ö
 
sö
;

38 
ö_addr
 
addr
;

39 
WSADATA
 
wß_d©a
;

41 
£rvî
[256];

43 
	`mem£t
(
£rvî
, 0, (server));

44 
	`°r˝y
(
£rvî
, "127.0.0.1");

47 i‡(
c⁄√˘i⁄
)

50 i‡(
	`Gëãxt
("PaiMeòSîvî:", 
£rvî
, 0x00, 
NM_NONAME
, 
FIXEDFONT
) == -1)

54 i‡(
	`WSASèπup
(
	`MAKEWORD
(2, 2), &
wß_d©a
) != 0)

56 
	`ﬁly_add_to_li°
(0, 1, "[!] "
PLUGIN_NAME
"> WSAStartup() failed.");

61 i‡(
	`LOBYTE
(
wß_d©a
.
wVîsi⁄
Ë!2 || 
	`HIBYTE
(wsa_data.wVersion) != 2)

63 
	`WSACÀ™up
();

64 
	`ﬁly_add_to_li°
(0, 1, 
PLUGIN_NAME
"> Winsock version 2.2Çot found.");

69 i‡(
	`ißÕha
(
£rvî
[0]))

71 i‡((
he
 = 
	`gëho°by«me
(
£rvî
)Ë=
NULL
)

73 
	`ﬁly_add_to_li°
(0, 1, "[!] "
PLUGIN_NAME
"> U«bÀÅÿªsﬁvê«me: %s", 
£rvî
);

80 
addr
.
s_addr
 = 
	`öë_addr
(
£rvî
);

82 i‡((
he
 = 
	`gëho°byaddr
((*)&
addr
, (
ö_addr
), 
AF_INET
)Ë=
NULL
)

84 
	`ﬁly_add_to_li°
(0, 1, "[!] "
PLUGIN_NAME
"> UnableÅoÑesolveáddress");

90 i‡((
c⁄√˘i⁄
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 
IPPROTO_TCP
)Ë=
INVALID_SOCKET
)

92 
	`WSACÀ™up
();

93 
	`ﬁly_add_to_li°
(0, 1, "[!] "
PLUGIN_NAME
"> FailedÅo create socket.");

98 
sö
.
sö_Ámûy
 = 
AF_INET
;

99 
sö
.
sö_addr
 = *((
LPIN_ADDR
)*
he
->
h_addr_li°
);

100 
sö
.
sö_p‹t
 = 
	`ht⁄s
(7033);

102 i‡(
	`c⁄√˘
(
c⁄√˘i⁄
, (
SOCKADDR
 *Ë&
sö
, (sö)Ë=
SOCKET_ERROR
)

104 
	`WSACÀ™up
();

105 
	`ﬁly_add_to_li°
(0, 1, "[!] "
PLUGIN_NAME
"> FailedÅo connectÅo server.");

108 
	}
}

115 
	$∑imei_xmô_loˇti⁄
 (
t_dump
 *
pd
)

117 
t_moduÀ
 *
tmod
;

118 
buf
[128];

119 
size_t
 
Àn
;

121 i‡(!
c⁄√˘i⁄
)

123 
	`ﬁly_add_to_li°
(0, 1, "connectÅoÖaimeiÑeceiver first.");

127 i‡(!
pd
)

129 
	`ﬁly_add_to_li°
(0, 1, "no current itemÅo xmit.");

133 
tmod
 = 
	`ﬁly_föd_moduÀ
(
pd
->
£l0
);

136 
tmod
->
«me
[
SHORTLEN
] = 0;

138 
	`ﬁly_add_to_li°
(0, 0, "%08x i†ö %†ba£dáà%08x", 
pd
->
£l0
, 
tmod
->
«me
,Åmod->
ba£
);

140 
	`•rötf
(
buf
, "%s:%08x\n", 
tmod
->
«me
, 
pd
->
£l0
 -Åmod->
ba£
);

141 
Àn
 = 
	`°æí
(
buf
);

144 i‡(
	`£nd
(
c⁄√˘i⁄
, 
buf
, 
Àn
, 0) !=Üen)

146 
	`˛o£sockë
(
c⁄√˘i⁄
);

147 
	`WSACÀ™up
();

148 
c⁄√˘i⁄
 = 
NULL
;

150 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\paimei_ollydbg_connector.h

20 #i‚de‡
__OLLY_PAIMEI_CONNECTOR_H__


21 
	#__OLLY_PAIMEI_CONNECTOR_H__


	)

23 #unde‡
DEBUG


24 
	#PLUGIN_NAME
 "PaiMeòC⁄√˘‹"

	)

30 
HINSTANCE
 
	ghö°
;

31 
HWND
 
	ghwmaö
;

32 
SOCKET
 
	gc⁄√˘i⁄
 = 
NULL
;

38 
∑imei_c⁄√˘
 ();

39 
∑imei_xmô_loˇti⁄
 (
t_dump
 *);

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\plugin.h

33 #ifde‡
__BORLANDC__


35 #¥agm®
›ti⁄
 -
a1


36 #¥agm®
›ti⁄
 -
K


41 
	st_Æig¡e°
 {

42 
	ma
;

43 
	mb
;

44 } 
	tt_Æig¡e°
;

46 #i‡((
t_Æig¡e°
)!=()+())

47 #îr‹ 
PÀa£
 
assuª
 
byã
 
Æignmít
 
of
 
OŒyDbg
 
°ru˘uªs


49 #unde‡
t_Æig¡e°


52 #îr‹ 
PÀa£
 
£t
  
ty≥
 
to
 

59 #ifde‡
_MSC_VER


61 #¥agm®
∑ck
(1)

63 #i‚de‡
_CHAR_UNSIGNED


64 #îr‹ 
PÀa£
 
£t
  
ty≥
 
to
 (
›ti⁄
 /
J
)

70 
	#ODBG_Plugöd©a
 
_ODBG_Plugöd©a


	)

71 
	#ODBG_Plugööô
 
_ODBG_Plugööô


	)

72 
	#ODBG_Plugömaölo›
 
_ODBG_Plugömaölo›


	)

73 
	#ODBG_Plugößveudd
 
_ODBG_Plugößveudd


	)

74 
	#ODBG_Plugöuddªc‹d
 
_ODBG_Plugöuddªc‹d


	)

75 
	#ODBG_Plugömíu
 
_ODBG_Plugömíu


	)

76 
	#ODBG_Plugöa˘i⁄
 
_ODBG_Plugöa˘i⁄


	)

77 
	#ODBG_Plugösh‹tcut
 
_ODBG_Plugösh‹tcut


	)

78 
	#ODBG_Plugöª£t
 
_ODBG_Plugöª£t


	)

79 
	#ODBG_Plugö˛o£
 
_ODBG_Plugö˛o£


	)

80 
	#ODBG_Plugöde°roy
 
_ODBG_Plugöde°roy


	)

81 
	#ODBG_Pau£d
 
_ODBG_Pau£d


	)

82 
	#ODBG_Pau£dex
 
_ODBG_Pau£dex


	)

83 
	#ODBG_Plugöcmd
 
_ODBG_Plugöcmd


	)

91 
	#PLUGIN_VERSION
 110

92 

	)

93 #ifde‡
__˝lu•lus


94 
	#extc
 "C"

95 #ñ£

	)

96 
	#extc
 

	)

99 
	#_exp‹t
 
	`__de˛•ec
(
dŒexp‹t
)

	)

101 
	tuch¨
;

102 
	tush‹t
;

103 
	tuöt
;

104 
	tul⁄g
;

106 
	#TEXTLEN
 256

107 
	#ARGLEN
 1024

108 
	#USERLEN
 4096

109 
	#SHORTLEN
 8

110 

	)

111 
	#BLACK
 0

112 
	#BLUE
 1

113 
	#GREEN
 2

114 
	#CYAN
 3

115 
	#RED
 4

	)

116 
	#MAGENTA
 5

	)

117 
	#BROWN
 6

	)

118 
	#LIGHTGRAY
 7

	)

119 
	#DARKGRAY
 8

	)

120 
	#LIGHTBLUE
 9

	)

121 
	#LIGHTGREEN
 10

	)

122 
	#LIGHTCYAN
 11

	)

123 
	#LIGHTRED
 12

	)

124 
	#LIGHTMAGENTA
 13

	)

125 
	#YELLOW
 14

	)

126 
	#WHITE
 15

	)

127 
	#MINT
 16

	)

128 
	#SKYBLUE
 17

	)

129 
	#IVORY
 18

	)

130 
	#GRAY
 19

	)

132 
	#NCOLORS
 20

133 

	)

134 
	#BKTRANSP
 0x00

135 
	#BKBLACK
 0x10

	)

136 
	#BKGRAY
 0x20

	)

137 
	#BKWHITE
 0x30

	)

138 
	#BKCYAN
 0x40

	)

139 
	#BKGREEN
 0x50

	)

140 
	#BKRED
 0x60

	)

141 
	#BKYELLOW
 0x70

	)

143 
	#BLACKWHITE
 0

144 
	#BLUEGOLD
 1

	)

145 
	#SKYWIND
 2

	)

146 
	#NIGHTSTARS
 3

	)

147 
	#SCHEME4
 4

	)

148 
	#SCHEME5
 5

	)

149 
	#SCHEME6
 6

	)

150 
	#SCHEME7
 7

	)

152 
	#FIXEDFONT
 0

153 
	#TERMINAL6
 1

154 
	#FIXEDSYS
 2

155 
	#COURIERFONT
 3

	)

156 
	#LUCIDACONS
 4

	)

157 
	#FONT5
 5

	)

158 
	#FONT6
 6

	)

159 
	#FONT7
 7

	)

160 
	#MAINFONT
 8

	)

161 
	#SYSFONT
 9

	)

162 
	#INFOFONT
 10

	)

167 
extc
 
cde˛
 
Addtﬁi°
(
addr
,
highlight
,*
f‹m©
,...);

168 
extc
 
cde˛
 
Upd©ñi°
();

169 
extc
 
HWND
 
cde˛
 
Cª©ñi°wödow
();

170 
extc
 
cde˛
 
Eº‹
(*
f‹m©
,...);

171 
extc
 
cde˛
 
Mesßge
(
ul⁄g
 
addr
,*
f‹m©
,...);

172 
extc
 
cde˛
 
Infﬁöe
(*
f‹m©
,...);

173 
extc
 
cde˛
 
Progªss
(
¥omûÀ
,*
f‹m©
,...);

174 
extc
 
cde˛
 
Fœsh
(*
f‹m©
,...);

181 
	#ADC_DEFAULT
 0x0000

182 
	#ADC_DIFFMOD
 0x0001

183 
	#ADC_NOMODNAME
 0x0002

184 
	#ADC_VALID
 0x0004

185 
	#ADC_INMODULE
 0x0008

186 
	#ADC_SAMEMOD
 0x0010

187 
	#ADC_SYMBOL
 0x0020

188 
	#ADC_JUMP
 0x0040

189 
	#ADC_OFFSET
 0x0080

190 
	#ADC_STRING
 0x0100

191 
	#ADC_ENTRY
 0x0200

192 
	#ADC_UPPERCASE
 0x0400

193 
	#ADC_WIDEFORM
 0x0800

194 
	#ADC_NONTRIVIAL
 0x1000

195 
	#ADC_DYNAMIC
 0x2000

196 

	)

197 
	#PLAINASCII
 0x01

198 
	#DIACRITICAL
 0x02

199 
	#RAREASCII
 0x10

200 

	)

201 
extc
 
cde˛
 
Decodóddªss
(
ul⁄g
 
addr
,ul⁄g 
ba£
,
addrmode
,

202 *
symb
,
nsymb
,*
commít
);

203 
extc
 
cde˛
 
Decodîñ©iveoff£t
(
ul⁄g
 
addr
,
addrmode
,

204 *
symb
,
nsymb
);

205 
extc
 
cde˛
 
Decodech¨a˘î
(*
s
,
uöt
 
c
);

206 
extc
 
cde˛
 
PrötÊﬂt4
(*
s
,
f
);

207 
extc
 
cde˛
 
PrötÊﬂt8
(*
s
,
d
);

208 
extc
 
cde˛
 
PrötÊﬂt10
(*
s
,
ext
);

209 
extc
 
cde˛
 
Pröt3dnow
(*
s
,
uch¨
 *
f
);

210 
extc
 
cde˛
 
Pröts£
(*
s
,*
f
);

211 
extc
 
ul⁄g
 
cde˛
 
FﬁlowˇŒ
(ul⁄g 
addr
);

212 
extc
 
cde˛
 
I°extA
(
c
);

213 
extc
 
cde˛
 
I°extW
(
wch¨_t
 
w
);

214 
extc
 
cde˛
 
SåögtŸext
(*
d©a
,
nd©a
,*
ãxt
,
¡ext
);

219 
	#MAXCMDSIZE
 16

220 
	#NSEQ
 8

221 
	#NMODELS
 8

222 

	)

224 
	#DIA_ASKGLOBAL
 0x0001

225 
	#DIA_HEXONLY
 0x0002

226 
	#DIA_ALIGNED
 0x0004

227 
	#DIA_DEFHEX
 0x0000

228 
	#DIA_DEFASCII
 0x0010

229 
	#DIA_DEFUNICODE
 0x0020

230 
	#DIA_SEARCH
 0x0040

231 
	#DIA_HISTORY
 0x0100

232 

	)

234 
	#ANIMATE_OFF
 0

235 
	#ANIMATE_IN
 1

236 
	#ANIMATE_OVER
 2

237 
	#ANIMATE_RET
 3

238 
	#ANIMATE_SKPRET
 4

239 
	#ANIMATE_USER
 5

240 
	#ANIMATE_TRIN
 6

241 
	#ANIMATE_TROVER
 7

242 
	#ANIMATE_STOP
 8

243 

	)

244 
	st_hex°r
 {

245 
	mn
;

246 
uch¨
 
	md©a
[
TEXTLEN
];

247 
uch¨
 
	mmask
[
TEXTLEN
];

248 } 
	tt_hex°r
;

250 
	st_asmmodñ
 {

251 
uch¨
 
	mcode
[
MAXCMDSIZE
];

252 
uch¨
 
	mmask
[
MAXCMDSIZE
];

253 
	mÀngth
;

254 
	mjmpsize
;

255 
	mjmpoff£t
;

256 
	mjmµos
;

257 } 
	tt_asmmodñ
;

259 
	st_extmodñ
 {

260 
	mcode
[
MAXCMDSIZE
];

261 
	mmask
[
MAXCMDSIZE
];

262 
	mÀngth
;

263 
	mjmpsize
;

264 
	mjmpoff£t
;

265 
	mjmµos
;

266 
	mißny
;

267 
	mcmdoff£t
;

268 
	mømask
[
MAXCMDSIZE
];

269 
	mrbmask
[
MAXCMDSIZE
];

270 } 
	tt_extmodñ
;

272 
extc
 
cde˛
 
Gël⁄g
(*
tôÀ
,
ul⁄g
 *
d©a
,
d©asize
,

273 
Àâî
,
mode
);

274 
extc
 
cde˛
 
Gël⁄gxy
(*
tôÀ
,
ul⁄g
 *
d©a
,
d©asize
,

275 
Àâî
,
mode
,
x
,
y
);

276 
extc
 
cde˛
 
Gëªgxy
(*
tôÀ
,
ul⁄g
 *
d©a
,
Àâî
,
x
,
y
);

277 
extc
 
cde˛
 
Gëlöe
(*
tôÀ
,
ul⁄g
 *
d©a
);

278 
extc
 
cde˛
 
Gëlöexy
(*
tôÀ
,
ul⁄g
 *
d©a
,
x
,
y
);

279 
extc
 
cde˛
 
GëÊﬂt10
(*
tôÀ
,*
fd©a
,

280 
uch¨
 *
èg
,
Àâî
,
mode
);

281 
extc
 
cde˛
 
GëÊﬂt10xy
(*
tôÀ
,*
fd©a
,

282 *
èg
,
Àâî
,
mode
,
x
,
y
);

283 
extc
 
cde˛
 
GëÊﬂt
(*
tôÀ
,*
fd©a
,
size
,

284 
Àâî
,
mode
);

285 
extc
 
cde˛
 
GëÊﬂtxy
(*
tôÀ
,*
fd©a
,
size
,

286 
Àâî
,
mode
,
x
,
y
);

287 
extc
 
cde˛
 
Gëasmfödmodñ
(
t_asmmodñ
 
modñ
[
NMODELS
],

288 
Àâî
,
£¨chÆl
);

289 
extc
 
cde˛
 
Gëasmfödmodñxy
(
t_asmmodñ
 
modñ
[
NMODELS
],

290 
Àâî
,
£¨chÆl
,
x
,
y
);

291 
extc
 
cde˛
 
Gëãxt
(*
tôÀ
,*
ãxt
,

292 
Àâî
,
ty≥
,
f⁄tödex
);

293 
extc
 
cde˛
 
Gëãxtxy
(*
tôÀ
,*
ãxt
,
Àâî
,

294 
ty≥
,
f⁄tödex
,
x
,
y
);

295 
extc
 
cde˛
 
Gëhex°rög
(*
tôÀ
,
t_hex°r
 *
hs
,

296 
mode
,
f⁄tödex
,
Àâî
);

297 
extc
 
cde˛
 
Gëhex°rögxy
(*
tôÀ
,
t_hex°r
 *
hs
,
mode
,

298 
f⁄tödex
,
Àâî
,
x
,
y
);

299 
extc
 
cde˛
 
Gëmmx
(*
tôÀ
,
uch¨
 *
d©a
,
mode
);

300 
extc
 
cde˛
 
Gëmmxxy
(*
tôÀ
,*
d©a
,
mode
,
x
,
y
);

301 
extc
 
cde˛
 
Gë3dnow
(*
tôÀ
,
uch¨
 *
d©a
,
mode
);

302 
extc
 
cde˛
 
Gë3dnowxy
(*
tôÀ
,*
d©a
,
mode
,
x
,
y
);

303 
extc
 
cde˛
 
Brow£fûíame
(*
tôÀ
,*
«me
,*
de„xt
,

304 
gë¨gumíts
);

305 
extc
 
cde˛
 
O≥nEXEfûe
(*
∑th
,
dr›≥d
);

306 
extc
 
cde˛
 
Aâachtﬂ˘ivïro˚ss
(
√w¥o˚ssid
);

307 
extc
 
cde˛
 
Anim©e
(
™im©i⁄
);

312 
	#NBAR
 17

313 

	)

314 
	#BAR_PRESSED
 0x01

315 
	#BAR_DISABLED
 0x02

316 
	#BAR_NOSORT
 0x04

317 
	#BAR_NORESIZE
 0x08

318 
	#BAR_BUTTON
 0x10

319 
	#BAR_SHIFTSEL
 0x20

320 

	)

321 
	#CAPT_FREE
 0

322 

	)

323 
	#TABLE_DIR
 0x0001

324 
	#TABLE_COPYMENU
 0x0002

325 
	#TABLE_SORTMENU
 0x0004

326 
	#TABLE_APPMENU
 0x0010

327 
	#TABLE_WIDECOL
 0x0020

328 
	#TABLE_USERAPP
 0x0040

329 
	#TABLE_USERDEF
 0x0080

330 
	#TABLE_NOHSCR
 0x0100

331 
	#TABLE_SAVEPOS
 0x0200

332 
	#TABLE_CPU
 0x0400

333 
	#TABLE_FASTSEL
 0x0800

334 
	#TABLE_COLSEL
 0x1000

335 
	#TABLE_SAVEAPP
 0x2000

336 
	#TABLE_HILMENU
 0x4000

337 
	#TABLE_ONTOP
 0x8000

338 

	)

339 
	#DRAW_NORMAL
 0x0000

340 
	#DRAW_GRAY
 0x0001

341 
	#DRAW_HILITE
 0x0002

342 
	#DRAW_UL
 0x0004

343 
	#DRAW_SELECT
 0x0008

344 
	#DRAW_EIP
 0x0010

345 
	#DRAW_BREAK
 0x0020

346 
	#DRAW_GRAPH
 0x0040

347 
	#DRAW_DIRECT
 0x0080

348 
	#DRAW_MASK
 0x0080

349 
	#DRAW_EXTSEL
 0x0100

350 
	#DRAW_UNICODE
 0x0200

351 
	#DRAW_TOP
 0x0400

352 
	#DRAW_BOTTOM
 0x0800

353 

	)

356 
	#D_SPACE
 'N'

357 
	#D_SEP
 ' '

358 
	#D_BEGIN
 'B'

359 
	#D_BODY
 'I'

360 
	#D_ENTRY
 'J'

361 
	#D_LEAF
 'K'

362 
	#D_END
 'E'

363 
	#D_SINGLE
 'S'

364 
	#D_ENDBEG
 'T'

365 
	#D_POINT
 '.'

366 
	#D_JMPUP
 'U'

367 
	#D_JMPOUT
 '<'

368 
	#D_JMPDN
 'D'

369 
	#D_PATHUP
 'u'

370 
	#D_GRAYUP
 'v'

371 
	#D_PATH
 'i'

372 
	#D_GRAYPATH
 'j'

373 
	#D_PATHDN
 'd'

374 
	#D_GRAYDN
 'e'

375 
	#D_PATHUPEND
 'r'

376 
	#D_GRAYUPEND
 's'

377 
	#D_PATHDNEND
 'f'

378 
	#D_GRAYDNEND
 'g'

379 
	#D_SWTOP
 't'

380 
	#D_SWBODY
 'b'

381 
	#D_CASE
 'c'

382 
	#D_LASTCASE
 'l'

383 

	)

388 
	#TY_NEW
 0x00000001

389 
	#TY_CONFIRMED
 0x00000002

390 
	#TY_MAIN
 0x00000004

391 
	#TY_INVALID
 0x00000008

392 
	#TY_SELECTED
 0x80000000

394 
	#TY_REPORTED
 0x00000010

396 
	#TY_REFERENCE
 0x00000020

397 
	#TY_ORIGIN
 0x00000040

399 
	#TY_STOPAN
 0x00000080

400 
	#TY_SET
 0x00000100

401 
	#TY_ACTIVE
 0x00000200

402 
	#TY_DISABLED
 0x00000400

403 
	#TY_ONESHOT
 0x00000800

404 
	#TY_TEMP
 0x00001000

405 
	#TY_KEEPCODE
 0x00002000

406 
	#TY_KEEPCOND
 0x00004000

407 
	#TY_NOUPDATE
 0x00008000

408 
	#TY_RTRACE
 0x00010000

410 
	#TY_EXPORT
 0x00010000

411 
	#TY_IMPORT
 0x00020000

412 
	#TY_LIBRARY
 0x00040000

413 
	#TY_LABEL
 0x00080000

414 
	#TY_ANYNAME
 0x000F0000

415 
	#TY_KNOWN
 0x00100000

417 
	#TY_DEFHEAP
 0x00020000

418 
	#TY_HEAP
 0x00040000

419 
	#TY_SFX
 0x00080000

420 
	#TY_CODE
 0x00100000

421 
	#TY_DATA
 0x00200000

422 
	#TY_IMPDATA
 0x00400000

423 
	#TY_EXPDATA
 0x00800000

424 
	#TY_RSRC
 0x01000000

425 
	#TY_RELOC
 0x02000000

426 
	#TY_STACK
 0x04000000

427 
	#TY_THREAD
 0x08000000

428 
	#TY_HEADER
 0x10000000

429 
	#TY_ANYMEM
 0x1FFE0000

430 
	#TY_GUARDED
 0x20000000

432 
	#TY_PURE
 0x00004000

433 
	#TY_PASCAL
 0x00010000

434 
	#TY_C
 0x00020000

435 
	#TY_NOTENTRY
 0x00100000

437 
	#TY_CHARSW
 0x00100000

438 
	#TY_WMSW
 0x00200000

439 
	#TY_EXCEPTSW
 0x00400000

441 
	#TY_RELIABLE
 0x01000000

442 
	#TY_GUESSED
 0x02000000

443 
	#TY_BELONGS
 0x04000000

445 
	#TY_RECURSIVE
 0x00000100

446 
	#TY_TERMINAL
 0x00000200

447 
	#TY_SYSTEM
 0x00000400

448 
	#TY_DIRECT
 0x00000800

449 
	#TY_NODATA
 0x00001000

450 
	#TY_DUMMY
 0x00002000

451 
	#TY_NOSIDE
 0x00004000

452 

	)

453 
	st_scheme
 {

454 *
	m«me
;

455 
	mãxtcﬁ‹
;

456 
	mhôextcﬁ‹
;

457 
	mlowcﬁ‹
;

458 
	mbkcﬁ‹
;

459 
	m£lbkcﬁ‹
;

460 
	mlöecﬁ‹
;

461 
	mauxcﬁ‹
;

462 
	mc⁄dbkcﬁ‹
;

463 } 
	tt_scheme
;

465 
	st_scheme›t
 {

466 *
	m«me
;

467 
	mcﬁ‹
[8];

468 } 
	tt_scheme›t
;

470 
	st_b¨
 {

471 
	mnb¨
;

472 
	mf⁄t
;

473 
	mdx
[
NBAR
];

474 
	mdefdx
[
NBAR
];

475 *
	m«me
[
NBAR
];

476 
uch¨
 
	mmode
[
NBAR
];

477 
	mˇ±uªd
;

478 
	ma˘ive
;

479 
	m¥evx
;

480 } 
	tt_b¨
;

482 
	st_s‹thódî
 {

483 
ul⁄g
 
	maddr
;

484 
ul⁄g
 
	msize
;

485 
ul⁄g
 
	mty≥
;

486 } 
	tt_s‹thódî
;

488 
	tSORTFUNC
(c⁄° 
	tt_s‹thódî
 *,constÅ_sortheader *,const );

489 
	tDRAWFUNC
(*,*,*,
	tt_s‹thódî
 *,);

490 
	tDESTFUNC
(
	tt_s‹thódî
 *);

492 
	#AUTOARRANGE
 ((
SORTFUNC
 *)1)

493 

	)

494 
	st_s‹ãd
 {

495 
	m«me
[
MAX_PATH
];

496 
	mn
;

497 
	mnmax
;

498 
	m£À˘ed
;

499 
ul⁄g
 
	m£œddr
;

500 
	môemsize
;

501 
ul⁄g
 
	mvîsi⁄
;

502 *
	md©a
;

503 
SORTFUNC
 *
	ms‹tfunc
;

504 
DESTFUNC
 *
	mde°func
;

505 
	ms‹t
;

506 
	ms‹ãd
;

507 *
	mödex
;

508 
	msuµªs£º
;

509 } 
	tt_s‹ãd
;

511 
	st_èbÀ
 {

512 
HWND
 
	mhw
;

513 
t_s‹ãd
 
	md©a
;

514 
t_b¨
 
	mb¨
;

515 
	mshowb¨
;

516 
	mhs¸ﬁl
;

517 
	mcﬁ£l
;

518 
	mmode
;

519 
	mf⁄t
;

520 
	mscheme
;

521 
	mhûôe
;

522 
	moff£t
;

523 
	mxshi·
;

524 
DRAWFUNC
 *
	mdøwfunc
;

525 } 
	tt_èbÀ
;

527 
extc
 
cde˛
 
Cª©es‹ãdd©a
(
t_s‹ãd
 *
sd
,*
«me
,
ôemsize
,

528 
nmax
,
SORTFUNC
 *
s‹tfunc
,
DESTFUNC
 *
de°func
);

529 
extc
 
cde˛
 
De°roys‹ãdd©a
(
t_s‹ãd
 *
sd
);

530 
extc
 
cde˛
 *
Adds‹ãdd©a
(
t_s‹ãd
 *
sd
,*
ôem
);

531 
extc
 
cde˛
 
Dñëes‹ãdd©a
(
t_s‹ãd
 *
sd
,
ul⁄g
 
addr
);

532 
extc
 
cde˛
 
Dñëes‹ãdd©¨™ge
(
t_s‹ãd
 *
sd
,
ul⁄g
 
addr0
,ul⁄g 
addr1
);

533 
extc
 
cde˛
 
Dñëí⁄c⁄fúmeds‹ãdd©a
(
t_s‹ãd
 *
sd
);

534 
extc
 * 
cde˛
 
Föds‹ãdd©a
(
t_s‹ãd
 *
sd
,
ul⁄g
 
addr
);

535 
extc
 * 
cde˛
 
Föds‹ãdd©¨™ge
(
t_s‹ãd
 *
sd
,
ul⁄g
 
addr0
,ul⁄g 
addr1
);

536 
extc
 
cde˛
 
Föds‹ãdd©aödex
(
t_s‹ãd
 *
sd
,
ul⁄g
 
addr0
,ul⁄g 
addr1
);

537 
extc
 
cde˛
 
S‹ts‹ãdd©a
(
t_s‹ãd
 *
sd
,
s‹t
);

538 
extc
 * 
cde˛
 
Gës‹ãdby£À˘i⁄
(
t_s‹ãd
 *
sd
,
ödex
);

539 
extc
 
cde˛
 
DeÁu…b¨
(
t_b¨
 *
pb
);

540 
extc
 
cde˛
 
TabÀfun˘i⁄
(
t_èbÀ
 *
±
,

541 
HWND
 
hw
,
UINT
 
msg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

542 
extc
 
cde˛
 
PaöâabÀ
(
HWND
 
hw
,
t_èbÀ
 *
±
,
DRAWFUNC
 
gëlöe
);

543 
extc
 
cde˛
 
GëèbÀ£À˘i⁄xy
(
t_èbÀ
 *
±
,
cﬁumn
,*
px
,*
py
);

544 
extc
 
cde˛
 
Sñe˘™ds¸ﬁl
(
t_èbÀ
 *
±
,
ödex
,
mode
);

551 
	#NM_NONAME
 0x00

552 
	#NM_ANYNAME
 0xFF

554 
	#NM_PLUGCMD
 0x30

555 
	#NM_LABEL
 0x31

556 
	#NM_EXPORT
 0x32

557 
	#NM_IMPORT
 0x33

558 
	#NM_LIBRARY
 0x34

559 
	#NM_CONST
 0x35

560 
	#NM_COMMENT
 0x36

561 
	#NM_LIBCOMM
 0x37

562 
	#NM_BREAK
 0x38

563 
	#NM_ARG
 0x39

564 
	#NM_ANALYSE
 0x3A

565 
	#NM_BREAKEXPR
 0x3B

566 
	#NM_BREAKEXPL
 0x3C

567 
	#NM_ASSUME
 0x3D

568 
	#NM_STRUCT
 0x3E

569 
	#NM_CASE
 0x3F

571 
	#NM_INSPECT
 0x40

572 
	#NM_WATCH
 0x41

573 
	#NM_ASM
 0x42

574 
	#NM_FINDASM
 0x43

575 
	#NM_LASTWATCH
 0x48

576 
	#NM_SOURCE
 0x49

577 
	#NM_REFTXT
 0x4A

578 
	#NM_GOTO
 0x4B

579 
	#NM_GOTODUMP
 0x4C

580 
	#NM_TRPAUSE
 0x4D

582 
	#NM_IMCALL
 0xFE

583 

	)

584 
	#NMHISTORY
 0x40

585 

	)

586 
extc
 
cde˛
 
In£π«me
(
ul⁄g
 
addr
,
ty≥
,*
«me
);

587 
extc
 
cde˛
 
Quickö£π«me
(
ul⁄g
 
addr
,
ty≥
,*
«me
);

588 
extc
 
cde˛
 
Mîgequick«mes
();

589 
extc
 
cde˛
 
Disˇrdquick«mes
();

590 
extc
 
cde˛
 
Föd«me
(
ul⁄g
 
addr
,
ty≥
,*
«me
);

591 
extc
 
cde˛
 
Decodíame
(
ul⁄g
 
addr
,
ty≥
,*
«me
);

592 
extc
 
ul⁄g
 
cde˛
 
Föd√xäame
(*
«me
);

593 
extc
 
cde˛
 
Födœbñ
(
ul⁄g
 
addr
,*
«me
);

594 
extc
 
cde˛
 
Dñëíamî™ge
(
ul⁄g
 
addr0
,ul⁄g 
addr1
,
ty≥
);

595 
extc
 
cde˛
 
Födœbñby«me
(*
«me
,
ul⁄g
 *
addr
,

596 
ul⁄g
 
addr0
,ul⁄g 
addr1
);

597 
extc
 
ul⁄g
 
cde˛
 
Födimp‹tby«me
(*
«me
,ul⁄g 
addr0
,ul⁄g 
addr1
);

598 
extc
 
cde˛
 
Dem™gÀ«me
(*
«me
,
ty≥
,*
undec‹©ed
);

599 
extc
 
cde˛
 
Födsymbﬁi˙ame
(
ul⁄g
 
addr
,*
‚ame
);

604 
	#REG_EAX
 0

605 
	#REG_ECX
 1

606 
	#REG_EDX
 2

	)

607 
	#REG_EBX
 3

	)

608 
	#REG_ESP
 4

	)

609 
	#REG_EBP
 5

	)

610 
	#REG_ESI
 6

	)

611 
	#REG_EDI
 7

	)

613 
	#SEG_UNDEF
 -1

	)

614 
	#SEG_ES
 0

615 
	#SEG_CS
 1

616 
	#SEG_SS
 2

	)

617 
	#SEG_DS
 3

	)

618 
	#SEG_FS
 4

	)

619 
	#SEG_GS
 5

	)

622 
	#RS_NONE
 0x0000

623 
	#RS_INT
 0x0010

624 
	#RS_EIP
 0x0020

625 
	#RS_FLG
 0x0030

626 
	#RS_SEG
 0x0040

627 
	#RS_EFL
 0x0050

628 
	#RS_TAG
 0x0060

629 
	#RS_FPU
 0x0070

630 
	#RS_FST
 0x0080

631 
	#RS_FCO
 0x0090

632 
	#RS_FER
 0x00A0

633 
	#RS_FCW
 0x00B0

634 
	#RS_FPR
 0x00C0

635 
	#RS_FEM
 0x00D0

636 
	#RS_MMX
 0x00E0

637 
	#RS_3DN
 0x00F0

638 
	#RS_SSE
 0x0100

639 
	#RS_CSR
 0x0110

640 
	#RS_CSB
 0x0120

641 
	#RS_CPR
 0x0130

642 
	#RS_ERR
 0x0140

643 

	)

644 
	#RS_GROUP
 0x01F0

645 
	#RS_INDEX
 0x000F

646 

	)

647 
	#NREGSTACK
 32

648 
	#MAXCALSIZE
 8

649 

	)

650 
	#INT3
 0xCC

651 
	#NOP
 0x90

652 
	#TRAPFLAG
 0x00000100

653 

	)

654 
	#C_TYPEMASK
 0xF0

655 
	#C_CMD
 0x00

656 
	#C_PSH
 0x10

657 
	#C_POP
 0x20

658 
	#C_MMX
 0x30

659 
	#C_FLT
 0x40

660 
	#C_JMP
 0x50

661 
	#C_JMC
 0x60

662 
	#C_CAL
 0x70

663 
	#C_RET
 0x80

664 
	#C_FLG
 0x90

665 
	#C_RTF
 0xA0

666 
	#C_REP
 0xB0

667 
	#C_PRI
 0xC0

668 
	#C_SSE
 0xD0

669 
	#C_NOW
 0xE0

670 
	#C_BAD
 0xF0

671 
	#C_RARE
 0x08

672 
	#C_SIZEMASK
 0x07

673 
	#C_EXPL
 0x01

674 

	)

675 
	#C_DANGER95
 0x01

676 
	#C_DANGER
 0x03

677 
	#C_DANGERLOCK
 0x07

678 

	)

679 
	#DEC_TYPEMASK
 0x1F

680 
	#DEC_UNKNOWN
 0x00

681 
	#DEC_BYTE
 0x01

682 
	#DEC_WORD
 0x02

683 
	#DEC_NEXTDATA
 0x03

684 
	#DEC_DWORD
 0x04

685 
	#DEC_FLOAT4
 0x05

686 
	#DEC_FWORD
 0x06

687 
	#DEC_FLOAT8
 0x07

688 
	#DEC_QWORD
 0x08

689 
	#DEC_FLOAT10
 0x09

690 
	#DEC_TBYTE
 0x0A

691 
	#DEC_STRING
 0x0B

692 
	#DEC_UNICODE
 0x0C

693 
	#DEC_3DNOW
 0x0D

694 
	#DEC_SSE
 0x0E

695 
	#DEC_TEXT
 0x10

696 
	#DEC_BYTESW
 0x11

697 
	#DEC_NEXTCODE
 0x13

698 
	#DEC_COMMAND
 0x1D

699 
	#DEC_JMPDEST
 0x1E

700 
	#DEC_CALLDEST
 0x1F

701 
	#DEC_PROCMASK
 0x60

702 
	#DEC_PROC
 0x20

703 
	#DEC_PBODY
 0x40

704 
	#DEC_PEND
 0x60

705 
	#DEC_CHECKED
 0x80

706 
	#DEC_SIGNED
 0x100

707 

	)

708 
	#DISASM_SIZE
 0

709 
	#DISASM_DATA
 1

710 
	#DISASM_TRACE
 2

711 
	#DISASM_FILE
 3

712 
	#DISASM_CODE
 4

713 
	#DISASM_ALL
 5

714 
	#DISASM_RTRACE
 6

715 

	)

716 
	#DISASM_MODE
 0x0000000F

717 
	#DISASM_HILITE
 0x000F0000

718 
	#DISASM_HLSHIFT
 16

719 

	)

721 
	#DAW_FARADDR
 0x0001

722 
	#DAW_SEGMENT
 0x0002

723 
	#DAW_PRIV
 0x0004

724 
	#DAW_IO
 0x0008

725 
	#DAW_SHIFT
 0x0010

726 
	#DAW_PREFIX
 0x0020

727 
	#DAW_LOCK
 0x0040

728 
	#DAW_STACK
 0x0080

729 
	#DAW_DANGER95
 0x1000

730 
	#DAW_DANGEROUS
 0x3000

731 

	)

732 
	#RST_INVALID
 0

733 
	#RST_VALUE
 1

734 
	#RST_VFIXUP
 2

735 
	#RST_INDIRECT
 3

736 

	)

737 
	#NREGSTACK
 32

738 

	)

739 
	st_ªg
 {

740 
	mmodifõd
;

741 
	mmodifõdbyu£r
;

742 
	msögÀ°ï
;

743 
ul⁄g
 
	mr
[8];

744 
ul⁄g
 
	mù
;

745 
ul⁄g
 
	mÊags
;

746 
	mt›
;

747 
	mf
[8];

748 
	mèg
[8];

749 
ul⁄g
 
	mf°
;

750 
ul⁄g
 
	mfcw
;

751 
ul⁄g
 
	ms
[6];

752 
ul⁄g
 
	mba£
[6];

753 
ul⁄g
 
	mlimô
[6];

754 
	mbig
[6];

755 
ul⁄g
 
	mdr6
;

756 
ul⁄g
 
	mthªadid
;

757 
ul⁄g
 
	mœ°îr‹
;

758 
	ms£vÆid
;

759 
	ms£modifõd
;

760 
	ms£ªg
[8][16];

761 
ul⁄g
 
	mmxc§
;

762 
	m£À˘ed
;

763 
ul⁄g
 
	mdæö
[4];

764 
ul⁄g
 
	mdr7
;

765 } 
	tt_ªg
;

767 
	st_›î™d
 {

768 
	m›ty≥
;

769 
	m›size
;

770 
	mªgsˇÀ
[8];

771 
	m£g
;

772 
ul⁄g
 
	m›c⁄°
;

773 } 
	tt_›î™d
;

775 
	st_dißsm
 {

776 
ul⁄g
 
	mù
;

777 
	mdump
[
TEXTLEN
];

778 
	mªsu…
[
TEXTLEN
];

779 
	mcommít
[
TEXTLEN
];

780 
	m›öfo
[3][
TEXTLEN
];

781 
	mcmdty≥
;

782 
	mmemty≥
;

783 
	m≈ªfix
;

784 
	mödexed
;

785 
ul⁄g
 
	mjmpc⁄°
;

786 
ul⁄g
 
	mjm±abÀ
;

787 
ul⁄g
 
	madrc⁄°
;

788 
ul⁄g
 
	mimmc⁄°
;

789 
	mzîoc⁄°
;

790 
	mfixupoff£t
;

791 
	mfixupsize
;

792 
ul⁄g
 
	mjm∑ddr
;

793 
	mc⁄dôi⁄
;

794 
	mîr‹
;

795 
	mw¨nögs
;

796 
	m›ty≥
[3];

797 
	m›size
[3];

798 
	m›good
[3];

799 
ul⁄g
 
	m›addr
[3];

800 
ul⁄g
 
	m›d©a
[3];

801 
t_›î™d
 
	m›
[3];

802 
ul⁄g
 
	mªgd©a
[8];

803 
	mªg°©us
[8];

804 
ul⁄g
 
	maddrd©a
;

805 
	maddr°©us
;

806 
ul⁄g
 
	mªg°ack
[
NREGSTACK
];

807 
	mr°°©us
[
NREGSTACK
];

808 
	mƒeg°ack
;

809 
ul⁄g
 
	mª£rved
[29];

810 } 
	tt_dißsm
;

812 
extc
 
ul⁄g
 
cde˛
 
Dißsm
(
uch¨
 *
§c
,ul⁄g 
§csize
,ul⁄g 
§cù
,uch¨ *
§cdec
,

813 
t_dißsm
 *
dißsm
,
dißsmmode
,
ul⁄g
 
thªadid
);

814 
extc
 
ul⁄g
 
cde˛
 
Dißs£mbÀback
(
uch¨
 *
block
,ul⁄g 
ba£
,ul⁄g 
size
,

815 
ul⁄g
 
ù
,
n
,
u£dec
);

816 
extc
 
ul⁄g
 
cde˛
 
Dißs£mbÀf‹w¨d
(
uch¨
 *
block
,ul⁄g 
ba£
,ul⁄g 
size
,

817 
ul⁄g
 
ù
,
n
,
u£dec
);

818 
extc
 
cde˛
 
Issu•icious
(*
cmd
,
ul⁄g
 
size
,ul⁄g 
ù
,

819 
ul⁄g
 
thªadid
,
t_ªg
 *
¥eg
,*
s
);

820 
extc
 
cde˛
 
Isfûlög
(
ul⁄g
 
off£t
,*
d©a
,ul⁄g 
size
,ul⁄g 
Æign
);

825 
extc
 
cde˛
 
As£mbÀ
(*
cmd
,
ul⁄g
 
ù
,
t_asmmodñ
 *
modñ
,
©ãm±
,

826 
c⁄°size
,*
îπext
);

827 
extc
 
cde˛
 
Checkc⁄dôi⁄
(
code
,
ul⁄g
 
Êags
);

832 
	st_ªsu…
 {

833 
	mty≥
;

834 
	mdty≥
;

836 
uch¨
 
	md©a
[10];

837 
ul⁄g
 
	mu
;

838 
	ml
;

839 
	mf
; };

841 
	mvÆue
[
TEXTLEN
];

842 
wch¨_t
 
	mwvÆue
[
TEXTLEN
/2]; };

843 
ul⁄g
 
	mlvaddr
;

844 } 
	tt_ªsu…
;

846 
extc
 
cde˛
 
Ex¥essi⁄
(
t_ªsu…
 *
ªsu…
,*
ex¥essi⁄
,
a
,
b
,

847 
uch¨
 *
d©a
,
ul⁄g
 
d©aba£
,ul⁄g 
d©asize
,ul⁄g 
thªadid
);

852 
	st_thªad
 {

853 
ul⁄g
 
	mthªadid
;

854 
ul⁄g
 
	mdummy
;

855 
ul⁄g
 
	mty≥
;

856 
HANDLE
 
	mthªad
;

857 
ul⁄g
 
	md©ablock
;

858 
ul⁄g
 
	míåy
;

859 
ul⁄g
 
	m°ackt›
;

860 
ul⁄g
 
	m°ackbŸtom
;

861 
CONTEXT
 
	mc⁄ãxt
;

862 
t_ªg
 
	mªg
;

863 
	mªgvÆid
;

864 
t_ªg
 
	mﬁdªg
;

865 
	mﬁdªgvÆid
;

866 
	msu•ídcou¡
;

867 
	mu£πime
;

868 
	msy°ime
;

869 
ul⁄g
 
	mª£rved
[16];

870 } 
	tt_thªad
;

872 
extc
 
HWND
 
cde˛
 
Cª©ëhªadwödow
();

873 
extc
 
t_thªad
* 
cde˛
 
Födthªad
(
ul⁄g
 
thªadid
);

874 
extc
 
cde˛
 
Decodëhªad«me
(*
s
,
ul⁄g
 
thªadid
,
mode
);

875 
extc
 
ul⁄g
 
cde˛
 
Gë˝uthªadid
();

876 
extc
 
ul⁄g
 
cde˛
 
RunsögÀthªad
(ul⁄g 
thªadid
);

877 
extc
 
cde˛
 
Re°‹óŒthªads
();

884 
	#MM_RESTORE
 0x01

885 
	#MM_SILENT
 0x02

886 
	#MM_DELANAL
 0x04

887 

	)

888 
	#MM_RESILENT
 (
MM_RESTORE
|
MM_SILENT
)

	)

890 
	st_mem‹y
 {

891 
ul⁄g
 
	mba£
;

892 
ul⁄g
 
	msize
;

893 
ul⁄g
 
	mty≥
;

894 
ul⁄g
 
	mow√r
;

895 
ul⁄g
 
	möôac˚ss
;

896 
ul⁄g
 
	mac˚ss
;

897 
ul⁄g
 
	mthªadid
;

898 
	m£˘
[
SHORTLEN
];

899 
uch¨
 *
	mc›y
;

900 
ul⁄g
 
	mª£rved
[8];

901 } 
	tt_mem‹y
;

903 
	st_hóp
 {

904 
ul⁄g
 
	mba£
;

905 
ul⁄g
 
	msize
;

906 
ul⁄g
 
	mty≥
;

907 
ul⁄g
 
	m∑ª¡
;

908 } 
	tt_hóp
;

910 
extc
 
cde˛
 
Li°mem‹y
();

911 
extc
 
t_mem‹y
* 
cde˛
 
Födmem‹y
(
ul⁄g
 
addr
);

912 
extc
 
cde˛
 
Gu¨dmem‹y
(
ul⁄g
 
ba£
,ul⁄g 
size
,
gu¨d
);

913 
extc
 
cde˛
 
Havec›yofmem‹y
(
uch¨
 *
c›y
,
ul⁄g
 
ba£
,ul⁄g 
size
);

914 
extc
 
ul⁄g
 
cde˛
 
Ródmem‹y
(*
buf
,ul⁄g 
addr
,ul⁄g 
size
,
mode
);

915 
extc
 
ul⁄g
 
cde˛
 
Wrôemem‹y
(*
buf
,ul⁄g 
addr
,ul⁄g 
size
,
mode
);

916 
extc
 
ul⁄g
 
cde˛
 
Ródcomm™d
(ul⁄g 
ù
,*
cmd
);

921 
	#NVERS
 32

922 

	)

924 
	#JT_JUMP
 0

925 
	#JT_COND
 1

926 
	#JT_SWITCH
 2

927 

	)

928 
	st_ahöt
 {

929 
ul⁄g
 
	maddr
;

930 
ul⁄g
 
	msize
;

931 
ul⁄g
 
	mty≥
;

932 } 
	tt_ahöt
;

934 
	st_°rögèbÀ
 {

935 
ul⁄g
 
	m«me
;

936 
ul⁄g
 
	mœnguage
;

937 
ul⁄g
 
	maddr
;

938 
ul⁄g
 
	msize
;

939 } 
	tt_°rögèbÀ
;

941 
	st_fixup
 {

942 
ul⁄g
 
	mba£
;

943 
ul⁄g
 
	msize
;

944 } 
	tt_fixup
;

946 
	st_symv¨
 {

947 
	m√xt
;

948 
ush‹t
 
	mköd
;

950 
ul⁄g
 
	mty≥
;

951 
ul⁄g
 
	mªgs
; };

953 
ul⁄g
 
	maddr
;

954 
	moff£t
; };

955 
ul⁄g
 
	msize
;

956 
	m›tv¨
;

957 
ul⁄g
 
	m«móddr
;

958 } 
	tt_symv¨
;

960 
	st_jde°
 {

961 
	mty≥
;

962 
ul⁄g
 
	m‰om
;

963 
ul⁄g
 
	mto
;

964 } 
	tt_jde°
;

966 
	st_moduÀ
 {

967 
ul⁄g
 
	mba£
;

968 
ul⁄g
 
	msize
;

969 
ul⁄g
 
	mty≥
;

970 
ul⁄g
 
	mcodeba£
;

971 
ul⁄g
 
	mcodesize
;

972 
ul⁄g
 
	mªsba£
;

973 
ul⁄g
 
	mªssize
;

974 
t_°rögèbÀ
 *
	m°rögèbÀ
;

975 
	mn°rögèbÀ
;

976 
	mmax°rögèbÀ
;

977 
ul⁄g
 
	míåy
;

978 
ul⁄g
 
	md©aba£
;

979 
ul⁄g
 
	mid©©abÀ
;

980 
ul⁄g
 
	mid©aba£
;

981 
ul⁄g
 
	med©©abÀ
;

982 
ul⁄g
 
	med©asize
;

983 
ul⁄g
 
	mªlo˘abÀ
;

984 
ul⁄g
 
	mªlocsize
;

985 
	m«me
[
SHORTLEN
];

986 
	m∑th
[
MAX_PATH
];

987 
	mn£˘
;

988 
IMAGE_SECTION_HEADER
 *
	m£˘
;

989 
ul⁄g
 
	mhódîsize
;

990 
ul⁄g
 
	mfixupba£
;

991 
	mnfixup
;

992 
t_fixup
 *
	mfixup
;

993 *
	mcodedec
;

994 
ul⁄g
 
	mcode¸c
;

995 *
	mhôåa˚
;

996 *
	mhôåa˚c›y
;

997 *
	md©adec
;

998 
t_èbÀ
 
	m«mñi°
;

999 
t_symv¨
 *
	msymv¨
;

1000 
	mnsymv¨
;

1001 
	mmaxsymv¨
;

1002 *
	mglobÆty≥s
;

1003 
ul⁄g
 
	mmaöíåy
;

1004 
ul⁄g
 
	mªÆsfxíåy
;

1005 
	mupd©íamñi°
;

1006 
ul⁄g
 
	m‹igcodesize
;

1007 
ul⁄g
 
	msfxba£
;

1008 
ul⁄g
 
	msfxsize
;

1009 
	missy°emdŒ
;

1010 
	m¥o˚s£d
;

1011 
	mdbghñpsym
;

1012 
	mvîsi⁄
[
NVERS
];

1013 
t_jde°
 *
	mjdd©a
;

1014 
	mnjdd©a
;

1015 
ul⁄g
 
	mª£rved
[15];

1016 } 
	tt_moduÀ
;

1018 
extc
 
t_moduÀ
* 
cde˛
 
FödmoduÀ
(
ul⁄g
 
addr
);

1019 
extc
 
t_fixup
* 
cde˛
 
Födfixup
(
t_moduÀ
 *
pmod
,
ul⁄g
 
addr
);

1020 
extc
 
uch¨
* 
cde˛
 
Föddecode
(
ul⁄g
 
addr
,ul⁄g *
psize
);

1021 
extc
 
ul⁄g
 
cde˛
 
Födfûeoff£t
(
t_moduÀ
 *
pmod
,ul⁄g 
addr
);

1022 
extc
 
cde˛
 
Decodî™ge
(
ul⁄g
 
addr
,ul⁄g 
size
,*
s
);

1023 
extc
 
cde˛
 
A«ly£code
(
t_moduÀ
 *
pm
);

1029 
	#DU_ESCAPABLE
 0x20000L

1030 
	#DU_BACKUP
 0x10000L

1031 
	#DU_TYPE
 0x0F000L

1032 
	#DU_COUNT
 0x00FF0L

1033 
	#DU_SIZE
 0x0000FL

1034 

	)

1035 
	#DU_UNDEF
 0x00000L

1036 
	#DU_HEXTEXT
 0x01000L

1037 
	#DU_TEXT
 0x02000L

1038 
	#DU_UNICODE
 0x03000L

1039 
	#DU_INT
 0x04000L

1040 
	#DU_UINT
 0x05000L

1041 
	#DU_IHEX
 0x06000L

1042 
	#DU_FLOAT
 0x07000L

1043 
	#DU_ADDR
 0x08000L

1044 
	#DU_DISASM
 0x09000L

1045 
	#DU_HEXUNI
 0x0A000L

1046 
	#DU_ADRASC
 0x0B000L

1047 
	#DU_ADRUNI
 0x0C000L

1048 
	#DU_SPEC
 0x0D000L

1049 

	)

1051 
	#MT_BACKUP
 0x0001

1052 
	#MT_COPY
 0x0002

1053 
	#MT_EDIT
 0x0004

1054 
	#MT_SEARCH
 0x0008

1055 
	#MT_DHISTORY
 0x0010

1056 

	)

1057 
ul⁄g
 
	tSPECFUNC
(*,
	tul⁄g
,ul⁄g,ul⁄g,
	tt_dißsm
 *,);

1059 
	st_dump
 {

1060 
t_èbÀ
 
	mèbÀ
;

1061 
	mdimmed
;

1062 
ul⁄g
 
	mthªadid
;

1063 
	mdum±y≥
;

1064 
SPECFUNC
 *
	m•ecdump
;

1065 
	mmíuty≥
;

1066 
	môemwidth
;

1067 
	mshow°ack‰ames
;

1068 
	mshow°ackloˇls
;

1069 
	mcommítmode
;

1070 
	mfûíame
[
MAX_PATH
];

1071 
ul⁄g
 
	mba£
;

1072 
ul⁄g
 
	msize
;

1073 
ul⁄g
 
	maddr
;

1074 
ul⁄g
 
	mœ°addr
;

1075 
ul⁄g
 
	m£l0
;

1076 
ul⁄g
 
	m£l1
;

1077 
ul⁄g
 
	m°¨t£l
;

1078 
	mˇ±uªd
;

1079 
ul⁄g
 
	mªœddr
;

1080 
	mª ame
[
SHORTLEN
];

1081 
uch¨
 *
	mfûec›y
;

1082 
uch¨
 *
	mbackup
;

1083 
	mru¡ø˚off£t
;

1084 
ul⁄g
 
	mª£rved
[8];

1085 } 
	tt_dump
;

1090 
	#WM_USER_MENU
 (
WM_USER
+101)

1091 
	#WM_USER_SCR
 (
WM_USER
+102)

1092 
	#WM_USER_SAVE
 (
WM_USER
+103)

1093 
	#WM_USER_VABS
 (
WM_USER
+104)

1094 
	#WM_USER_VREL
 (
WM_USER
+105)

1095 
	#WM_USER_VBYTE
 (
WM_USER
+106)

1096 
	#WM_USER_STS
 (
WM_USER
+107)

1097 
	#WM_USER_CNTS
 (
WM_USER
+108)

1098 
	#WM_USER_CHGS
 (
WM_USER
+109)

1099 
	#WM_USER_BAR
 (
WM_USER
+110)

1100 
	#WM_USER_DBLCLK
 (
WM_USER
+111)

1101 
	#WM_USER_SIZE
 (
WM_USER
+112)

1102 
	#WM_USER_FOCUS
 (
WM_USER
+113)

1103 
	#WM_USER_FILE
 (
WM_USER
+114)

1104 
	#WM_USER_HERE
 (
WM_USER
+115)

1105 
	#WM_USER_CHALL
 (
WM_USER
+116)

1106 
	#WM_USER_CHMEM
 (
WM_USER
+117)

1107 
	#WM_USER_CHREG
 (
WM_USER
+118)

1108 
	#WM_USER_CHNAM
 (
WM_USER
+119)

1109 
	#WM_USER_MOUSE
 (
WM_USER
+120)

1110 
	#WM_USER_KEY
 (
WM_USER
+121)

1111 
	#WM_USER_SYSKEY
 (
WM_USER
+122)

1112 

	)

1114 
	#MAXTRACK
 16384

1115 
	#MOVETOP
 0x7FFFFFFFL

1116 
	#MOVEBOTTOM
 0x7FFFFFFEL

1117 

	)

1118 
	#CONT_BROADCAST
 0x0000

1119 
	#STOP_BROADCAST
 0x1234

1120 

	)

1122 
	#BKUP_CREATE
 1

1123 
	#BKUP_VIEWDATA
 2

1124 
	#BKUP_VIEWCOPY
 3

1125 
	#BKUP_LOADCOPY
 4

1126 
	#BKUP_SAVEDATA
 5

1127 
	#BKUP_SAVECOPY
 6

1128 
	#BKUP_DELETE
 7

1129 

	)

1130 
extc
 
cde˛
 
Regi°îŸ˛ass
(*
˛as¢ame
,

1131 *
ic⁄«me
,
WNDPROC
 
˛as•roc
);

1132 
extc
 
HWND
 
cde˛
 
NewèbÀwödow
(
t_èbÀ
 *
±
,
∆öes
,
maxcﬁumns
,

1133 *
wö˛ass
,*
wötôÀ
);

1134 
extc
 
HWND
 
cde˛
 
QuickèbÀwödow
(
t_èbÀ
 *
±
,
∆öes
,
maxcﬁumns
,

1135 *
wö˛ass
,*
wötôÀ
);

1136 
extc
 
HWND
 
cde˛
 
Cª©edumpwödow
(*
«me
,
ul⁄g
 
ba£
,ul⁄g 
size
,

1137 
ul⁄g
 
addr
,
ty≥
,
SPECFUNC
 *
•ecdump
);

1138 
extc
 
cde˛
 
Sëdum±y≥
(
t_dump
 *
pd
,
dum±y≥
);

1139 
extc
 
cde˛
 
Dumpbackup
(
t_dump
 *
pd
,
a˘i⁄
);

1140 
extc
 
cde˛
 
Brﬂdˇ°
(
UINT
 
msg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

1145 
extc
 
ul⁄g
 
cde˛
 
Com¥ess
(
uch¨
 *
bufö
,ul⁄g 
nbufö
,

1146 
uch¨
 *
bufout
,
ul⁄g
 
nbufout
);

1147 
extc
 
ul⁄g
 
cde˛
 
Gë‹igöÆd©asize
(*
bufö
,ul⁄g 
nbufö
);

1148 
extc
 
ul⁄g
 
cde˛
 
Decom¥ess
(
uch¨
 *
bufö
,ul⁄g 
nbufö
,

1149 
uch¨
 *
bufout
,
ul⁄g
 
nbufout
);

1150 
extc
 
ul⁄g
 
cde˛
 
CÆcuœã¸c
(
uch¨
 *
c›y
,ul⁄g 
ba£
,ul⁄g 
size
,

1151 
t_moduÀ
 *
pmod
,
ul⁄g
 
fixupoff£t
);

1156 
	st_ªf
 {

1157 
ul⁄g
 
	maddr
;

1158 
ul⁄g
 
	msize
;

1159 
ul⁄g
 
	mty≥
;

1160 
ul⁄g
 
	mde°
;

1161 } 
	tt_ªf
;

1163 
extc
 
cde˛
 
Födª„ªn˚s
(
ul⁄g
 
ba£
,ul⁄g 
size
,ul⁄g 
addr0
,ul⁄g 
addr1
,

1164 
ul⁄g
 
‹igö
,
ªcur£⁄jump
,*
tôÀ
);

1165 
extc
 
cde˛
 
Föd°rögs
(
ul⁄g
 
ba£
,ul⁄g 
size
,ul⁄g 
‹igö
,*
tôÀ
);

1166 
extc
 
cde˛
 
FödÆldŒˇŒs
(
t_dump
 *
pd
,
ul⁄g
 
‹igö
,*
tôÀ
);

1167 
extc
 
cde˛
 
FödÆlcomm™ds
(
t_dump
 *
pd
,
t_asmmodñ
 *
modñ
,

1168 
ul⁄g
 
‹igö
,*
tôÀ
);

1169 
extc
 
cde˛
 
FödÆl£quí˚s
(
t_dump
 *
pd
,
t_extmodñ
 
modñ
[
NSEQ
][
NMODELS
],

1170 
ul⁄g
 
‹igö
,*
tôÀ
);

1171 
extc
 
ul⁄g
 
cde˛
 
WÆkª„ªn˚
(
dú
);

1172 
extc
 
ul⁄g
 
cde˛
 
WÆkª„ªn˚ex
(
dú
,ul⁄g *
size
);

1177 
	#MEMBP_READ
 0x0001

1178 
	#MEMBP_WRITE
 0x0002

1179 
	#MEMBP_SFX
 0x1000

1180 

	)

1182 
	#TR_HIT
 0x01

1183 
	#TR_SET
 0x02

1184 
	#TR_RTSKIP
 0x20

1185 
	#TR_RTRACE
 0x40

1186 
	#TR_TRACE
 0x80

1187 

	)

1188 
	#HB_FREE
 0

1189 
	#HB_CODE
 1

1190 
	#HB_ACCESS
 2

1191 
	#HB_WRITE
 3

1192 
	#HB_IO
 4

1193 
	#HB_ONESHOT
 5

1194 
	#HB_STOPAN
 6

1195 
	#HB_TEMP
 7

1196 

	)

1198 
	#ATR_ADD
 1

1199 
	#ATR_ADDPROC
 2

1200 
	#ATR_RESET
 3

1201 
	#ATR_REMOVE
 4

1202 
	#ATR_REMOVEALL
 5

1203 
	#ATR_RESTORE
 6

1204 
	#ATR_RTRADD
 7

1205 
	#ATR_RTRJUMPS
 8

1206 
	#ATR_RTRENTRY
 9

1207 
	#ATR_RTREMOVE
 10

1208 
	#ATR_RTSKIP
 11

1209 

	)

1215 
	#COND_NOBREAK
 0x01

1216 
	#COND_LOGTRUE
 0x02

1217 
	#COND_LOGALWAYS
 0x04

1218 
	#COND_ARGTRUE
 0x08

1219 
	#COND_ARGALWAYS
 0x10

1220 
	#COND_BRKALWAYS
 0x20

1221 
	#COND_MASK
 0x3F

1222 
	#COND_FILLING
 0x40

1223 

	)

1224 
	st_bpoöt
 {

1225 
ul⁄g
 
	maddr
;

1226 
ul⁄g
 
	mdummy
;

1227 
ul⁄g
 
	mty≥
;

1228 
	mcmd
;

1229 
ul⁄g
 
	m∑sscou¡
;

1230 } 
	tt_bpoöt
;

1232 
	st_h¨dbpoöt
 {

1233 
ul⁄g
 
	maddr
;

1234 
	msize
;

1235 
	mty≥
;

1236 
ul⁄g
 
	mª£rved
[4];

1237 } 
	tt_h¨dbpoöt
;

1239 
extc
 
cde˛
 
Sëbªakpoöt
(
ul⁄g
 
addr
,ul⁄g 
ty≥
,
uch¨
 
cmd
);

1240 
extc
 
cde˛
 
Sëbªakpoöãxt
(
ul⁄g
 
addr
,ul⁄g 
ty≥
,
cmd
,

1241 
ul⁄g
 
∑sscou¡
);

1242 
extc
 
cde˛
 
M™uÆbªakpoöt
(
ul⁄g
 
addr
,

1243 
key
,
shi·key
,
ul⁄g
 
«mëy≥
,
f⁄t
);

1244 
extc
 
cde˛
 
Dñëebªakpoöts
(
ul⁄g
 
addr0
,ul⁄g 
addr1
,
sûít
);

1245 
extc
 
ul⁄g
 
cde˛
 
Gëbªakpoöây≥
(ul⁄g 
addr
);

1246 
extc
 
ul⁄g
 
cde˛
 
Gëbªakpoöây≥cou¡
(ul⁄g 
addr
,ul⁄g *
∑sscou¡
);

1247 
extc
 
ul⁄g
 
cde˛
 
Gë√xtbªakpoöt
(ul⁄g 
addr
,ul⁄g *
ty≥
,*
cmd
);

1248 
extc
 
cde˛
 
Tempbªakpoöt
(
ul⁄g
 
addr
,
mode
);

1249 
extc
 
cde˛
 
H¨dbªakpoöts
(
˛o£⁄dñëe
);

1250 
extc
 
cde˛
 
Sëh¨dw¨ebªakpoöt
(
ul⁄g
 
addr
,
size
,
ty≥
);

1251 
extc
 
cde˛
 
Dñëeh¨dw¨ebªakpoöt
(
ödex
);

1252 
extc
 
cde˛
 
Dñëeh¨dw¨ebªakbyaddr
(
ul⁄g
 
addr
);

1253 
extc
 
cde˛
 
Sëmembªakpoöt
(
ty≥
,
ul⁄g
 
addr
,ul⁄g 
size
);

1254 
extc
 
uch¨
* 
cde˛
 
Födhôåa˚
(
ul⁄g
 
addr
,uch¨ **
±ø˚c›y
,ul⁄g *
psize
);

1255 
extc
 
cde˛
 
Modifyhôåa˚
(
ul⁄g
 
addr0
,ul⁄g 
addr1
,
mode
);

1256 
extc
 
ul⁄g
 
cde˛
 
I§ëaddr
(ul⁄g 
ªèddr
,ul⁄g *
¥oˇddr
);

1257 
extc
 
HWND
 
cde˛
 
Cª©îåa˚wödow
();

1258 
extc
 
cde˛
 
Sëåa˚c⁄dôi⁄
(*
c⁄d
,
⁄su•icious
,

1259 
ul⁄g
 
ö0
,ul⁄g 
ö1
,ul⁄g 
out0
,ul⁄g 
out1
);

1260 
extc
 
cde˛
 
Sëåa˚cou¡
(
ul⁄g
 
cou¡
);

1261 
extc
 
cde˛
 
Sëåa˚∑u£⁄comm™ds
(*
cmd£t
);

1262 
extc
 
cde˛
 
Sèπru¡ø˚
(
t_ªg
 *
¥eg
);

1263 
extc
 
cde˛
 
Dñëîu¡ø˚
();

1264 
extc
 
cde˛
 
Ru¡ø˚size
();

1265 
extc
 
cde˛
 
Föd¥evru¡ø˚ù
(
ul⁄g
 
ù
,
°¨tback
);

1266 
extc
 
cde˛
 
Föd√xåu¡ø˚ù
(
ul⁄g
 
ù
,
°¨tback
);

1267 
extc
 
cde˛
 
Gëru¡ø˚ªgi°îs
(
nback
,
t_ªg
 *
¥eg
,

1268 
t_ªg
 *
pﬁd
,*
cmd
,*
commít
);

1269 
extc
 
cde˛
 
Gëru¡ø˚¥ofûe
(
ul⁄g
 
addr
,ul⁄g 
size
,ul⁄g *
¥ofûe
);

1270 
extc
 
cde˛
 
S¸ﬁÃu¡ø˚wödow
(
back
);

1271 
extc
 
HWND
 
cde˛
 
Cª©ïrofûewödow
(
ul⁄g
 
ba£
,ul⁄g 
size
);

1277 
	tINJECTANSWER
(*
	td©a
,
	tul⁄g
 
	td©asize
,ul⁄g 
	t∑rm2
);

1279 
	st_öje˘
 {

1280 
ul⁄g
 
	mcodesize
;

1281 *
	mcode
;

1282 
	m°acksize
;

1283 
	md©©y≥
;

1284 } 
	tt_öje˘
;

1286 
extc
 
cde˛
 
Inje˘code
(
ul⁄g
 
thªadid
,
t_öje˘
 *
öje˘
,*
d©a
,

1287 
ul⁄g
 
d©asize
,ul⁄g 
∑rm1
,ul⁄g 
∑rm2
,

1288 
INJECTANSWER
 *
™swîfunc
);

1295 
	#CPU_ASMHIST
 0x00001

1296 
	#CPU_ASMCENTER
 0x00004

1297 
	#CPU_ASMFOCUS
 0x00008

1298 
	#CPU_DUMPHIST
 0x00010

1299 
	#CPU_DUMPFIRST
 0x00020

1300 
	#CPU_DUMPFOCUS
 0x00080

1301 
	#CPU_REGAUTO
 0x00100

1302 
	#CPU_RUNTRACE
 0x00200

1303 
	#CPU_STACKFOCUS
 0x00800

1304 
	#CPU_NOCREATE
 0x04000

1305 
	#CPU_REDRAW
 0x08000

1306 
	#CPU_NOFOCUS
 0x10000

1307 

	)

1308 
extc
 
cde˛
 
Së˝u
(
ul⁄g
 
thªadid
,ul⁄g 
asmaddr
,

1309 
ul⁄g
 
dum∑ddr
,ul⁄g 
°ackaddr
,
mode
);

1310 
extc
 
cde˛
 
Sëdißsm
(
ul⁄g
 
asmaddr
,ul⁄g 
£lsize
,
mode
);

1311 
extc
 
cde˛
 
Redøwdißs£mbÀr
();

1312 
extc
 
cde˛
 
Gëdißs£mbÀº™ge
(
ul⁄g
 *
pba£
,ul⁄g *
psize
);

1313 
extc
 
ul⁄g
 
cde˛
 
Föd¥ocbegö
(ul⁄g 
addr
);

1314 
extc
 
ul⁄g
 
cde˛
 
Föd¥o˚nd
(ul⁄g 
addr
);

1315 
extc
 
ul⁄g
 
cde˛
 
Föd¥ev¥oc
(ul⁄g 
addr
);

1316 
extc
 
ul⁄g
 
cde˛
 
Föd√xçroc
(ul⁄g 
addr
);

1317 
extc
 
cde˛
 
Gë¥o˛imôs
(
ul⁄g
 
addr
,ul⁄g *
°¨t
,ul⁄g *
íd
);

1318 
extc
 
cde˛
 
Sídsh‹tcut
(
whîe
,
ul⁄g
 
addr
,

1319 
msg
,
˘æ
,
shi·
,
vkcode
);

1325 
	#STEP_SAME
 0

1326 
	#STEP_RUN
 1

1327 
	#STEP_OVER
 2

1328 
	#STEP_IN
 3

1329 
	#STEP_SKIP
 4

1330 

	)

1331 
	et_°©us
 {

1332 
	mSTAT_NONE
=0,

1333 
	mSTAT_STOPPED
,

1334 
	mSTAT_EVENT
,

1335 
	mSTAT_RUNNING
,

1336 
	mSTAT_FINISHED
,

1337 
	mSTAT_CLOSING


1338 } 
	tt_°©us
;

1340 
extc
 
t_°©us
 
cde˛
 
Gë°©us
();

1341 
extc
 
cde˛
 
Go
(
ul⁄g
 
thªadid
,ul⁄g 
tûœddr
,
°ïmode
,

1342 
givech™˚
,
backu¥egs
);

1343 
extc
 
cde˛
 
Su•íd¥o˚ss
(
¥o˚s£víts
);

1348 
	#DASC_TEST
 0

1349 
	#DASC_NOHEX
 1

1350 
	#DASC_ASCII
 2

1351 
	#DASC_PASCAL
 3

1352 

	)

1353 
extc
 
uch¨
* 
cde˛
 
Födknownfun˘i⁄
(
ul⁄g
 
addr
,
dúe˘
,

1354 
Àvñ
,*
‚ame
);

1355 
extc
 
cde˛
 
Decodeknow«rgumít
(
ul⁄g
 
addr
,
uch¨
 *
¨g
,ul⁄g 
vÆue
,

1356 
vÆid
,*
s
,*
mask
,
uch¨
 *
p£t
[]);

1357 
extc
 
cde˛
 *
Födunknownfun˘i⁄
(
ul⁄g
 
ù
,*
code
,*
dec
,

1358 
ul⁄g
 
size
,*
‚ame
);

1359 
extc
 
cde˛
 
Decodóscii
(
ul⁄g
 
vÆue
,*
s
,
Àn
,
mode
);

1360 
extc
 
cde˛
 
Decodeunicode
(
ul⁄g
 
vÆue
,*
s
,
Àn
);

1365 
	#FIRST_CODE_LINE
 0xFFFFFFFF

1366 

	)

1367 
	st_sour˚löe
 {

1368 
ul⁄g
 
	maddr
;

1369 
ul⁄g
 
	msize
;

1370 
ul⁄g
 
	m§˙ame
;

1371 
ul⁄g
 
	mlöe
;

1372 } 
	tt_sour˚löe
;

1374 
extc
 
HWND
 
cde˛
 
Showsour˚‰omaddªss
(
ul⁄g
 
addr
,
show
);

1375 
extc
 
cde˛
 
Gëªsour˚°rög
(
t_moduÀ
 *
pm
,
ul⁄g
 
id
,*
s
);

1376 
extc
 
t_sour˚löe
* 
cde˛
 
Gëlöe‰omaddªss
(
ul⁄g
 
addr
);

1377 
extc
 
ul⁄g
 
cde˛
 
Gëaddªss‰omlöe
(ul⁄g 
addr0
,ul⁄g 
addr1
,

1378 *
∑th
,
ul⁄g
 
löe
);

1379 
extc
 
cde˛
 
Gësour˚fûñimôs
(
ul⁄g
 
«móddr
,

1380 
ul⁄g
 *
addr0
,ul⁄g *
addr1
);

1381 
extc
 
cde˛
 
DecodefuŒv¨«me
(
t_moduÀ
 *
pmod
,
t_symv¨
 *
psym
,

1382 
off£t
,*
«me
);

1383 
extc
 
cde˛
 
Gëb¥ñ«me
(
t_moduÀ
 *
pmod
,
ul⁄g
 
addr
,
off£t
,

1384 *
s
,
nsymb
);

1389 
extc
 
HWND
 
cde˛
 
Cª©ew©chwödow
();

1390 
extc
 
cde˛
 
Dñëew©ch
(
ödex⁄e
);

1391 
extc
 
cde˛
 
In£πw©ch
(
ödex⁄e
,*
ãxt
);

1392 
extc
 
cde˛
 
Gëw©ch
(
ödex⁄e
,*
ãxt
);

1397 
	#MAXNEST
 32

1398 

	)

1399 
	st_wödow
 {

1400 
ul⁄g
 
	mhwnd
;

1401 
ul⁄g
 
	mdummy
;

1402 
ul⁄g
 
	mty≥
;

1403 
ul⁄g
 
	m∑ª¡hw
;

1404 
ul⁄g
 
	mwö¥oc
;

1405 
ul⁄g
 
	mthªadid
;

1406 
ul⁄g
 
	mex°yÀ
;

1407 
ul⁄g
 
	m°yÀ
;

1408 
ul⁄g
 
	mid
;

1409 
ul⁄g
 
	m˛as•roc
;

1410 
	mchûd
;

1411 
	mÀvñ
;

1412 
	msiblög
;

1413 
	mby∑ª¡
;

1414 
	mtôÀ
[
TEXTLEN
];

1415 
	m˛as¢ame
[
TEXTLEN
];

1416 
	måì
[
MAXNEST
];

1417 } 
	tt_wödow
;

1419 
extc
 
HWND
 
cde˛
 
Cª©ewöwödow
();

1425 
	st_∑tch
 {

1426 
ul⁄g
 
	maddr
;

1427 
ul⁄g
 
	msize
;

1428 
ul⁄g
 
	mty≥
;

1429 
	m‹ig
[
TEXTLEN
];

1430 
	mmod
[
TEXTLEN
];

1431 } 
	tt_∑tch
;

1433 
extc
 
HWND
 
cde˛
 
Cª©ï©chwödow
();

1440 
	#VAL_HINST
 1

1441 
	#VAL_HWMAIN
 2

1442 
	#VAL_HWCLIENT
 3

1443 
	#VAL_NCOLORS
 4

1444 
	#VAL_COLORS
 5

1445 
	#VAL_BRUSHES
 6

1446 
	#VAL_PENS
 7

1447 
	#VAL_NFONTS
 8

1448 
	#VAL_FONTS
 9

1449 
	#VAL_FONTNAMES
 10

1450 
	#VAL_FONTWIDTHS
 11

1451 
	#VAL_FONTHEIGHTS
 12

1452 
	#VAL_NFIXFONTS
 13

1453 
	#VAL_DEFFONT
 14

1454 
	#VAL_NSCHEMES
 15

1455 
	#VAL_SCHEMES
 16

1456 
	#VAL_DEFSCHEME
 17

1457 
	#VAL_DEFHSCROLL
 18

1458 
	#VAL_RESTOREWINDOWPOS
 19

1459 
	#VAL_HPROCESS
 20

1460 
	#VAL_PROCESSID
 21

1461 
	#VAL_HMAINTHREAD
 22

1462 
	#VAL_MAINTHREADID
 23

1463 
	#VAL_MAINBASE
 24

1464 
	#VAL_PROCESSNAME
 25

1465 
	#VAL_EXEFILENAME
 26

1466 
	#VAL_CURRENTDIR
 27

1467 
	#VAL_SYSTEMDIR
 28

1468 
	#VAL_DECODEANYIP
 29

1469 
	#VAL_PASCALSTRINGS
 30

1470 
	#VAL_ONLYASCII
 31

1471 
	#VAL_DIACRITICALS
 32

1472 
	#VAL_GLOBALSEARCH
 33

1473 
	#VAL_ALIGNEDSEARCH
 34

1474 
	#VAL_IGNORECASE
 35

1475 
	#VAL_SEARCHMARGIN
 36

1476 
	#VAL_KEEPSELSIZE
 37

1477 
	#VAL_MMXDISPLAY
 38

1478 
	#VAL_WINDOWFONT
 39

1479 
	#VAL_TABSTOPS
 40

1480 
	#VAL_MODULES
 41

1481 
	#VAL_MEMORY
 42

1482 
	#VAL_THREADS
 43

1483 
	#VAL_BREAKPOINTS
 44

1484 
	#VAL_REFERENCES
 45

1485 
	#VAL_SOURCELIST
 46

1486 
	#VAL_WATCHES
 47

1487 
	#VAL_CPUFEATURES
 50

1488 
	#VAL_TRACEFILE
 51

1489 
	#VAL_ALIGNDIALOGS
 52

1490 
	#VAL_CPUDASM
 53

1491 
	#VAL_CPUDDUMP
 54

1492 
	#VAL_CPUDSTACK
 55

1493 
	#VAL_APIHELP
 56

1494 
	#VAL_HARDBP
 57

1495 
	#VAL_PATCHES
 58

1496 
	#VAL_HINTS
 59

1497 

	)

1498 
extc
 
cde˛
 
Regi°î∂ugö˛ass
(*
˛as¢ame
,*
ic⁄«me
,

1499 
HINSTANCE
 
dŒö°
,
WNDPROC
 
˛as•roc
);

1500 
extc
 
cde˛
 
Uƒegi°î∂ugö˛ass
(*
˛as¢ame
);

1501 
extc
 
cde˛
 
Plugöwrôeöâoöi
(
HINSTANCE
 
dŒö°
,*
key
,
vÆue
);

1502 
extc
 
cde˛
 
Plugöwrôe°rögtoöi
(
HINSTANCE
 
dŒö°
,*
key
,*
s
);

1503 
extc
 
cde˛
 
Plugöªadöt‰omöi
(
HINSTANCE
 
dŒö°
,*
key
,
def
);

1504 
extc
 
cde˛
 
Plugöªad°rög‰omöi
(
HINSTANCE
 
dŒö°
,*
key
,

1505 *
s
,*
def
);

1506 
extc
 
cde˛
 
Plugößvîec‹d
(
ul⁄g
 
èg
,ul⁄g 
size
,*
d©a
);

1507 
extc
 
cde˛
 
PlugögëvÆue
(
ty≥
);

1515 
	#PM_MAIN
 0

1516 
	#PM_DUMP
 10

1517 
	#PM_MODULES
 11

1518 
	#PM_MEMORY
 12

1519 
	#PM_THREADS
 13

1520 
	#PM_BREAKPOINTS
 14

1521 
	#PM_REFERENCES
 15

1522 
	#PM_RTRACE
 16

1523 
	#PM_WATCHES
 17

1524 
	#PM_WINDOWS
 18

1525 
	#PM_DISASM
 31

1526 
	#PM_CPUDUMP
 32

1527 
	#PM_CPUSTACK
 33

1528 
	#PM_CPUREGS
 34

1529 

	)

1532 
	#PP_MAIN
 0x0003

1533 
	#PP_EVENT
 0x0000

1534 
	#PP_PAUSE
 0x0001

1535 
	#PP_TERMINATED
 0x0002

1537 
	#PP_BYPROGRAM
 0x0004

1538 
	#PP_INT3BREAK
 0x0010

1539 
	#PP_MEMBREAK
 0x0020

1540 
	#PP_HWBREAK
 0x0040

1541 
	#PP_SINGLESTEP
 0x0080

1542 
	#PP_EXCEPTION
 0x0100

1543 
	#PP_ACCESS
 0x0200

1544 
	#PP_GUARDED
 0x0400

1545 

	)

1547 
	#MI_SIGNATURE
 0x00646F4DL

1548 
	#MI_VERSION
 0x7265560AL

1549 
	#MI_FILENAME
 0x6C69460AL

1550 
	#MI_FILESIZE
 0x7A69530AL

1551 
	#MI_TIMESTAMP
 0x7473540AL

1552 
	#MI_SFXENTRY
 0x6566530AL

1553 
	#MI_PATCH
 0x7461500AL

1554 
	#MI_USER
 0x0073550AL

1555 
	#MI_PROCDATA
 0x6372500AL

1556 
	#MI_SWDATA
 0x6977530AL

1557 
	#MI_CALLFINT
 0x6966430AL

1558 
	#MI_CALLFMOD
 0x6D66430AL

1559 
	#MI_CALLFABS
 0x6166430AL

1560 
	#MI_INT3BREAK
 0x7470420AL

1561 
	#MI_INT3BRKC
 0x6370420AL

1562 
	#MI_HDWRBREAK
 0x7262480AL

1563 
	#MI_JDDATA
 0x74644A0AL

1564 
	#MI_ANALYSIS
 0x616E410AL

1565 
	#MI_ANALPACK
 0x636E410AL

1566 
	#MI_AHINT
 0x7468410AL

1567 
	#MI_TRACE
 0x6172540AL

1568 
	#MI_TRACEPACK
 0x6372540AL

1569 
	#MI_CODECRC
 0x7263430AL

1570 
	#MI_SAVEAREA
 0x6176530AL

1571 
	#MI_END
 0x646E450AL

1573 
	#MI_WINJUG
 0x67754A0AL

1574 
	#MI_WINJU1
 0x31754A0AL

	)

1575 
	#MI_WINJU2
 0x32754A0AL

	)

1576 
	#MI_WINJU3
 0x33754A0AL

	)

1577 
	#MI_APPST
 0x73614F0AL

1578 

	)

1580 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugöd©a
(
sh‹äame
[32]);

1581 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugööô
(
ﬁlydbgvîsi⁄
,
HWND
 
hw
,

1582 
ul⁄g
 *
„©uªs
);

1583 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugömaölo›
(
DEBUG_EVENT
 *
debugevít
);

1584 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugößveudd
(
t_moduÀ
 *
pmod
,
ismaömoduÀ
);

1585 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugöuddªc‹d
(
t_moduÀ
 *
pmod
,
ismaömoduÀ
,

1586 
ul⁄g
 
èg
,ul⁄g 
size
,*
d©a
);

1587 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugömíu
(
‹igö
,
d©a
[4096],*
ôem
);

1588 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugöa˘i⁄
(
‹igö
,
a˘i⁄
,*
ôem
);

1589 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugösh‹tcut
(

1590 
‹igö
,
˘æ
,
Æt
,
shi·
,
key
,

1591 *
ôem
);

1592 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugöª£t
();

1593 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugö˛o£
();

1594 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugöde°roy
();

1595 
extc
 
_exp‹t
 
cde˛
 
ODBG_Pau£d
(
ªas⁄
,
t_ªg
 *
ªg
);

1596 
extc
 
_exp‹t
 
cde˛
 
ODBG_Pau£dex
(
ªas⁄ex
,
dummy
,
t_ªg
 *
ªg
,

1597 
DEBUG_EVENT
 *
debugevít
);

1598 
extc
 
_exp‹t
 
cde˛
 
ODBG_Plugöcmd
(
ªas⁄
,
t_ªg
 *
ªg
,*
cmd
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\stdafx.cpp

5 
	~"°dafx.h
"

	@E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\stdafx.h

6 #¥agm®
⁄˚


8 
	#_WINSOCKAPI_


	)

9 
	#WIN32_LEAN_AND_MEAN


11 
	~<wödows.h
>

	)

12 
	~<wösock2.h
>

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_bsd.c

10 
	~<Pyth⁄.h
>

11 
	~<as£π.h
>

12 
	~<î∫o.h
>

13 
	~<°dlib.h
>

14 
	~<°dio.h
>

15 
	~<sig«l.h
>

16 
	~<f˙é.h
>

17 
	~<∑ths.h
>

18 
	~<sys/ty≥s.h
>

19 
	~<sys/sys˘l.h
>

20 
	~<sys/∑øm.h
>

21 
	~<sys/u£r.h
>

22 
	~<sys/¥oc.h
>

23 
	~<sys/fûe.h
>

24 
	~<√t/rouã.h
>

26 
	~<sys/sockë.h
>

27 
	~<sys/sockëv¨.h
>

28 
	~<sys/un.h
>

29 
	~<sys/u≈cb.h
>

31 
	~<√töë/ö.h
>

32 
	~<√töë/ö_sy°m.h
>

33 
	~<√töë/ù.h
>

34 
	~<√töë/ö_pcb.h
>

35 
	~<√töë/t˝_v¨.h
>

36 
	~<√töë/t˝_fsm.h
>

37 
	~<¨∑/öë.h
>

39 #i‡
__FªeBSD_vîsi⁄
 < 900000

40 
	~<utmp.h
>

42 
	~<utmpx.h
>

44 
	~<dev°©.h
>

45 
	~<sys/vmmëî.h
>

46 
	~<libutû.h
>

47 
	~<sys/mou¡.h
>

49 
	~<√t/if.h
>

50 
	~<√t/if_dl.h
>

51 
	~<√t/rouã.h
>

53 
	~<√töë/ö.h
>

54 
	~<sys/un.h
>

56 
	~"_psutû_bsd.h
"

57 
	~"_psutû_comm⁄.h
"

58 
	~"¨ch/bsd/¥o˚ss_öfo.h
"

62 
	#TV2DOUBLE
(
t
Ë(—).
tv_£c
 + (t).
tv_u£c
 / 1000000.0)

	)

69 
	$psutû_köfo_¥oc
(c⁄° 
pid_t
 
pid
, 
köfo_¥oc
 *
¥oc
)

71 
mib
[4];

72 
size_t
 
size
;

73 
mib
[0] = 
CTL_KERN
;

74 
mib
[1] = 
KERN_PROC
;

75 
mib
[2] = 
KERN_PROC_PID
;

76 
mib
[3] = 
pid
;

78 
size
 = (
köfo_¥oc
);

80 i‡(
	`sys˘l
((*)
mib
, 4, 
¥oc
, &
size
, 
NULL
, 0) == -1) {

81 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

86 i‡(
size
 == 0) {

87 
	`NoSuchPro˚ss
();

91 
	}
}

97 
PyObje˘
 *

98 
	$psutû_pids
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

100 
köfo_¥oc
 *
¥o˛i°
 = 
NULL
;

101 
köfo_¥oc
 *
‹ig_addªss
 = 
NULL
;

102 
size_t
 
num_¥o˚s£s
;

103 
size_t
 
idx
;

104 
PyObje˘
 *
ªéi°
 = 
	`PyLi°_New
(0);

105 
PyObje˘
 *
pid
 = 
NULL
;

107 i‡(
ªéi°
 =
NULL
) {

108  
NULL
;

110 i‡(
	`psutû_gë_¥oc_li°
(&
¥o˛i°
, &
num_¥o˚s£s
) != 0) {

111 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

113 
îr‹
;

116 i‡(
num_¥o˚s£s
 > 0) {

117 
‹ig_addªss
 = 
¥o˛i°
;

118 
idx
 = 0; idx < 
num_¥o˚s£s
; idx++) {

119 
pid
 = 
	`Py_BuûdVÆue
("i", 
¥o˛i°
->
ki_pid
);

120 i‡(!
pid
)

121 
îr‹
;

122 i‡(
	`PyLi°_Aµíd
(
ªéi°
, 
pid
))

123 
îr‹
;

124 
	`Py_DECREF
(
pid
);

125 
¥o˛i°
++;

127 
	`‰ì
(
‹ig_addªss
);

130  
ªéi°
;

132 
îr‹
:

133 
	`Py_XDECREF
(
pid
);

134 
	`Py_DECREF
(
ªéi°
);

135 i‡(
‹ig_addªss
 !
NULL
) {

136 
	`‰ì
(
‹ig_addªss
);

138  
NULL
;

139 
	}
}

146 
PyObje˘
 *

147 
	$psutû_boŸ_time
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

150 
ªque°
[2] = { 
CTL_KERN
, 
KERN_BOOTTIME
 };

151 
timevÆ
 
boŸtime
;

152 
size_t
 
Àn
 = (
boŸtime
);

154 i‡(
	`sys˘l
(
ªque°
, 2, &
boŸtime
, &
Àn
, 
NULL
, 0) == -1) {

155 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

156  
NULL
;

158  
	`Py_BuûdVÆue
("d", ()
boŸtime
.
tv_£c
);

159 
	}
}

165 
PyObje˘
 *

166 
	$psutû_¥oc_«me
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

168 
pid
;

169 
köfo_¥oc
 
kp
;

170 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

171  
NULL
;

173 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

174  
NULL
;

176  
	`Py_BuûdVÆue
("s", 
kp
.
ki_comm
);

177 
	}
}

185 
PyObje˘
 *

186 
	$psutû_¥oc_exe
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

188 
pid
;

189 
∑th«me
[
PATH_MAX
];

190 
îr‹
;

191 
mib
[4];

192 
size_t
 
size
;

194 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

195  
NULL
;

198 
mib
[0] = 
CTL_KERN
;

199 
mib
[1] = 
KERN_PROC
;

200 
mib
[2] = 
KERN_PROC_PATHNAME
;

201 
mib
[3] = 
pid
;

203 
size
 = (
∑th«me
);

204 
îr‹
 = 
	`sys˘l
(
mib
, 4, 
∑th«me
, &
size
, 
NULL
, 0);

205 i‡(
îr‹
 == -1) {

206 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

207  
NULL
;

209 i‡(
size
 =0 || 
	`°æí
(
∑th«me
) == 0) {

210 i‡(
	`psutû_pid_exi°s
(
pid
) == 0) {

211  
	`NoSuchPro˚ss
();

214 
	`°r˝y
(
∑th«me
, "");

217  
	`Py_BuûdVÆue
("s", 
∑th«me
);

218 
	}
}

224 
PyObje˘
 *

225 
	$psutû_¥oc_cmdlöe
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

227 
pid
;

228 
PyObje˘
 *
¨gli°
 = 
NULL
;

230 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

231  
NULL
;

235 
¨gli°
 = 
	`psutû_gë_¨g_li°
(
pid
);

239 i‡(
NULL
 =
¨gli°
) {

240  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

242  
	`Py_BuûdVÆue
("N", 
¨gli°
);

243 
	}
}

249 
PyObje˘
 *

250 
	$psutû_¥oc_µid
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

252 
pid
;

253 
köfo_¥oc
 
kp
;

254 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

255  
NULL
;

257 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

258  
NULL
;

260  
	`Py_BuûdVÆue
("l", ()
kp
.
ki_µid
);

261 
	}
}

267 
PyObje˘
 *

268 
	$psutû_¥oc_°©us
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

270 
pid
;

271 
köfo_¥oc
 
kp
;

272 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

273  
NULL
;

275 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

276  
NULL
;

278  
	`Py_BuûdVÆue
("i", ()
kp
.
ki_°©
);

279 
	}
}

286 
PyObje˘
 *

287 
	$psutû_¥oc_uids
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

289 
pid
;

290 
köfo_¥oc
 
kp
;

291 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

292  
NULL
;

294 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

295  
NULL
;

297  
	`Py_BuûdVÆue
("lll",

298 ()
kp
.
ki_ruid
,

299 ()
kp
.
ki_uid
,

300 ()
kp
.
ki_svuid
);

301 
	}
}

308 
PyObje˘
 *

309 
	$psutû_¥oc_gids
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

311 
pid
;

312 
köfo_¥oc
 
kp
;

313 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

314  
NULL
;

316 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

317  
NULL
;

319  
	`Py_BuûdVÆue
("lll",

320 ()
kp
.
ki_rgid
,

321 ()
kp
.
ki_groups
[0],

322 ()
kp
.
ki_svuid
);

323 
	}
}

330 
PyObje˘
 *

331 
	$psutû_¥oc_ây_ƒ
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

333 
pid
;

334 
köfo_¥oc
 
kp
;

335 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

336  
NULL
;

338 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

339  
NULL
;

341  
	`Py_BuûdVÆue
("i", 
kp
.
ki_tdev
);

342 
	}
}

348 
PyObje˘
 *

349 
	$psutû_¥oc_num_˘x_swôches
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

351 
pid
;

352 
köfo_¥oc
 
kp
;

353 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

354  
NULL
;

356 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

357  
NULL
;

359  
	`Py_BuûdVÆue
("(ll)",

360 
kp
.
ki_rußge
.
ru_nvcsw
,

361 
kp
.
ki_rußge
.
ru_nivcsw
);

362 
	}
}

368 
PyObje˘
 *

369 
	$psutû_¥oc_num_thªads
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

371 
pid
;

372 
köfo_¥oc
 
kp
;

373 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

374  
NULL
;

376 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

377  
NULL
;

379  
	`Py_BuûdVÆue
("l", ()
kp
.
ki_numthªads
);

380 
	}
}

390 
PyObje˘
 *

391 
	$psutû_¥oc_thªads
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

393 
pid
;

394 
mib
[4];

395 
köfo_¥oc
 *
kù
 = 
NULL
;

396 
köfo_¥oc
 *
kùp
 = 
NULL
;

397 
îr‹
;

398 
i
;

399 
size_t
 
size
;

400 
PyObje˘
 *
ªtLi°
 = 
	`PyLi°_New
(0);

401 
PyObje˘
 *
pyTu∂e
 = 
NULL
;

403 i‡(
ªtLi°
 =
NULL
)

404  
NULL
;

405 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
))

406 
îr‹
;

409 
mib
[0] = 
CTL_KERN
;

410 
mib
[1] = 
KERN_PROC
;

411 
mib
[2] = 
KERN_PROC_PID
 | 
KERN_PROC_INC_THREAD
;

412 
mib
[3] = 
pid
;

414 
size
 = 0;

415 
îr‹
 = 
	`sys˘l
(
mib
, 4, 
NULL
, &
size
, NULL, 0);

416 i‡(
îr‹
 == -1) {

417 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

418 
îr‹
;

420 i‡(
size
 == 0) {

421 
	`NoSuchPro˚ss
();

422 
îr‹
;

425 
kù
 = 
	`mÆloc
(
size
);

426 i‡(
kù
 =
NULL
) {

427 
	`PyEº_NoMem‹y
();

428 
îr‹
;

431 
îr‹
 = 
	`sys˘l
(
mib
, 4, 
kù
, &
size
, 
NULL
, 0);

432 i‡(
îr‹
 == -1) {

433 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

434 
îr‹
;

436 i‡(
size
 == 0) {

437 
	`NoSuchPro˚ss
();

438 
îr‹
;

441 
i
 = 0; i < 
size
 / (*
kùp
); i++) {

442 
kùp
 = &
kù
[
i
];

443 
pyTu∂e
 = 
	`Py_BuûdVÆue
("Idd",

444 
kùp
->
ki_tid
,

445 
	`TV2DOUBLE
(
kùp
->
ki_rußge
.
ru_utime
),

446 
	`TV2DOUBLE
(
kùp
->
ki_rußge
.
ru_°ime
));

447 i‡(
pyTu∂e
 =
NULL
)

448 
îr‹
;

449 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
pyTu∂e
))

450 
îr‹
;

451 
	`Py_DECREF
(
pyTu∂e
);

453 
	`‰ì
(
kù
);

454  
ªtLi°
;

456 
îr‹
:

457 
	`Py_XDECREF
(
pyTu∂e
);

458 
	`Py_DECREF
(
ªtLi°
);

459 i‡(
kù
 !
NULL
) {

460 
	`‰ì
(
kù
);

462  
NULL
;

463 
	}
}

469 
PyObje˘
 *

470 
	$psutû_¥oc_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

472 
pid
;

473 
u£r_t
, 
sys_t
;

474 
köfo_¥oc
 
kp
;

475 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

476  
NULL
;

478 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

479  
NULL
;

482 
u£r_t
 = 
	`TV2DOUBLE
(
kp
.
ki_rußge
.
ru_utime
);

483 
sys_t
 = 
	`TV2DOUBLE
(
kp
.
ki_rußge
.
ru_°ime
);

484  
	`Py_BuûdVÆue
("(dd)", 
u£r_t
, 
sys_t
);

485 
	}
}

492 
PyObje˘
 *

493 
	$psutû_˝u_cou¡_logiˇl
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

495 
mib
[2];

496 
n˝u
;

497 
size_t
 
Àn
;

499 
mib
[0] = 
CTL_HW
;

500 
mib
[1] = 
HW_NCPU
;

501 
Àn
 = (
n˝u
);

503 i‡(
	`sys˘l
(
mib
, 2, &
n˝u
, &
Àn
, 
NULL
, 0) == -1) {

505 
	`Py_INCREF
(
Py_N⁄e
);

506  
Py_N⁄e
;

509  
	`Py_BuûdVÆue
("i", 
n˝u
);

511 
	}
}

518 
PyObje˘
 *

519 
	$psutû_˝u_cou¡_phys
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

521 *
t›ﬁogy
 = 
NULL
;

522 
size_t
 
size
 = 0;

524 i‡(
	`sys˘lby«me
("kîn.sched.t›ﬁogy_•ec", 
NULL
, &
size
, NULL, 0))

525 
îr‹
;

527 
t›ﬁogy
 = 
	`mÆloc
(
size
);

528 i‡(!
t›ﬁogy
) {

529 
	`PyEº_NoMem‹y
();

530  
NULL
;

533 i‡(
	`sys˘lby«me
("kîn.sched.t›ﬁogy_•ec", 
t›ﬁogy
, &
size
, 
NULL
, 0))

534 
îr‹
;

536  
	`Py_BuûdVÆue
("s", 
t›ﬁogy
);

538 
îr‹
:

539 
	`Py_INCREF
(
Py_N⁄e
);

540  
Py_N⁄e
;

541 
	}
}

548 
PyObje˘
 *

549 
	$psutû_¥oc_¸óã_time
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

551 
pid
;

552 
köfo_¥oc
 
kp
;

553 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

554  
NULL
;

556 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

557  
NULL
;

559  
	`Py_BuûdVÆue
("d", 
	`TV2DOUBLE
(
kp
.
ki_°¨t
));

560 
	}
}

567 
PyObje˘
 *

568 
	$psutû_¥oc_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

570 
pid
;

571 
köfo_¥oc
 
kp
;

572 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

573  
NULL
;

575 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

576  
NULL
;

579  
	`Py_BuûdVÆue
("(llll)",

580 
kp
.
ki_rußge
.
ru_öblock
,

581 
kp
.
ki_rußge
.
ru_oublock
,

584 
	}
}

590 
PyObje˘
 *

591 
	$psutû_¥oc_mem‹y_öfo
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

593 
pid
;

594 
köfo_¥oc
 
kp
;

595 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

596  
NULL
;

598 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

599  
NULL
;

601  
	`Py_BuûdVÆue
("(lllll)",

602 
	`±ﬂ
(
kp
.
ki_rssize
),

603 ()
kp
.
ki_size
,

604 
	`±ﬂ
(
kp
.
ki_tsize
),

605 
	`±ﬂ
(
kp
.
ki_dsize
),

606 
	`±ﬂ
(
kp
.
ki_ssize
));

607 
	}
}

613 
PyObje˘
 *

614 
	$psutû_vútuÆ_mem
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

616 
tŸÆ
, 
a˘ive
, 
öa˘ive
, 
wúed
, 
ˇched
, 
‰ì
;

617 
size_t
 
size
 = (
tŸÆ
);

618 
vmtŸÆ
 
vm
;

619 
mib
[] = {
CTL_VM
, 
VM_METER
};

620 
∑gesize
 = 
	`gë∑gesize
();

621 #i‡
__FªeBSD_vîsi⁄
 > 702101

622 
buf„rs
;

624 
buf„rs
;

626 
size_t
 
buf„rs_size
 = (
buf„rs
);

628 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_∑ge_cou¡", &
tŸÆ
, &
size
, 
NULL
, 0))

629 
îr‹
;

630 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_a˘ive_cou¡", &
a˘ive
, &
size
, 
NULL
, 0))

631 
îr‹
;

632 i‡(
	`sys˘lby«me
("vm.stats.vm.v_inactive_count",

633 &
öa˘ive
, &
size
, 
NULL
, 0))

634 
îr‹
;

635 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_wúe_cou¡", &
wúed
, &
size
, 
NULL
, 0))

636 
îr‹
;

637 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_ˇche_cou¡", &
ˇched
, &
size
, 
NULL
, 0))

638 
îr‹
;

639 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_‰ì_cou¡", &
‰ì
, &
size
, 
NULL
, 0))

640 
îr‹
;

641 i‡(
	`sys˘lby«me
("vfs.buf•a˚", &
buf„rs
, &
buf„rs_size
, 
NULL
, 0))

642 
îr‹
;

644 
size
 = (
vm
);

645 i‡(
	`sys˘l
(
mib
, 2, &
vm
, &
size
, 
NULL
, 0) != 0)

646 
îr‹
;

648  
	`Py_BuûdVÆue
("KKKKKKKK",

649 (Ë
tŸÆ
 * 
∑gesize
,

650 (Ë
‰ì
 * 
∑gesize
,

651 (Ë
a˘ive
 * 
∑gesize
,

652 (Ë
öa˘ive
 * 
∑gesize
,

653 (Ë
wúed
 * 
∑gesize
,

654 (Ë
ˇched
 * 
∑gesize
,

655 (Ë
buf„rs
,

656 (Ë(
vm
.
t_vmshr
 + vm.
t_rmshr
Ë* 
∑gesize


659 
îr‹
:

660 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

661  
NULL
;

662 
	}
}

665 #i‚de‡
_PATH_DEVNULL


666 
	#_PATH_DEVNULL
 "/dev/nuŒ"

	)

672 
PyObje˘
 *

673 
	$psutû_sw≠_mem
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

675 
kvm_t
 *
kd
;

676 
kvm_sw≠
 
kvmsw
[1];

677 
sw≠ö
, 
sw≠out
, 
nodeö
, 
nodeout
;

678 
size_t
 
size
 = ();

680 
kd
 = 
	`kvm_›í
(
NULL
, 
_PATH_DEVNULL
, NULL, 
O_RDONLY
, "kvm_open failed");

681 i‡(
kd
 =
NULL
) {

682 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "kvm_open failed");

683  
NULL
;

686 i‡(
	`kvm_gësw≠öfo
(
kd
, 
kvmsw
, 1, 0) < 0) {

687 
	`kvm_˛o£
(
kd
);

688 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "kvm_getswapinfo failed");

689  
NULL
;

692 
	`kvm_˛o£
(
kd
);

694 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_sw≠ö", &
sw≠ö
, &
size
, 
NULL
, 0) == -1)

695 
sbn_îr‹
;

696 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_sw≠out", &
sw≠out
, &
size
, 
NULL
, 0) == -1)

697 
sbn_îr‹
;

698 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_vnodeö", &
nodeö
, &
size
, 
NULL
, 0) == -1)

699 
sbn_îr‹
;

700 i‡(
	`sys˘lby«me
("vm.°©s.vm.v_vnodeout", &
nodeout
, &
size
, 
NULL
, 0) == -1)

701 
sbn_îr‹
;

703  
	`Py_BuûdVÆue
("(iiiII)",

704 
kvmsw
[0].
ksw_tŸÆ
,

705 
kvmsw
[0].
ksw_u£d
,

706 
kvmsw
[0].
ksw_tŸÆ
 - kvmsw[0].
ksw_u£d
,

707 
sw≠ö
 + 
sw≠out
,

708 
nodeö
 + 
nodeout
);

710 
sbn_îr‹
:

711 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

712  
NULL
;

713 
	}
}

719 
PyObje˘
 *

720 
	$psutû_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

722 
˝u_time
[
CPUSTATES
];

723 
size_t
 
size
;

725 
size
 = (
˝u_time
);

727 i‡(
	`sys˘lby«me
("kîn.˝_time", &
˝u_time
, &
size
, 
NULL
, 0) == -1) {

728 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

729  
NULL
;

732  
	`Py_BuûdVÆue
("(ddddd)",

733 ()
˝u_time
[
CP_USER
] / 
CLOCKS_PER_SEC
,

734 ()
˝u_time
[
CP_NICE
] / 
CLOCKS_PER_SEC
,

735 ()
˝u_time
[
CP_SYS
] / 
CLOCKS_PER_SEC
,

736 ()
˝u_time
[
CP_IDLE
] / 
CLOCKS_PER_SEC
,

737 ()
˝u_time
[
CP_INTR
] / 
CLOCKS_PER_SEC


739 
	}
}

750 #i‡
deföed
(
__FªeBSD_vîsi⁄
) && __FreeBSD_version >= 800000

754 
PyObje˘
 *

755 
	$psutû_¥oc_›í_fûes
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

757 
pid
;

758 
i
, 
˙t
;

759 
köfo_fûe
 *
‰ìp
 = 
NULL
;

760 
köfo_fûe
 *
kif
;

761 
köfo_¥oc
 
kùp
;

762 
PyObje˘
 *
ªtLi°
 = 
	`PyLi°_New
(0);

763 
PyObje˘
 *
tu∂e
 = 
NULL
;

765 i‡(
ªtLi°
 =
NULL
)

766  
NULL
;

767 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
))

768 
îr‹
;

769 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kùp
) == -1)

770 
îr‹
;

772 
‰ìp
 = 
	`köfo_gëfûe
(
pid
, &
˙t
);

773 i‡(
‰ìp
 =
NULL
) {

774 
	`psutû_øi£_ad_‹_n•
(
pid
);

775 
îr‹
;

778 
i
 = 0; i < 
˙t
; i++) {

779 
kif
 = &
‰ìp
[
i
];

780 i‡((
kif
->
kf_ty≥
 =
KF_TYPE_VNODE
) &&

781 (
kif
->
kf_vnode_ty≥
 =
KF_VTYPE_VREG
))

783 
tu∂e
 = 
	`Py_BuûdVÆue
("(si)", 
kif
->
kf_∑th
, kif->
kf_fd
);

784 i‡(
tu∂e
 =
NULL
)

785 
îr‹
;

786 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
tu∂e
))

787 
îr‹
;

788 
	`Py_DECREF
(
tu∂e
);

791 
	`‰ì
(
‰ìp
);

792  
ªtLi°
;

794 
îr‹
:

795 
	`Py_XDECREF
(
tu∂e
);

796 
	`Py_DECREF
(
ªtLi°
);

797 i‡(
‰ìp
 !
NULL
)

798 
	`‰ì
(
‰ìp
);

799  
NULL
;

800 
	}
}

806 
PyObje˘
 *

807 
	$psutû_¥oc_num_fds
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

809 
pid
;

810 
˙t
;

812 
köfo_fûe
 *
‰ìp
;

813 
köfo_¥oc
 
kùp
;

815 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
))

816  
NULL
;

817 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kùp
) == -1)

818  
NULL
;

820 
‰ìp
 = 
	`köfo_gëfûe
(
pid
, &
˙t
);

821 i‡(
‰ìp
 =
NULL
) {

822 
	`psutû_øi£_ad_‹_n•
(
pid
);

823  
NULL
;

825 
	`‰ì
(
‰ìp
);

827  
	`Py_BuûdVÆue
("i", 
˙t
);

828 
	}
}

834 
PyObje˘
 *

835 
	$psutû_¥oc_cwd
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

837 
pid
;

838 
PyObje˘
 *
∑th
 = 
NULL
;

839 
köfo_fûe
 *
‰ìp
 = 
NULL
;

840 
köfo_fûe
 *
kif
;

841 
köfo_¥oc
 
kùp
;

843 
i
, 
˙t
;

845 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
))

846 
îr‹
;

847 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kùp
) == -1)

848 
îr‹
;

850 
‰ìp
 = 
	`köfo_gëfûe
(
pid
, &
˙t
);

851 i‡(
‰ìp
 =
NULL
) {

852 
	`psutû_øi£_ad_‹_n•
(
pid
);

853 
îr‹
;

856 
i
 = 0; i < 
˙t
; i++) {

857 
kif
 = &
‰ìp
[
i
];

858 i‡(
kif
->
kf_fd
 =
KF_FD_TYPE_CWD
) {

859 
∑th
 = 
	`Py_BuûdVÆue
("s", 
kif
->
kf_∑th
);

860 i‡(!
∑th
)

861 
îr‹
;

870 i‡(
∑th
 =
NULL
) {

871 
∑th
 = 
	`Py_BuûdVÆue
("s", "");

873 
	`‰ì
(
‰ìp
);

874  
∑th
;

876 
îr‹
:

877 
	`Py_XDECREF
(
∑th
);

878 i‡(
‰ìp
 !
NULL
)

879 
	`‰ì
(
‰ìp
);

880  
NULL
;

881 
	}
}

886 
	$psutû_„tch_t˝li°
()

888 *
buf
;

889 
size_t
 
Àn
;

890 
îr‹
;

893 i‡(
	`sys˘lby«me
("√t.öë.t˝.pcbli°", 
NULL
, &
Àn
, NULL, 0) < 0) {

894 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

895  
NULL
;

897 
buf
 = 
	`mÆloc
(
Àn
);

898 i‡(
buf
 =
NULL
) {

899 
	`PyEº_NoMem‹y
();

900  
NULL
;

902 i‡(
	`sys˘lby«me
("√t.öë.t˝.pcbli°", 
buf
, &
Àn
, 
NULL
, 0) < 0) {

903 
	`‰ì
(
buf
);

904 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

905  
NULL
;

907  
buf
;

909 
	}
}

912 
	$psutû_sockaddr_p‹t
(
Ámûy
, 
sockaddr_°‹age
 *
ss
)

914 
sockaddr_ö6
 *
sö6
;

915 
sockaddr_ö
 *
sö
;

917 i‡(
Ámûy
 =
AF_INET
) {

918 
sö
 = (
sockaddr_ö
 *)
ss
;

919  (
sö
->
sö_p‹t
);

921 
sö6
 = (
sockaddr_ö6
 *)
ss
;

922  (
sö6
->
sö6_p‹t
);

924 
	}
}

927 
	$psutû_sockaddr_addr
(
Ámûy
, 
sockaddr_°‹age
 *
ss
)

929 
sockaddr_ö6
 *
sö6
;

930 
sockaddr_ö
 *
sö
;

932 i‡(
Ámûy
 =
AF_INET
) {

933 
sö
 = (
sockaddr_ö
 *)
ss
;

934  (&
sö
->
sö_addr
);

936 
sö6
 = (
sockaddr_ö6
 *)
ss
;

937  (&
sö6
->
sö6_addr
);

939 
	}
}

941 
sockÀn_t


942 
	$psutû_sockaddr_addæí
(
Ámûy
)

944 i‡(
Ámûy
 =
AF_INET
)

945  ((
ö_addr
));

947  ((
ö6_addr
));

948 
	}
}

951 
	$psutû_sockaddr_m©ches
(
Ámûy
, 
p‹t
, *
pcb_addr
,

952 
sockaddr_°‹age
 *
ss
)

954 i‡(
	`psutû_sockaddr_p‹t
(
Ámûy
, 
ss
Ë!
p‹t
)

956  (
	`memcmp
(
	`psutû_sockaddr_addr
(
Ámûy
, 
ss
), 
pcb_addr
,

957 
	`psutû_sockaddr_addæí
(
Ámûy
)) == 0);

958 
	}
}

960 
t˝cb
 *

961 
	$psutû_£¨ch_t˝li°
(*
buf
, 
köfo_fûe
 *
kif
)

963 
t˝cb
 *
ç
;

964 
öpcb
 *
öp
;

965 
xöpgí
 *
xig
, *
oxig
;

966 
xsockë
 *
so
;

968 
oxig
 = 
xig
 = (
xöpgí
 *)
buf
;

969 
xig
 = (
xöpgí
 *)((*)xig + xig->
xig_Àn
);

970 
xig
->
xig_Àn
 > (
xöpgí
);

971 
xig
 = (
xöpgí
 *)((*)xig + xig->
xig_Àn
)) {

972 
ç
 = &((
xt˝cb
 *)
xig
)->
xt_ç
;

973 
öp
 = &((
xt˝cb
 *)
xig
)->
xt_öp
;

974 
so
 = &((
xt˝cb
 *)
xig
)->
xt_sockë
;

976 i‡(
so
->
so_ty≥
 !
kif
->
kf_sock_ty≥
 ||

977 
so
->
xso_Ámûy
 !
kif
->
kf_sock_domaö
 ||

978 
so
->
xso_¥Ÿocﬁ
 !
kif
->
kf_sock_¥Ÿocﬁ
)

981 i‡(
kif
->
kf_sock_domaö
 =
AF_INET
) {

982 i‡(!
	`psutû_sockaddr_m©ches
(

983 
AF_INET
, 
öp
->
öp_Õ‹t
, &öp->
öp_œddr
,

984 &
kif
->
kf_ß_loˇl
))

986 i‡(!
	`psutû_sockaddr_m©ches
(

987 
AF_INET
, 
öp
->
öp_Â‹t
, &öp->
öp_Áddr
,

988 &
kif
->
kf_ß_≥î
))

991 i‡(!
	`psutû_sockaddr_m©ches
(

992 
AF_INET6
, 
öp
->
öp_Õ‹t
, &öp->
ö6p_œddr
,

993 &
kif
->
kf_ß_loˇl
))

995 i‡(!
	`psutû_sockaddr_m©ches
(

996 
AF_INET6
, 
öp
->
öp_Â‹t
, &öp->
ö6p_Áddr
,

997 &
kif
->
kf_ß_≥î
))

1001  (
ç
);

1003  
NULL
;

1004 
	}
}

1008 
	gPSUTIL_CONN_NONE
 = 128;

1013 
PyObje˘
 *

1014 
	$psutû_¥oc_c⁄√˘i⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1016 
pid
;

1017 
i
, 
˙t
;

1019 
köfo_fûe
 *
‰ìp
 = 
NULL
;

1020 
köfo_fûe
 *
kif
;

1021 *
t˝li°
 = 
NULL
;

1022 
t˝cb
 *
t˝
;

1024 
PyObje˘
 *
ªtLi°
 = 
	`PyLi°_New
(0);

1025 
PyObje˘
 *
tu∂e
 = 
NULL
;

1026 
PyObje˘
 *
œddr
 = 
NULL
;

1027 
PyObje˘
 *
øddr
 = 
NULL
;

1028 
PyObje˘
 *
af_fûãr
 = 
NULL
;

1029 
PyObje˘
 *
ty≥_fûãr
 = 
NULL
;

1030 
PyObje˘
 *
_Ámûy
 = 
NULL
;

1031 
PyObje˘
 *
_ty≥
 = 
NULL
;

1033 i‡(
ªtLi°
 =
NULL
) {

1034  
NULL
;

1036 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "lOO", &
pid
, &
af_fûãr
, &
ty≥_fûãr
)) {

1037 
îr‹
;

1039 i‡(!
	`PySequí˚_Check
(
af_fûãr
Ë|| !PySequí˚_Check(
ty≥_fûãr
)) {

1040 
	`PyEº_SëSåög
(
PyExc_Ty≥Eº‹
, "arg 2 or 3 isÇotá sequence");

1041 
îr‹
;

1044 
‰ìp
 = 
	`köfo_gëfûe
(
pid
, &
˙t
);

1045 i‡(
‰ìp
 =
NULL
) {

1046 
	`psutû_øi£_ad_‹_n•
(
pid
);

1047 
îr‹
;

1050 
t˝li°
 = 
	`psutû_„tch_t˝li°
();

1051 i‡(
t˝li°
 =
NULL
) {

1052 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1053 
îr‹
;

1056 
i
 = 0; i < 
˙t
; i++) {

1057 
Õ‹t
, 
Ω‹t
, 
°©e
;

1058 
lù
[200], 
rù
[200];

1059 
∑th
[
PATH_MAX
];

1060 
ö£q
;

1061 
tu∂e
 = 
NULL
;

1062 
œddr
 = 
NULL
;

1063 
øddr
 = 
NULL
;

1065 
kif
 = &
‰ìp
[
i
];

1066 i‡(
kif
->
kf_ty≥
 =
KF_TYPE_SOCKET
)

1069 
_Ámûy
 = 
	`PyL⁄g_FromL⁄g
(()
kif
->
kf_sock_domaö
);

1070 
ö£q
 = 
	`PySequí˚_C⁄èös
(
af_fûãr
, 
_Ámûy
);

1071 
	`Py_DECREF
(
_Ámûy
);

1072 i‡(
ö£q
 == 0) {

1075 
_ty≥
 = 
	`PyL⁄g_FromL⁄g
(()
kif
->
kf_sock_ty≥
);

1076 
ö£q
 = 
	`PySequí˚_C⁄èös
(
ty≥_fûãr
, 
_ty≥
);

1077 
	`Py_DECREF
(
_ty≥
);

1078 i‡(
ö£q
 == 0) {

1083 i‡((
kif
->
kf_sock_domaö
 =
AF_INET
) ||

1084 (
kif
->
kf_sock_domaö
 =
AF_INET6
)) {

1086 
°©e
 = 
PSUTIL_CONN_NONE
;

1087 i‡(
kif
->
kf_sock_ty≥
 =
SOCK_STREAM
) {

1088 
t˝
 = 
	`psutû_£¨ch_t˝li°
(
t˝li°
, 
kif
);

1089 i‡(
t˝
 !
NULL
)

1090 
°©e
 = ()
t˝
->
t_°©e
;

1094 
	`öë_¡›
(

1095 
kif
->
kf_sock_domaö
,

1096 
	`psutû_sockaddr_addr
(
kif
->
kf_sock_domaö
,

1097 &
kif
->
kf_ß_loˇl
),

1098 
lù
,

1099 (
lù
));

1100 
	`öë_¡›
(

1101 
kif
->
kf_sock_domaö
,

1102 
	`psutû_sockaddr_addr
(
kif
->
kf_sock_domaö
,

1103 &
kif
->
kf_ß_≥î
),

1104 
rù
,

1105 (
rù
));

1106 
Õ‹t
 = 
	`ht⁄s
(
	`psutû_sockaddr_p‹t
(
kif
->
kf_sock_domaö
,

1107 &
kif
->
kf_ß_loˇl
));

1108 
Ω‹t
 = 
	`ht⁄s
(
	`psutû_sockaddr_p‹t
(
kif
->
kf_sock_domaö
,

1109 &
kif
->
kf_ß_≥î
));

1112 
œddr
 = 
	`Py_BuûdVÆue
("(si)", 
lù
, 
Õ‹t
);

1113 i‡(!
œddr
)

1114 
îr‹
;

1115 i‡(
Ω‹t
 != 0) {

1116 
øddr
 = 
	`Py_BuûdVÆue
("(si)", 
rù
, 
Ω‹t
);

1119 
øddr
 = 
	`Py_BuûdVÆue
("()");

1121 i‡(!
øddr
)

1122 
îr‹
;

1123 
tu∂e
 = 
	`Py_BuûdVÆue
("(iiiNNi)",

1124 
kif
->
kf_fd
,

1125 
kif
->
kf_sock_domaö
,

1126 
kif
->
kf_sock_ty≥
,

1127 
œddr
,

1128 
øddr
,

1129 
°©e
);

1130 i‡(!
tu∂e
)

1131 
îr‹
;

1132 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
tu∂e
))

1133 
îr‹
;

1134 
	`Py_DECREF
(
tu∂e
);

1137 i‡(
kif
->
kf_sock_domaö
 =
AF_UNIX
) {

1138 
sockaddr_un
 *
sun
;

1140 
sun
 = (
sockaddr_un
 *)&
kif
->
kf_ß_loˇl
;

1141 
	`¢¥ötf
(

1142 
∑th
, (path), "%.*s",

1143 (
sun
->
sun_Àn
 - ((*sunË- (sun->
sun_∑th
))),

1144 
sun
->
sun_∑th
);

1146 
tu∂e
 = 
	`Py_BuûdVÆue
("(iiisOi)",

1147 
kif
->
kf_fd
,

1148 
kif
->
kf_sock_domaö
,

1149 
kif
->
kf_sock_ty≥
,

1150 
∑th
,

1151 
Py_N⁄e
,

1152 
PSUTIL_CONN_NONE
);

1153 i‡(!
tu∂e
)

1154 
îr‹
;

1155 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
tu∂e
))

1156 
îr‹
;

1157 
	`Py_DECREF
(
tu∂e
);

1158 
	`Py_INCREF
(
Py_N⁄e
);

1162 
	`‰ì
(
‰ìp
);

1163 
	`‰ì
(
t˝li°
);

1164  
ªtLi°
;

1166 
îr‹
:

1167 
	`Py_XDECREF
(
tu∂e
);

1168 
	`Py_XDECREF
(
œddr
);

1169 
	`Py_XDECREF
(
øddr
);

1170 
	`Py_DECREF
(
ªtLi°
);

1171 i‡(
‰ìp
 !
NULL
)

1172 
	`‰ì
(
‰ìp
);

1173 i‡(
t˝li°
 !
NULL
)

1174 
	`‰ì
(
t˝li°
);

1175  
NULL
;

1176 
	}
}

1182 
PyObje˘
 *

1183 
	$psutû_≥r_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1185 
max˝us
;

1186 
mib
[2];

1187 
n˝u
;

1188 
size_t
 
Àn
;

1189 
size_t
 
size
;

1190 
i
;

1191 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

1192 
PyObje˘
 *
py_˝utime
 = 
NULL
;

1194 i‡(
py_ªéi°
 =
NULL
)

1195  
NULL
;

1198 
size
 = (
max˝us
);

1199 i‡(
	`sys˘lby«me
("kîn.smp.max˝us", &
max˝us
, &
size
, 
NULL
, 0) < 0) {

1200 
	`Py_DECREF
(
py_ªéi°
);

1201 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1202  
NULL
;

1204 
˝u_time
[
max˝us
][
CPUSTATES
];

1207 
mib
[0] = 
CTL_HW
;

1208 
mib
[1] = 
HW_NCPU
;

1209 
Àn
 = (
n˝u
);

1210 i‡(
	`sys˘l
(
mib
, 2, &
n˝u
, &
Àn
, 
NULL
, 0) == -1) {

1211 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1212 
îr‹
;

1216 
size
 = (
˝u_time
);

1217 i‡(
	`sys˘lby«me
("kîn.˝_times", &
˝u_time
, &
size
, 
NULL
, 0) == -1) {

1218 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1219 
îr‹
;

1222 
i
 = 0; i < 
n˝u
; i++) {

1223 
py_˝utime
 = 
	`Py_BuûdVÆue
(

1225 ()
˝u_time
[
i
][
CP_USER
] / 
CLOCKS_PER_SEC
,

1226 ()
˝u_time
[
i
][
CP_NICE
] / 
CLOCKS_PER_SEC
,

1227 ()
˝u_time
[
i
][
CP_SYS
] / 
CLOCKS_PER_SEC
,

1228 ()
˝u_time
[
i
][
CP_IDLE
] / 
CLOCKS_PER_SEC
,

1229 ()
˝u_time
[
i
][
CP_INTR
] / 
CLOCKS_PER_SEC
);

1230 i‡(!
py_˝utime
)

1231 
îr‹
;

1232 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_˝utime
))

1233 
îr‹
;

1234 
	`Py_DECREF
(
py_˝utime
);

1237  
py_ªéi°
;

1239 
îr‹
:

1240 
	`Py_XDECREF
(
py_˝utime
);

1241 
	`Py_DECREF
(
py_ªéi°
);

1242  
NULL
;

1243 
	}
}

1247 
	$ªmove_•a˚s
(*
°r
) {

1248 *
p1
 = 
°r
;

1249 *
p2
 = 
°r
;

1251 *
p2
 == ' ')

1252 
p2
++;

1253 *
p1
++ = *
p2
++);

1254 
	}
}

1261 
PyObje˘
 *

1262 
	$psutû_¥oc_mem‹y_m≠s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1264 
pid
;

1265 
±rwidth
;

1266 
i
, 
˙t
;

1267 
addr
[30];

1268 
≥rms
[4];

1269 c⁄° *
∑th
;

1270 
köfo_¥oc
 
kp
;

1271 
köfo_vmíåy
 *
‰ìp
 = 
NULL
;

1272 
köfo_vmíåy
 *
kve
;

1273 
±rwidth
 = 2 * (*);

1274 
PyObje˘
 *
pytu∂e
 = 
NULL
;

1275 
PyObje˘
 *
ªéi°
 = 
	`PyLi°_New
(0);

1277 i‡(
ªéi°
 =
NULL
) {

1278  
NULL
;

1280 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1281 
îr‹
;

1283 i‡(
	`psutû_köfo_¥oc
(
pid
, &
kp
) == -1) {

1284 
îr‹
;

1287 
‰ìp
 = 
	`köfo_gëvmm≠
(
pid
, &
˙t
);

1288 i‡(
‰ìp
 =
NULL
) {

1289 
	`psutû_øi£_ad_‹_n•
(
pid
);

1290 
îr‹
;

1292 
i
 = 0; i < 
˙t
; i++) {

1293 
pytu∂e
 = 
NULL
;

1294 
kve
 = &
‰ìp
[
i
];

1295 
addr
[0] = '\0';

1296 
≥rms
[0] = '\0';

1297 
	`•rötf
(
addr
, "%#*jx-%#*jx", 
±rwidth
, (
uötmax_t
)
kve
->
kve_°¨t
,

1298 
±rwidth
, (
uötmax_t
)
kve
->
kve_íd
);

1299 
	`ªmove_•a˚s
(
addr
);

1300 
	`°æˇt
(
≥rms
, 
kve
->
kve_¥Ÿe˘i⁄
 & 
KVME_PROT_READ
 ? "r" : "-",

1301 (
≥rms
));

1302 
	`°æˇt
(
≥rms
, 
kve
->
kve_¥Ÿe˘i⁄
 & 
KVME_PROT_WRITE
 ? "w" : "-",

1303 (
≥rms
));

1304 
	`°æˇt
(
≥rms
, 
kve
->
kve_¥Ÿe˘i⁄
 & 
KVME_PROT_EXEC
 ? "x" : "-",

1305 (
≥rms
));

1307 i‡(
	`°æí
(
kve
->
kve_∑th
) == 0) {

1308 
kve
->
kve_ty≥
) {

1309 
KVME_TYPE_NONE
:

1310 
∑th
 = "[none]";

1312 
KVME_TYPE_DEFAULT
:

1313 
∑th
 = "[default]";

1315 
KVME_TYPE_VNODE
:

1316 
∑th
 = "[vnode]";

1318 
KVME_TYPE_SWAP
:

1319 
∑th
 = "[swap]";

1321 
KVME_TYPE_DEVICE
:

1322 
∑th
 = "[device]";

1324 
KVME_TYPE_PHYS
:

1325 
∑th
 = "[phys]";

1327 
KVME_TYPE_DEAD
:

1328 
∑th
 = "[dead]";

1330 
KVME_TYPE_SG
:

1331 
∑th
 = "[sg]";

1333 
KVME_TYPE_UNKNOWN
:

1334 
∑th
 = "[unknown]";

1337 
∑th
 = "[?]";

1342 
∑th
 = 
kve
->
kve_∑th
;

1345 
pytu∂e
 = 
	`Py_BuûdVÆue
("sssiiii",

1346 
addr
,

1347 
≥rms
,

1348 
∑th
,

1349 
kve
->
kve_ªsidít
,

1350 
kve
->
kve_¥iv©e_ªsidít
,

1351 
kve
->
kve_ªf_cou¡
,

1352 
kve
->
kve_shadow_cou¡
);

1353 i‡(!
pytu∂e
)

1354 
îr‹
;

1355 i‡(
	`PyLi°_Aµíd
(
ªéi°
, 
pytu∂e
))

1356 
îr‹
;

1357 
	`Py_DECREF
(
pytu∂e
);

1359 
	`‰ì
(
‰ìp
);

1360  
ªéi°
;

1362 
îr‹
:

1363 
	`Py_XDECREF
(
pytu∂e
);

1364 
	`Py_DECREF
(
ªéi°
);

1365 i‡(
‰ìp
 !
NULL
)

1366 
	`‰ì
(
‰ìp
);

1367  
NULL
;

1368 
	}
}

1376 
PyObje˘
 *

1377 
	$psutû_disk_∑πôi⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1379 
num
;

1380 
i
;

1381 
Àn
;

1382 
uöt64_t
 
Êags
;

1383 
›ts
[200];

1384 
°©fs
 *
fs
 = 
NULL
;

1385 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

1386 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

1388 i‡(
py_ªéi°
 =
NULL
)

1389  
NULL
;

1392 
Py_BEGIN_ALLOW_THREADS


1393 
num
 = 
	`gëfs°©
(
NULL
, 0, 
MNT_NOWAIT
);

1394 
Py_END_ALLOW_THREADS


1395 i‡(
num
 == -1) {

1396 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1397 
îr‹
;

1400 
Àn
 = (*
fs
Ë* 
num
;

1401 
fs
 = 
	`mÆloc
(
Àn
);

1402 i‡(
fs
 =
NULL
) {

1403 
	`PyEº_NoMem‹y
();

1404 
îr‹
;

1407 
Py_BEGIN_ALLOW_THREADS


1408 
num
 = 
	`gëfs°©
(
fs
, 
Àn
, 
MNT_NOWAIT
);

1409 
Py_END_ALLOW_THREADS


1410 i‡(
num
 == -1) {

1411 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1412 
îr‹
;

1415 
i
 = 0; i < 
num
; i++) {

1416 
py_tu∂e
 = 
NULL
;

1417 
›ts
[0] = 0;

1418 
Êags
 = 
fs
[
i
].
f_Êags
;

1421 i‡(
Êags
 & 
MNT_RDONLY
)

1422 
	`°æˇt
(
›ts
, "ro", (opts));

1424 
	`°æˇt
(
›ts
, "rw", (opts));

1425 i‡(
Êags
 & 
MNT_SYNCHRONOUS
)

1426 
	`°æˇt
(
›ts
, ",sync", (opts));

1427 i‡(
Êags
 & 
MNT_NOEXEC
)

1428 
	`°æˇt
(
›ts
, ",noexec", (opts));

1429 i‡(
Êags
 & 
MNT_NOSUID
)

1430 
	`°æˇt
(
›ts
, ",nosuid", (opts));

1431 i‡(
Êags
 & 
MNT_UNION
)

1432 
	`°æˇt
(
›ts
, ",union", (opts));

1433 i‡(
Êags
 & 
MNT_ASYNC
)

1434 
	`°æˇt
(
›ts
, ",async", (opts));

1435 i‡(
Êags
 & 
MNT_SUIDDIR
)

1436 
	`°æˇt
(
›ts
, ",suiddir", (opts));

1437 i‡(
Êags
 & 
MNT_SOFTDEP
)

1438 
	`°æˇt
(
›ts
, ",softdep", (opts));

1439 i‡(
Êags
 & 
MNT_NOSYMFOLLOW
)

1440 
	`°æˇt
(
›ts
, ",nosymfollow", (opts));

1441 i‡(
Êags
 & 
MNT_GJOURNAL
)

1442 
	`°æˇt
(
›ts
, ",gjournal", (opts));

1443 i‡(
Êags
 & 
MNT_MULTILABEL
)

1444 
	`°æˇt
(
›ts
, ",multilabel", (opts));

1445 i‡(
Êags
 & 
MNT_ACLS
)

1446 
	`°æˇt
(
›ts
, ",acls", (opts));

1447 i‡(
Êags
 & 
MNT_NOATIME
)

1448 
	`°æˇt
(
›ts
, ",noatime", (opts));

1449 i‡(
Êags
 & 
MNT_NOCLUSTERR
)

1450 
	`°æˇt
(
›ts
, ",noclusterr", (opts));

1451 i‡(
Êags
 & 
MNT_NOCLUSTERW
)

1452 
	`°æˇt
(
›ts
, ",noclusterw", (opts));

1453 i‡(
Êags
 & 
MNT_NFS4ACLS
)

1454 
	`°æˇt
(
›ts
, ",nfs4acls", (opts));

1456 
py_tu∂e
 = 
	`Py_BuûdVÆue
("(ssss)",

1457 
fs
[
i
].
f_m¡‰om«me
,

1458 
fs
[
i
].
f_m¡⁄«me
,

1459 
fs
[
i
].
f_f°y≥«me
,

1460 
›ts
);

1461 i‡(!
py_tu∂e
)

1462 
îr‹
;

1463 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

1464 
îr‹
;

1465 
	`Py_DECREF
(
py_tu∂e
);

1468 
	`‰ì
(
fs
);

1469  
py_ªéi°
;

1471 
îr‹
:

1472 
	`Py_XDECREF
(
py_tu∂e
);

1473 
	`Py_DECREF
(
py_ªéi°
);

1474 i‡(
fs
 !
NULL
)

1475 
	`‰ì
(
fs
);

1476  
NULL
;

1477 
	}
}

1483 
PyObje˘
 *

1484 
	$psutû_√t_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1486 *
buf
 = 
NULL
, *
lim
, *
√xt
;

1487 
if_msghdr
 *
ifm
;

1488 
mib
[6];

1489 
size_t
 
Àn
;

1490 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

1491 
PyObje˘
 *
py_ifc_öfo
 = 
NULL
;

1492 i‡(
py_ªtdi˘
 =
NULL
)

1493  
NULL
;

1495 
mib
[0] = 
CTL_NET
;

1496 
mib
[1] = 
PF_ROUTE
;

1497 
mib
[2] = 0;

1498 
mib
[3] = 0;

1499 
mib
[4] = 
NET_RT_IFLIST
;

1500 
mib
[5] = 0;

1502 i‡(
	`sys˘l
(
mib
, 6, 
NULL
, &
Àn
, NULL, 0) < 0) {

1503 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1504 
îr‹
;

1507 
buf
 = 
	`mÆloc
(
Àn
);

1508 i‡(
buf
 =
NULL
) {

1509 
	`PyEº_NoMem‹y
();

1510 
îr‹
;

1513 i‡(
	`sys˘l
(
mib
, 6, 
buf
, &
Àn
, 
NULL
, 0) < 0) {

1514 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1515 
îr‹
;

1518 
lim
 = 
buf
 + 
Àn
;

1520 
√xt
 = 
buf
;Çexà< 
lim
; ) {

1521 
py_ifc_öfo
 = 
NULL
;

1522 
ifm
 = (
if_msghdr
 *)
√xt
;

1523 
√xt
 +
ifm
->
ifm_msgÀn
;

1525 i‡(
ifm
->
ifm_ty≥
 =
RTM_IFINFO
) {

1526 
if_msghdr
 *
if2m
 = (if_msghd∏*)
ifm
;

1527 
sockaddr_dl
 *
sdl
 = (sockaddr_d»*)(
if2m
 + 1);

1528 
ifc_«me
[32];

1530 
	`°∫˝y
(
ifc_«me
, 
sdl
->
sdl_d©a
, sdl->
sdl_∆í
);

1531 
ifc_«me
[
sdl
->
sdl_∆í
] = 0;

1536 i‡(
	`°∫cmp
(
ifc_«me
, "usbus", 5) == 0) {

1540 
py_ifc_öfo
 = 
	`Py_BuûdVÆue
("(kkkkkkki)",

1541 
if2m
->
ifm_d©a
.
ifi_obyãs
,

1542 
if2m
->
ifm_d©a
.
ifi_ibyãs
,

1543 
if2m
->
ifm_d©a
.
ifi_›ackës
,

1544 
if2m
->
ifm_d©a
.
ifi_ùackës
,

1545 
if2m
->
ifm_d©a
.
ifi_õº‹s
,

1546 
if2m
->
ifm_d©a
.
ifi_€º‹s
,

1547 
if2m
->
ifm_d©a
.
ifi_iqdr›s
,

1549 i‡(!
py_ifc_öfo
)

1550 
îr‹
;

1551 i‡(
	`PyDi˘_SëIãmSåög
(
py_ªtdi˘
, 
ifc_«me
, 
py_ifc_öfo
))

1552 
îr‹
;

1553 
	`Py_DECREF
(
py_ifc_öfo
);

1560 
	`‰ì
(
buf
);

1561  
py_ªtdi˘
;

1563 
îr‹
:

1564 
	`Py_XDECREF
(
py_ifc_öfo
);

1565 
	`Py_DECREF
(
py_ªtdi˘
);

1566 i‡(
buf
 !
NULL
)

1567 
	`‰ì
(
buf
);

1568  
NULL
;

1569 
	}
}

1575 
PyObje˘
 *

1576 
	$psutû_disk_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1578 
i
;

1579 
°©öfo
 
°©s
;

1581 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

1582 
PyObje˘
 *
py_disk_öfo
 = 
NULL
;

1583 i‡(
py_ªtdi˘
 =
NULL
)

1584  
NULL
;

1586 i‡(
	`dev°©_checkvîsi⁄
(
NULL
) < 0) {

1587 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "devstat_checkversion() failed");

1588 
îr‹
;

1591 
°©s
.
döfo
 = (
devöfo
 *)
	`mÆloc
((devinfo));

1592 i‡(
°©s
.
döfo
 =
NULL
) {

1593 
	`PyEº_NoMem‹y
();

1594 
îr‹
;

1596 
	`bzîo
(
°©s
.
döfo
, (
devöfo
));

1598 i‡(
	`dev°©_gëdevs
(
NULL
, &
°©s
) == -1) {

1599 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "devstat_getdevs() failed");

1600 
îr‹
;

1603 
i
 = 0; i < 
°©s
.
döfo
->
numdevs
; i++) {

1604 
py_disk_öfo
 = 
NULL
;

1605 
dev°©
 
cuºít
;

1606 
disk_«me
[128];

1607 
cuºít
 = 
°©s
.
döfo
->
devi˚s
[
i
];

1608 
	`¢¥ötf
(
disk_«me
, (disk_name), "%s%d",

1609 
cuºít
.
devi˚_«me
,

1610 
cuºít
.
unô_numbî
);

1612 
py_disk_öfo
 = 
	`Py_BuûdVÆue
(

1614 
cuºít
.
›î©i⁄s
[
DEVSTAT_READ
],

1615 
cuºít
.
›î©i⁄s
[
DEVSTAT_WRITE
],

1616 
cuºít
.
byãs
[
DEVSTAT_READ
],

1617 
cuºít
.
byãs
[
DEVSTAT_WRITE
],

1618 ()
	`dev°©_compuã_ëime
(

1619 &
cuºít
.
duøti⁄
[
DEVSTAT_READ
], 
NULL
),

1620 ()
	`dev°©_compuã_ëime
(

1621 &
cuºít
.
duøti⁄
[
DEVSTAT_WRITE
], 
NULL
));

1622 i‡(!
py_disk_öfo
)

1623 
îr‹
;

1624 i‡(
	`PyDi˘_SëIãmSåög
(
py_ªtdi˘
, 
disk_«me
, 
py_disk_öfo
))

1625 
îr‹
;

1626 
	`Py_DECREF
(
py_disk_öfo
);

1629 i‡(
°©s
.
döfo
->
mem_±r
) {

1630 
	`‰ì
(
°©s
.
döfo
->
mem_±r
);

1632 
	`‰ì
(
°©s
.
döfo
);

1633  
py_ªtdi˘
;

1635 
îr‹
:

1636 
	`Py_XDECREF
(
py_disk_öfo
);

1637 
	`Py_DECREF
(
py_ªtdi˘
);

1638 i‡(
°©s
.
döfo
 !
NULL
)

1639 
	`‰ì
(
°©s
.
döfo
);

1640  
NULL
;

1641 
	}
}

1647 
PyObje˘
 *

1648 
	$psutû_u£rs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1650 
PyObje˘
 *
ªt_li°
 = 
	`PyLi°_New
(0);

1651 
PyObje˘
 *
tu∂e
 = 
NULL
;

1653 i‡(
ªt_li°
 =
NULL
)

1654  
NULL
;

1656 #i‡
__FªeBSD_vîsi⁄
 < 900000

1657 
utmp
 
ut
;

1658 
FILE
 *
Â
;

1660 
Â
 = 
	`f›í
(
_PATH_UTMP
, "r");

1661 i‡(
Â
 =
NULL
) {

1662 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1663 
îr‹
;

1666 
	`‰ód
(&
ut
, (ut), 1, 
Â
) == 1) {

1667 i‡(*
ut
.
ut_«me
 == '\0')

1669 
tu∂e
 = 
	`Py_BuûdVÆue
(

1671 
ut
.
ut_«me
,

1672 
ut
.
ut_löe
,

1673 
ut
.
ut_ho°
,

1674 ()
ut
.
ut_time
);

1675 i‡(!
tu∂e
) {

1676 
	`f˛o£
(
Â
);

1677 
îr‹
;

1679 i‡(
	`PyLi°_Aµíd
(
ªt_li°
, 
tu∂e
)) {

1680 
	`f˛o£
(
Â
);

1681 
îr‹
;

1683 
	`Py_DECREF
(
tu∂e
);

1686 
	`f˛o£
(
Â
);

1688 
utmpx
 *
utx
;

1690 (
utx
 = 
	`gëutxít
()Ë!
NULL
) {

1691 i‡(
utx
->
ut_ty≥
 !
USER_PROCESS
)

1693 
tu∂e
 = 
	`Py_BuûdVÆue
(

1695 
utx
->
ut_u£r
,

1696 
utx
->
ut_löe
,

1697 
utx
->
ut_ho°
,

1698 ()
utx
->
ut_tv
.
tv_£c


1701 i‡(!
tu∂e
) {

1702 
	`ídutxít
();

1703 
îr‹
;

1705 i‡(
	`PyLi°_Aµíd
(
ªt_li°
, 
tu∂e
)) {

1706 
	`ídutxít
();

1707 
îr‹
;

1709 
	`Py_DECREF
(
tu∂e
);

1712 
	`ídutxít
();

1714  
ªt_li°
;

1716 
îr‹
:

1717 
	`Py_XDECREF
(
tu∂e
);

1718 
	`Py_DECREF
(
ªt_li°
);

1719  
NULL
;

1720 
	}
}

1728 
	#HASHSIZE
 1009

	)

1729 
xfûe
 *
	gpsutû_xfûes
;

1730 
	gpsutû_nxfûes
;

1733 
	$psutû_p›uœã_xfûes
()

1735 
size_t
 
Àn
;

1737 i‡((
psutû_xfûes
 = 
	`mÆloc
(
Àn
 =  *psutû_xfûes)Ë=
NULL
) {

1738 
	`PyEº_NoMem‹y
();

1741 
	`sys˘lby«me
("kîn.fûe", 
psutû_xfûes
, &
Àn
, 0, 0) == -1) {

1742 i‡(
î∫o
 !
ENOMEM
) {

1743 
	`PyEº_SëFromEºno
(0);

1746 
Àn
 *= 2;

1747 i‡((
psutû_xfûes
 = 
	`ªÆloc
’sutû_xfûes, 
Àn
)Ë=
NULL
) {

1748 
	`PyEº_NoMem‹y
();

1752 i‡(
Àn
 > 0 && 
psutû_xfûes
->
xf_size
 !=  *psutil_xfiles) {

1753 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "struct xfile size mismatch");

1756 
psutû_nxfûes
 = 
Àn
 /  *
psutû_xfûes
;

1758 
	}
}

1761 
	$psutû_gë_pid_‰om_sock
(
sock_hash
)

1763 
xfûe
 *
xf
;

1764 
hash
, 
n
;

1765 
xf
 = 
psutû_xfûes
, 
n
 = 0;Ç < 
psutû_nxfûes
; ++n, ++xf) {

1766 i‡(
xf
->
xf_d©a
 =
NULL
)

1768 
hash
 = ()((
uöçå_t
)
xf
->
xf_d©a
 % 
HASHSIZE
);

1769 i‡(
sock_hash
 =
hash
) {

1770  
xf
->
xf_pid
;

1774 
	}
}

1777 
	$psutû_g©hî_öë
(
¥Ÿo
, 
PyObje˘
 *
py_ªéi°
)

1779 
xöpgí
 *
xig
, *
exig
;

1780 
xöpcb
 *
xù
;

1781 
xt˝cb
 *
xç
;

1782 
öpcb
 *
öp
;

1783 
xsockë
 *
so
;

1784 
sock
 *sock;

1785 c⁄° *
v¨«me
;

1786 
size_t
 
Àn
, 
bufsize
;

1787 *
buf
;

1788 
hash
, 
ªåy
, 
vÊag
, 
ty≥
;

1790 
PyObje˘
 *
tu∂e
 = 
NULL
;

1791 
PyObje˘
 *
œddr
 = 
NULL
;

1792 
PyObje˘
 *
øddr
 = 
NULL
;

1794 
¥Ÿo
) {

1795 
IPPROTO_TCP
:

1796 
v¨«me
 = "net.inet.tcp.pcblist";

1797 
ty≥
 = 
SOCK_STREAM
;

1799 
IPPROTO_UDP
:

1800 
v¨«me
 = "net.inet.udp.pcblist";

1801 
ty≥
 = 
SOCK_DGRAM
;

1805 
buf
 = 
NULL
;

1806 
bufsize
 = 8192;

1807 
ªåy
 = 5;

1810 
buf
 = 
	`ªÆloc
(buf, 
bufsize
);

1811 i‡(
buf
 =
NULL
) {

1815 
Àn
 = 
bufsize
;

1816 i‡(
	`sys˘lby«me
(
v¨«me
, 
buf
, &
Àn
, 
NULL
, 0) == 0)

1818 i‡(
î∫o
 !
ENOMEM
) {

1819 
	`PyEº_SëFromEºno
(0);

1820 
îr‹
;

1822 
bufsize
 *= 2;

1824 
xig
 = (
xöpgí
 *)
buf
;

1825 
exig
 = (
xöpgí
 *)(*)((*)
buf
 + 
Àn
 -  *exig);

1826 i‡(
xig
->
xig_Àn
 ! *xig || 
exig
->xig_len !=  *exig) {

1827 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "struct xinpgen size mismatch");

1828 
îr‹
;

1830 } 
xig
->
xig_gí
 !
exig
->xig_gí && 
ªåy
--);

1834 
xig
 = (
xöpgí
 *)(*)((*)xig + xig->
xig_Àn
);

1835 i‡(
xig
 >
exig
)

1838 
¥Ÿo
) {

1839 
IPPROTO_TCP
:

1840 
xç
 = (
xt˝cb
 *)
xig
;

1841 i‡(
xç
->
xt_Àn
 !=  *xtp) {

1842 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "struct xtcpcb size mismatch");

1843 
îr‹
;

1846 
IPPROTO_UDP
:

1847 
xù
 = (
xöpcb
 *)
xig
;

1848 i‡(
xù
->
xi_Àn
 !=  *xip) {

1849 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "struct xinpcb size mismatch");

1850 
îr‹
;

1852 
öp
 = &
xù
->
xi_öp
;

1853 
so
 = &
xù
->
xi_sockë
;

1857 
öp
 = &
xç
->
xt_öp
;

1858 
so
 = &
xç
->
xt_sockë
;

1859 
lù
[200], 
rù
[200];

1860 
Ámûy
, 
Õ‹t
, 
Ω‹t
, 
pid
, 
°©us
;

1862 
hash
 = ()((
uöçå_t
)
so
->
xso_so
 % 
HASHSIZE
);

1863 
pid
 = 
	`psutû_gë_pid_‰om_sock
(
hash
);

1864 i‡(
pid
 < 0)

1866 
Õ‹t
 = 
	`¡ohs
(
öp
->
öp_Õ‹t
);

1867 
Ω‹t
 = 
	`¡ohs
(
öp
->
öp_Â‹t
);

1868 
°©us
 = 
xç
->
xt_ç
.
t_°©e
;

1870 i‡(
öp
->
öp_vÊag
 & 
INP_IPV4
) {

1871 
Ámûy
 = 
AF_INET
;

1872 
	`öë_¡›
(
AF_INET
, &
öp
->
öp_œddr
.
s_addr
, 
lù
, (lip));

1873 
	`öë_¡›
(
AF_INET
, &
öp
->
öp_Áddr
.
s_addr
, 
rù
, (rip));

1875 i‡(
öp
->
öp_vÊag
 & 
INP_IPV6
) {

1876 
Ámûy
 = 
AF_INET6
;

1877 
	`öë_¡›
(
AF_INET6
, &
öp
->
ö6p_œddr
.
s6_addr
, 
lù
, (lip));

1878 
	`öë_¡›
(
AF_INET6
, &
öp
->
ö6p_Áddr
.
s6_addr
, 
rù
, (rip));

1882 
œddr
 = 
	`Py_BuûdVÆue
("(si)", 
lù
, 
Õ‹t
);

1883 i‡(!
œddr
)

1884 
îr‹
;

1885 i‡(
Ω‹t
 != 0) {

1886 
øddr
 = 
	`Py_BuûdVÆue
("(si)", 
rù
, 
Ω‹t
);

1889 
øddr
 = 
	`Py_BuûdVÆue
("()");

1891 i‡(!
øddr
)

1892 
îr‹
;

1893 
tu∂e
 = 
	`Py_BuûdVÆue
("(iiiNNii)", -1, 
Ámûy
, 
ty≥
, 
œddr
, 
øddr
,

1894 
°©us
, 
pid
);

1895 i‡(!
tu∂e
)

1896 
îr‹
;

1897 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
tu∂e
))

1898 
îr‹
;

1899 
	`Py_DECREF
(
tu∂e
);

1902 
	`‰ì
(
buf
);

1905 
îr‹
:

1906 
	`Py_XDECREF
(
tu∂e
);

1907 
	`Py_XDECREF
(
œddr
);

1908 
	`Py_XDECREF
(
øddr
);

1909 
	`‰ì
(
buf
);

1911 
	}
}

1914 
	$psutû_g©hî_unix
(
¥Ÿo
, 
PyObje˘
 *
py_ªéi°
)

1916 
xu≈gí
 *
xug
, *
exug
;

1917 
xu≈cb
 *
xup
;

1918 
sock
 *sock;

1919 c⁄° *
v¨«me
, *
¥Ÿ⁄ame
;

1920 
size_t
 
Àn
, 
bufsize
;

1921 *
buf
;

1922 
hash
, 
ªåy
;

1923 
Ámûy
, 
Õ‹t
, 
Ω‹t
, 
pid
;

1924 
sockaddr_un
 *
sun
;

1925 
∑th
[
PATH_MAX
];

1927 
PyObje˘
 *
tu∂e
 = 
NULL
;

1928 
PyObje˘
 *
œddr
 = 
NULL
;

1929 
PyObje˘
 *
øddr
 = 
NULL
;

1931 
¥Ÿo
) {

1932 
SOCK_STREAM
:

1933 
v¨«me
 = "net.local.stream.pcblist";

1934 
¥Ÿ⁄ame
 = "stream";

1936 
SOCK_DGRAM
:

1937 
v¨«me
 = "net.local.dgram.pcblist";

1938 
¥Ÿ⁄ame
 = "dgram";

1942 
buf
 = 
NULL
;

1943 
bufsize
 = 8192;

1944 
ªåy
 = 5;

1948 
buf
 = 
	`ªÆloc
(buf, 
bufsize
);

1949 i‡(
buf
 =
NULL
) {

1950 
	`PyEº_NoMem‹y
();

1951 
îr‹
;

1953 
Àn
 = 
bufsize
;

1954 i‡(
	`sys˘lby«me
(
v¨«me
, 
buf
, &
Àn
, 
NULL
, 0) == 0)

1956 i‡(
î∫o
 !
ENOMEM
) {

1957 
	`PyEº_SëFromEºno
(0);

1958 
îr‹
;

1960 
bufsize
 *= 2;

1962 
xug
 = (
xu≈gí
 *)
buf
;

1963 
exug
 = (
xu≈gí
 *)(*)

1964 ((*)
buf
 + 
Àn
 -  *
exug
);

1965 i‡(
xug
->
xug_Àn
 ! *xug || 
exug
->xug_len !=  *exug) {

1966 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "struct xinpgen size mismatch");

1967 
îr‹
;

1969 } 
xug
->
xug_gí
 !
exug
->xug_gí && 
ªåy
--);

1972 
xug
 = (
xu≈gí
 *)(*)((*)xug + xug->
xug_Àn
);

1973 i‡(
xug
 >
exug
)

1975 
xup
 = (
xu≈cb
 *)
xug
;

1976 i‡(
xup
->
xu_Àn
 !=  *xup) {

1977 
	`w¨nx
("struct xunpgen size mismatch");

1978 
îr‹
;

1981 
hash
 = ()((
uöçå_t
Ë
xup
->
xu_sockë
.
xso_so
 % 
HASHSIZE
);

1982 
pid
 = 
	`psutû_gë_pid_‰om_sock
(
hash
);

1983 i‡(
pid
 < 0)

1986 
sun
 = (
sockaddr_un
 *)&
xup
->
xu_addr
;

1987 
	`¢¥ötf
(
∑th
, (path), "%.*s",

1988 (
sun
->
sun_Àn
 - ((*sunË- (sun->
sun_∑th
))),

1989 
sun
->
sun_∑th
);

1991 
tu∂e
 = 
	`Py_BuûdVÆue
("(iiisOii)", -1, 
AF_UNIX
, 
¥Ÿo
, 
∑th
, 
Py_N⁄e
,

1992 
PSUTIL_CONN_NONE
, 
pid
);

1993 i‡(!
tu∂e
)

1994 
îr‹
;

1995 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
tu∂e
))

1996 
îr‹
;

1997 
	`Py_DECREF
(
tu∂e
);

1998 
	`Py_INCREF
(
Py_N⁄e
);

2001 
	`‰ì
(
buf
);

2004 
îr‹
:

2005 
	`Py_XDECREF
(
tu∂e
);

2006 
	`Py_XDECREF
(
œddr
);

2007 
	`Py_XDECREF
(
øddr
);

2008 
	`‰ì
(
buf
);

2010 
	}
}

2016 
PyObje˘
*

2017 
	$psutû_√t_c⁄√˘i⁄s
(
PyObje˘
* 
£lf
, PyObje˘* 
¨gs
)

2019 
PyObje˘
 *
af_fûãr
 = 
NULL
;

2020 
PyObje˘
 *
ty≥_fûãr
 = 
NULL
;

2021 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

2023 i‡(
	`psutû_p›uœã_xfûes
() != 1)

2024 
îr‹
;

2026 i‡(
	`psutû_g©hî_öë
(
IPPROTO_TCP
, 
py_ªéi°
) == 0)

2027 
îr‹
;

2028 i‡(
	`psutû_g©hî_öë
(
IPPROTO_UDP
, 
py_ªéi°
) == 0)

2029 
îr‹
;

2030 i‡(
	`psutû_g©hî_unix
(
SOCK_STREAM
, 
py_ªéi°
) == 0)

2031 
îr‹
;

2032 i‡(
	`psutû_g©hî_unix
(
SOCK_DGRAM
, 
py_ªéi°
) == 0)

2033 
îr‹
;

2035 
	`‰ì
(
psutû_xfûes
);

2036  
py_ªéi°
;

2038 
îr‹
:

2039 
	`Py_DECREF
(
py_ªéi°
);

2040 
	`‰ì
(
psutû_xfûes
);

2041  
NULL
;

2042 
	}
}

2048 
PyMëhodDef


2049 
	gPsutûMëhods
[] =

2053 {"¥oc_«me", 
psutû_¥oc_«me
, 
METH_VARARGS
,

2055 {"¥oc_c⁄√˘i⁄s", 
psutû_¥oc_c⁄√˘i⁄s
, 
METH_VARARGS
,

2057 {"¥oc_exe", 
psutû_¥oc_exe
, 
METH_VARARGS
,

2059 {"¥oc_cmdlöe", 
psutû_¥oc_cmdlöe
, 
METH_VARARGS
,

2061 {"¥oc_µid", 
psutû_¥oc_µid
, 
METH_VARARGS
,

2063 {"¥oc_uids", 
psutû_¥oc_uids
, 
METH_VARARGS
,

2065 {"¥oc_gids", 
psutû_¥oc_gids
, 
METH_VARARGS
,

2067 {"¥oc_˝u_times", 
psutû_¥oc_˝u_times
, 
METH_VARARGS
,

2069 {"¥oc_¸óã_time", 
psutû_¥oc_¸óã_time
, 
METH_VARARGS
,

2072 {"¥oc_mem‹y_öfo", 
psutû_¥oc_mem‹y_öfo
, 
METH_VARARGS
,

2074 {"¥oc_num_thªads", 
psutû_¥oc_num_thªads
, 
METH_VARARGS
,

2076 {"¥oc_num_˘x_swôches", 
psutû_¥oc_num_˘x_swôches
, 
METH_VARARGS
,

2078 {"¥oc_thªads", 
psutû_¥oc_thªads
, 
METH_VARARGS
,

2080 {"¥oc_°©us", 
psutû_¥oc_°©us
, 
METH_VARARGS
,

2082 {"¥oc_io_cou¡îs", 
psutû_¥oc_io_cou¡îs
, 
METH_VARARGS
,

2084 {"¥oc_ây_ƒ", 
psutû_¥oc_ây_ƒ
, 
METH_VARARGS
,

2086 #i‡
deföed
(
__FªeBSD_vîsi⁄
) && __FreeBSD_version >= 800000

2087 {"¥oc_›í_fûes", 
psutû_¥oc_›í_fûes
, 
METH_VARARGS
,

2089 {"¥oc_cwd", 
psutû_¥oc_cwd
, 
METH_VARARGS
,

2091 {"¥oc_mem‹y_m≠s", 
psutû_¥oc_mem‹y_m≠s
, 
METH_VARARGS
,

2093 {"¥oc_num_fds", 
psutû_¥oc_num_fds
, 
METH_VARARGS
,

2099 {"pids", 
psutû_pids
, 
METH_VARARGS
,

2101 {"˝u_cou¡_logiˇl", 
psutû_˝u_cou¡_logiˇl
, 
METH_VARARGS
,

2103 {"˝u_cou¡_phys", 
psutû_˝u_cou¡_phys
, 
METH_VARARGS
,

2105 {"vútuÆ_mem", 
psutû_vútuÆ_mem
, 
METH_VARARGS
,

2107 {"sw≠_mem", 
psutû_sw≠_mem
, 
METH_VARARGS
,

2109 {"˝u_times", 
psutû_˝u_times
, 
METH_VARARGS
,

2111 #i‡
deföed
(
__FªeBSD_vîsi⁄
) && __FreeBSD_version >= 800000

2112 {"≥r_˝u_times", 
psutû_≥r_˝u_times
, 
METH_VARARGS
,

2115 {"boŸ_time", 
psutû_boŸ_time
, 
METH_VARARGS
,

2117 {"disk_∑πôi⁄s", 
psutû_disk_∑πôi⁄s
, 
METH_VARARGS
,

2120 {"√t_io_cou¡îs", 
psutû_√t_io_cou¡îs
, 
METH_VARARGS
,

2122 {"disk_io_cou¡îs", 
psutû_disk_io_cou¡îs
, 
METH_VARARGS
,

2124 {"u£rs", 
psutû_u£rs
, 
METH_VARARGS
,

2126 {"√t_c⁄√˘i⁄s", 
psutû_√t_c⁄√˘i⁄s
, 
METH_VARARGS
,

2129 {
NULL
, NULL, 0, NULL}

2132 
	smoduÀ_°©e
 {

2133 
PyObje˘
 *
	mîr‹
;

2136 #i‡
PY_MAJOR_VERSION
 >= 3

2137 
	#GETSTATE
(
m
Ë((
moduÀ_°©e
*)
	`PyModuÀ_GëSèã
(m))

	)

2139 
	#GETSTATE
(
m
Ë(&
_°©e
)

	)

2142 #i‡
PY_MAJOR_VERSION
 >= 3

2145 
	$psutû_bsd_åavî£
(
PyObje˘
 *
m
, 
visô¥oc
 
visô
, *
¨g
) {

2146 
	`Py_VISIT
(
	`GETSTATE
(
m
)->
îr‹
);

2148 
	}
}

2151 
	$psutû_bsd_˛ór
(
PyObje˘
 *
m
) {

2152 
	`Py_CLEAR
(
	`GETSTATE
(
m
)->
îr‹
);

2154 
	}
}

2156 
PyModuÀDef


2157 
	gmoduÀdef
 = {

2158 
PyModuÀDef_HEAD_INIT
,

2160 
NULL
,

2161 (
moduÀ_°©e
),

2162 
PsutûMëhods
,

2163 
NULL
,

2164 
psutû_bsd_åavî£
,

2165 
psutû_bsd_˛ór
,

2166 
NULL


2169 
	#INITERROR
  
NULL


	)

2171 
PyMODINIT_FUNC
 
	$PyInô__psutû_bsd
()

2174 
	#INITERROR
 

	)

2176 
	$öô_psutû_bsd
()

2179 #i‡
PY_MAJOR_VERSION
 >= 3

2180 
PyObje˘
 *
moduÀ
 = 
	`PyModuÀ_Cª©e
(&
moduÀdef
);

2182 
PyObje˘
 *
moduÀ
 = 
	`Py_InôModuÀ
("_psutû_bsd", 
PsutûMëhods
);

2185 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SSTOP", 
SSTOP
);

2186 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SSLEEP", 
SSLEEP
);

2187 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SRUN", 
SRUN
);

2188 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SIDL", 
SIDL
);

2189 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SWAIT", 
SWAIT
);

2190 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SLOCK", 
SLOCK
);

2191 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SZOMB", 
SZOMB
);

2193 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSED", 
TCPS_CLOSED
);

2194 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSING", 
TCPS_CLOSING
);

2195 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSE_WAIT", 
TCPS_CLOSE_WAIT
);

2196 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_LISTEN", 
TCPS_LISTEN
);

2197 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_ESTABLISHED", 
TCPS_ESTABLISHED
);

2198 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_SYN_SENT", 
TCPS_SYN_SENT
);

2199 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_SYN_RECEIVED", 
TCPS_SYN_RECEIVED
);

2200 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_FIN_WAIT_1", 
TCPS_FIN_WAIT_1
);

2201 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_FIN_WAIT_2", 
TCPS_FIN_WAIT_2
);

2202 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_LAST_ACK", 
TCPS_LAST_ACK
);

2203 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_TIME_WAIT", 
TCPS_TIME_WAIT
);

2204 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "PSUTIL_CONN_NONE", 
PSUTIL_CONN_NONE
);

2206 i‡(
moduÀ
 =
NULL
) {

2207 
INITERROR
;

2209 #i‡
PY_MAJOR_VERSION
 >= 3

2210  
moduÀ
;

2212 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_bsd.h

7 
	~<Pyth⁄.h
>

11 
PyObje˘
* 
psutû_¥oc_cmdlöe
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

12 
PyObje˘
* 
psutû_¥oc_c⁄√˘i⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

13 
PyObje˘
* 
psutû_¥oc_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

14 
PyObje˘
* 
psutû_¥oc_¸óã_time
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

15 
PyObje˘
* 
psutû_¥oc_exe
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

16 
PyObje˘
* 
psutû_¥oc_gids
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

17 
PyObje˘
* 
psutû_¥oc_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

18 
PyObje˘
* 
psutû_¥oc_mem‹y_öfo
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

19 
PyObje˘
* 
psutû_¥oc_mem‹y_m≠s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

20 
PyObje˘
* 
psutû_¥oc_«me
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

21 
PyObje˘
* 
psutû_¥oc_num_˘x_swôches
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

22 
PyObje˘
* 
psutû_¥oc_num_fds
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

23 
PyObje˘
* 
psutû_¥oc_num_thªads
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

24 
PyObje˘
* 
psutû_¥oc_µid
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

25 
PyObje˘
* 
psutû_¥oc_°©us
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

26 
PyObje˘
* 
psutû_¥oc_thªads
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

27 
PyObje˘
* 
psutû_¥oc_ây_ƒ
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

28 
PyObje˘
* 
psutû_¥oc_uids
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

30 #i‡
deföed
(
__FªeBSD_vîsi⁄
) && __FreeBSD_version >= 800000

31 
PyObje˘
* 
psutû_¥oc_›í_fûes
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

32 
PyObje˘
* 
psutû_¥oc_cwd
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

37 
PyObje˘
* 
psutû_boŸ_time
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

38 
PyObje˘
* 
psutû_˝u_cou¡_logiˇl
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

39 
PyObje˘
* 
psutû_˝u_cou¡_phys
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

40 
PyObje˘
* 
psutû_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

41 
PyObje˘
* 
psutû_disk_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

42 
PyObje˘
* 
psutû_disk_∑πôi⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

43 
PyObje˘
* 
psutû_√t_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

44 
PyObje˘
* 
psutû_pids
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

45 
PyObje˘
* 
psutû_sw≠_mem
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

46 
PyObje˘
* 
psutû_u£rs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

47 
PyObje˘
* 
psutû_vútuÆ_mem
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

49 #i‡
deföed
(
__FªeBSD_vîsi⁄
) && __FreeBSD_version >= 800000

50 
PyObje˘
* 
psutû_≥r_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_common.c

9 
	~<Pyth⁄.h
>

15 
PyObje˘
 *

16 
	$NoSuchPro˚ss
() {

17 
PyObje˘
 *
exc
;

18 *
msg
 = 
	`°ªº‹
(
ESRCH
);

19 
exc
 = 
	`PyObje˘_CÆlFun˘i⁄
(
PyExc_OSEº‹
, "(is)", 
ESRCH
, 
msg
);

20 
	`PyEº_SëObje˘
(
PyExc_OSEº‹
, 
exc
);

21 
	`Py_XDECREF
(
exc
);

22  
NULL
;

23 
	}
}

29 
PyObje˘
 *

30 
	$Ac˚ssDíõd
() {

31 
PyObje˘
 *
exc
;

32 *
msg
 = 
	`°ªº‹
(
EACCES
);

33 
exc
 = 
	`PyObje˘_CÆlFun˘i⁄
(
PyExc_OSEº‹
, "(is)", 
EACCES
, 
msg
);

34 
	`PyEº_SëObje˘
(
PyExc_OSEº‹
, 
exc
);

35 
	`Py_XDECREF
(
exc
);

36  
NULL
;

37 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_common.h

7 
	~<Pyth⁄.h
>

9 
PyObje˘
* 
Ac˚ssDíõd
();

10 
PyObje˘
* 
NoSuchPro˚ss
();

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_linux.c

9 #i‚de‡
_GNU_SOURCE


10 
	#_GNU_SOURCE
 1

	)

12 
	~<Pyth⁄.h
>

13 
	~<î∫o.h
>

14 
	~<°dlib.h
>

15 
	~<m¡ít.h
>

16 
	~<„©uªs.h
>

17 
	~<utmp.h
>

18 
	~<sched.h
>

19 
	~<löux/vîsi⁄.h
>

20 
	~<sys/sysˇŒ.h
>

21 
	~<sys/sysöfo.h
>

23 
	~"_psutû_löux.h
"

27 
	#PSUTIL_HAVE_IOPRIO
 
	`deföed
(
__NR_i›rio_gë
Ë&& deföed(
__NR_i›rio_£t
)

	)

30 
	#PSUTIL_HAVE_PRLIMIT
 \

31 (
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2, 6, 36)) && \

32 (
__GLIBC__
 >2 && 
__GLIBC_MINOR__
 >= 13) && \

33 
	`deföed
(
__NR_¥limô64
)

	)

35 #i‡
PSUTIL_HAVE_PRLIMIT


36 
	#_FILE_OFFSET_BITS
 64

	)

37 
	~<time.h
>

38 
	~<sys/ªsour˚.h
>

42 #i‡
PSUTIL_HAVE_IOPRIO


44 
	mIOPRIO_WHO_PROCESS
 = 1,

47 
ölöe
 

48 
	$i›rio_gë
(
which
, 
who
)

50  
	`sysˇŒ
(
__NR_i›rio_gë
, 
which
, 
who
);

51 
	}
}

53 
ölöe
 

54 
	$i›rio_£t
(
which
, 
who
, 
i›rio
)

56  
	`sysˇŒ
(
__NR_i›rio_£t
, 
which
, 
who
, 
i›rio
);

57 
	}
}

59 
	#IOPRIO_CLASS_SHIFT
 13

	)

60 
	#IOPRIO_PRIO_MASK
 ((1UL << 
IOPRIO_CLASS_SHIFT
Ë- 1)

	)

62 
	#IOPRIO_PRIO_CLASS
(
mask
Ë((maskË>> 
IOPRIO_CLASS_SHIFT
)

	)

63 
	#IOPRIO_PRIO_DATA
(
mask
Ë((maskË& 
IOPRIO_PRIO_MASK
)

	)

64 
	#IOPRIO_PRIO_VALUE
(
˛ass
, 
d©a
Ë(((˛assË<< 
IOPRIO_CLASS_SHIFT
Ë| d©a)

	)

70 
PyObje˘
 *

71 
	$psutû_¥oc_i›rio_gë
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

73 
pid
;

74 
i›rio
, 
io˛ass
, 
iod©a
;

75 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

76  
NULL
;

78 
i›rio
 = 
	`i›rio_gë
(
IOPRIO_WHO_PROCESS
, 
pid
);

79 i‡(
i›rio
 == -1) {

80  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

82 
io˛ass
 = 
	`IOPRIO_PRIO_CLASS
(
i›rio
);

83 
iod©a
 = 
	`IOPRIO_PRIO_DATA
(
i›rio
);

84  
	`Py_BuûdVÆue
("ii", 
io˛ass
, 
iod©a
);

85 
	}
}

93 
PyObje˘
 *

94 
	$psutû_¥oc_i›rio_£t
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

96 
pid
;

97 
i›rio
, 
io˛ass
, 
iod©a
;

98 
ªtvÆ
;

100 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "lii", &
pid
, &
io˛ass
, &
iod©a
)) {

101  
NULL
;

103 
i›rio
 = 
	`IOPRIO_PRIO_VALUE
(
io˛ass
, 
iod©a
);

104 
ªtvÆ
 = 
	`i›rio_£t
(
IOPRIO_WHO_PROCESS
, 
pid
, 
i›rio
);

105 i‡(
ªtvÆ
 == -1) {

106  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

108 
	`Py_INCREF
(
Py_N⁄e
);

109  
Py_N⁄e
;

110 
	}
}

114 #i‡
PSUTIL_HAVE_PRLIMIT


120 
PyObje˘
 *

121 
	$psutû_löux_¥limô
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

123 
pid
;

124 
ªt
, 
ªsour˚
;

125 
æimô
 
ﬁd
, 
√w
;

126 
æimô
 *
√wp
 = 
NULL
;

127 
PyObje˘
 *
so·
 = 
NULL
;

128 
PyObje˘
 *
h¨d
 = 
NULL
;

130 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "li|OO", &
pid
, &
ªsour˚
, &
so·
, &
h¨d
)) {

131  
NULL
;

135 i‡(
so·
 =
NULL
 && 
h¨d
 == NULL) {

136 
ªt
 = 
	`¥limô
(
pid
, 
ªsour˚
, 
NULL
, &
ﬁd
);

137 i‡(
ªt
 == -1)

138  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

139 #i‡
	`deföed
(
PSUTIL_HAVE_LONG_LONG
)

140 i‡((
ﬁd
.
æim_cur
) > ()) {

141  
	`Py_BuûdVÆue
("LL",

142 (
PY_LONG_LONG
)
ﬁd
.
æim_cur
,

143 (
PY_LONG_LONG
)
ﬁd
.
æim_max
);

146  
	`Py_BuûdVÆue
("Œ", ()
ﬁd
.
æim_cur
, ()ﬁd.
æim_max
);

151 #i‡
	`deföed
(
PSUTIL_HAVE_LARGEFILE_SUPPORT
)

152 
√w
.
æim_cur
 = 
	`PyL⁄g_AsL⁄gL⁄g
(
so·
);

153 i‡(
√w
.
æim_cur
 =(
æim_t
Ë- 1 && 
	`PyEº_Occuºed
())

154  
NULL
;

155 
√w
.
æim_max
 = 
	`PyL⁄g_AsL⁄gL⁄g
(
h¨d
);

156 i‡(
√w
.
æim_max
 =(
æim_t
Ë- 1 && 
	`PyEº_Occuºed
())

157  
NULL
;

159 
√w
.
æim_cur
 = 
	`PyL⁄g_AsL⁄g
(
so·
);

160 i‡(
√w
.
æim_cur
 =(
æim_t
Ë- 1 && 
	`PyEº_Occuºed
())

161  
NULL
;

162 
√w
.
æim_max
 = 
	`PyL⁄g_AsL⁄g
(
h¨d
);

163 i‡(
√w
.
æim_max
 =(
æim_t
Ë- 1 && 
	`PyEº_Occuºed
())

164  
NULL
;

166 
√wp
 = &
√w
;

167 
ªt
 = 
	`¥limô
(
pid
, 
ªsour˚
, 
√wp
, &
ﬁd
);

168 i‡(
ªt
 == -1)

169  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

170 
	`Py_INCREF
(
Py_N⁄e
);

171  
Py_N⁄e
;

173 
	}
}

181 
PyObje˘
 *

182 
	$psutû_disk_∑πôi⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

184 
FILE
 *
fûe
 = 
NULL
;

185 
m¡ít
 *
íåy
;

186 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

187 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

189 i‡(
py_ªéi°
 =
NULL
)

190  
NULL
;

193 
Py_BEGIN_ALLOW_THREADS


194 
fûe
 = 
	`£tm¡ít
(
MOUNTED
, "r");

195 
Py_END_ALLOW_THREADS


196 i‡((
fûe
 =0Ë|| (fûê=
NULL
)) {

197 
	`PyEº_SëFromEºnoWôhFûíame
(
PyExc_OSEº‹
, 
MOUNTED
);

198 
îr‹
;

201 (
íåy
 = 
	`gëm¡ít
(
fûe
))) {

202 i‡(
íåy
 =
NULL
) {

203 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "getmntent() failed");

204 
îr‹
;

206 
py_tu∂e
 = 
	`Py_BuûdVÆue
("(ssss)",

207 
íåy
->
m¡_f¢ame
,

208 
íåy
->
m¡_dú
,

209 
íåy
->
m¡_ty≥
,

210 
íåy
->
m¡_›ts
);

211 i‡(! 
py_tu∂e
)

212 
îr‹
;

213 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

214 
îr‹
;

215 
	`Py_DECREF
(
py_tu∂e
);

217 
	`ídm¡ít
(
fûe
);

218  
py_ªéi°
;

220 
îr‹
:

221 i‡(
fûe
 !
NULL
)

222 
	`ídm¡ít
(
fûe
);

223 
	`Py_XDECREF
(
py_tu∂e
);

224 
	`Py_DECREF
(
py_ªéi°
);

225  
NULL
;

226 
	}
}

232 
PyObje˘
 *

233 
	$psutû_löux_sysöfo
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

235 
sysöfo
 
öfo
;

236 i‡(
	`sysöfo
(&
öfo
) != 0) {

237  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

241  
	`Py_BuûdVÆue
(

243 ()
öfo
.
tŸÆøm
 * info.
mem_unô
,

244 ()
öfo
.
‰ìøm
 * info.
mem_unô
,

245 ()
öfo
.
buf„ºam
 * info.
mem_unô
,

246 ()
öfo
.
sh¨edøm
 * info.
mem_unô
,

247 ()
öfo
.
tŸÆsw≠
 * info.
mem_unô
,

248 ()
öfo
.
‰ìsw≠
 * info.
mem_unô
);

249 
	}
}

255 
PyObje˘
 *

256 
	$psutû_¥oc_˝u_afföôy_gë
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

258 
mask
;

259 
Àn
 = (
mask
);

260 
pid
;

262 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
)) {

263  
NULL
;

265 i‡(
	`sched_gëafföôy
(
pid
, 
Àn
, (
˝u_£t_t
 *)&
mask
) < 0) {

266  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

268  
	`Py_BuûdVÆue
("l", 
mask
);

269 
	}
}

275 
PyObje˘
 *

276 
	$psutû_¥oc_˝u_afföôy_£t
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

278 
˝u_£t_t
 
˝u_£t
;

279 
size_t
 
Àn
;

280 
pid
;

281 
i
, 
£q_Àn
;

282 
PyObje˘
 *
py_˝u_£t
;

283 
PyObje˘
 *
py_˝u_£q
 = 
NULL
;

285 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "lO", &
pid
, &
py_˝u_£t
)) {

286 
îr‹
;

289 i‡(!
	`PySequí˚_Check
(
py_˝u_£t
)) {

293 
	`PyEº_F‹m©
(
PyExc_Ty≥Eº‹
, "sequenceárgumentÉxpected");

294 
îr‹
;

297 
py_˝u_£q
 = 
	`PySequí˚_Fa°
(
py_˝u_£t
, "expectedá sequence or integer");

298 i‡(!
py_˝u_£q
) {

299 
îr‹
;

301 
£q_Àn
 = 
	`PySequí˚_Fa°_GET_SIZE
(
py_˝u_£q
);

302 
	`CPU_ZERO
(&
˝u_£t
);

303 
i
 = 0; i < 
£q_Àn
; i++) {

304 
PyObje˘
 *
ôem
 = 
	`PySequí˚_Fa°_GET_ITEM
(
py_˝u_£q
, 
i
);

305 #i‡
PY_MAJOR_VERSION
 >= 3

306 
vÆue
 = 
	`PyL⁄g_AsL⁄g
(
ôem
);

308 
vÆue
 = 
	`PyI¡_AsL⁄g
(
ôem
);

310 i‡(
vÆue
 =-1 && 
	`PyEº_Occuºed
()) {

311 
îr‹
;

313 
	`CPU_SET
(
vÆue
, &
˝u_£t
);

316 
Àn
 = (
˝u_£t
);

317 i‡(
	`sched_£èfföôy
(
pid
, 
Àn
, &
˝u_£t
)) {

318 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

319 
îr‹
;

322 
	`Py_DECREF
(
py_˝u_£q
);

323 
	`Py_INCREF
(
Py_N⁄e
);

324  
Py_N⁄e
;

326 
îr‹
:

327 i‡(
py_˝u_£q
 !
NULL
)

328 
	`Py_DECREF
(
py_˝u_£q
);

329  
NULL
;

330 
	}
}

336 
PyObje˘
 *

337 
	$psutû_u£rs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

339 
PyObje˘
 *
ªt_li°
 = 
	`PyLi°_New
(0);

340 
PyObje˘
 *
tu∂e
 = 
NULL
;

341 
PyObje˘
 *
u£r_¥oc
 = 
NULL
;

342 
utmp
 *
ut
;

344 i‡(
ªt_li°
 =
NULL
)

345  
NULL
;

346 
	`£tuã¡
();

347 
NULL
 !(
ut
 = 
	`gëuã¡
())) {

348 
tu∂e
 = 
NULL
;

349 
u£r_¥oc
 = 
NULL
;

350 i‡(
ut
->
ut_ty≥
 =
USER_PROCESS
)

351 
u£r_¥oc
 = 
Py_True
;

353 
u£r_¥oc
 = 
Py_FÆ£
;

354 
tu∂e
 = 
	`Py_BuûdVÆue
(

356 
ut
->
ut_u£r
,

357 
ut
->
ut_löe
,

358 
ut
->
ut_ho°
,

359 ()
ut
->
ut_tv
.
tv_£c
,

360 
u£r_¥oc


362 i‡(! 
tu∂e
)

363 
îr‹
;

364 i‡(
	`PyLi°_Aµíd
(
ªt_li°
, 
tu∂e
))

365 
îr‹
;

366 
	`Py_DECREF
(
tu∂e
);

368 
	`íduã¡
();

369  
ªt_li°
;

371 
îr‹
:

372 
	`Py_XDECREF
(
tu∂e
);

373 
	`Py_XDECREF
(
u£r_¥oc
);

374 
	`Py_DECREF
(
ªt_li°
);

375 
	`íduã¡
();

376  
NULL
;

377 
	}
}

383 
PyMëhodDef


384 
	gPsutûMëhods
[] =

388 #i‡
PSUTIL_HAVE_IOPRIO


389 {"¥oc_i›rio_gë", 
psutû_¥oc_i›rio_gë
, 
METH_VARARGS
,

391 {"¥oc_i›rio_£t", 
psutû_¥oc_i›rio_£t
, 
METH_VARARGS
,

394 {"¥oc_˝u_afföôy_gë", 
psutû_¥oc_˝u_afföôy_gë
, 
METH_VARARGS
,

396 {"¥oc_˝u_afföôy_£t", 
psutû_¥oc_˝u_afföôy_£t
, 
METH_VARARGS
,

401 {"disk_∑πôi⁄s", 
psutû_disk_∑πôi⁄s
, 
METH_VARARGS
,

404 {"u£rs", 
psutû_u£rs
, 
METH_VARARGS
,

409 {"löux_sysöfo", 
psutû_löux_sysöfo
, 
METH_VARARGS
,

411 #i‡
PSUTIL_HAVE_PRLIMIT


412 {"löux_¥limô", 
psutû_löux_¥limô
, 
METH_VARARGS
,

417 {
NULL
, NULL, 0, NULL}

420 
	smoduÀ_°©e
 {

421 
PyObje˘
 *
	mîr‹
;

424 #i‡
PY_MAJOR_VERSION
 >= 3

425 
	#GETSTATE
(
m
Ë((
moduÀ_°©e
*)
	`PyModuÀ_GëSèã
(m))

	)

427 
	#GETSTATE
(
m
Ë(&
_°©e
)

	)

430 #i‡
PY_MAJOR_VERSION
 >= 3

433 
	$psutû_löux_åavî£
(
PyObje˘
 *
m
, 
visô¥oc
 
visô
, *
¨g
) {

434 
	`Py_VISIT
(
	`GETSTATE
(
m
)->
îr‹
);

436 
	}
}

439 
	$psutû_löux_˛ór
(
PyObje˘
 *
m
) {

440 
	`Py_CLEAR
(
	`GETSTATE
(
m
)->
îr‹
);

442 
	}
}

444 
PyModuÀDef


445 
	gmoduÀdef
 = {

446 
PyModuÀDef_HEAD_INIT
,

448 
NULL
,

449 (
moduÀ_°©e
),

450 
PsutûMëhods
,

451 
NULL
,

452 
psutû_löux_åavî£
,

453 
psutû_löux_˛ór
,

454 
NULL


457 
	#INITERROR
  
NULL


	)

459 
PyMODINIT_FUNC
 
	$PyInô__psutû_löux
()

462 
	#INITERROR
 

	)

464 
	$öô_psutû_löux
()

467 #i‡
PY_MAJOR_VERSION
 >= 3

468 
PyObje˘
 *
moduÀ
 = 
	`PyModuÀ_Cª©e
(&
moduÀdef
);

470 
PyObje˘
 *
moduÀ
 = 
	`Py_InôModuÀ
("_psutû_löux", 
PsutûMëhods
);

474 #i‡
PSUTIL_HAVE_PRLIMIT


475 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIM_INFINITY", 
RLIM_INFINITY
);

476 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_AS", 
RLIMIT_AS
);

477 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_CORE", 
RLIMIT_CORE
);

478 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_CPU", 
RLIMIT_CPU
);

479 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_DATA", 
RLIMIT_DATA
);

480 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_FSIZE", 
RLIMIT_FSIZE
);

481 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_LOCKS", 
RLIMIT_LOCKS
);

482 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_MEMLOCK", 
RLIMIT_MEMLOCK
);

483 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_NOFILE", 
RLIMIT_NOFILE
);

484 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_NPROC", 
RLIMIT_NPROC
);

485 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_RSS", 
RLIMIT_RSS
);

486 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_STACK", 
RLIMIT_STACK
);

487 #ifde‡
RLIMIT_MSGQUEUE


488 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_MSGQUEUE", 
RLIMIT_MSGQUEUE
);

490 #ifde‡
RLIMIT_NICE


491 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_NICE", 
RLIMIT_NICE
);

493 #ifde‡
RLIMIT_RTPRIO


494 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_RTPRIO", 
RLIMIT_RTPRIO
);

496 #ifde‡
RLIMIT_RTTIME


497 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_RTTIME", 
RLIMIT_RTTIME
);

499 #ifde‡
RLIMIT_SIGPENDING


500 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "RLIMIT_SIGPENDING", 
RLIMIT_SIGPENDING
);

504 i‡(
moduÀ
 =
NULL
) {

505 
INITERROR
;

507 #i‡
PY_MAJOR_VERSION
 >= 3

508  
moduÀ
;

510 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_linux.h

7 
	~<Pyth⁄.h
>

11 
PyObje˘
* 
psutû_¥oc_˝u_afföôy_gë
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

12 
PyObje˘
* 
psutû_¥oc_˝u_afföôy_£t
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

13 
PyObje˘
* 
psutû_¥oc_i›rio_gë
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

14 
PyObje˘
* 
psutû_¥oc_i›rio_gë
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

18 
PyObje˘
* 
psutû_disk_∑πôi⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

19 
PyObje˘
* 
psutû_löux_sysöfo
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

20 
PyObje˘
* 
psutû_u£rs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_osx.c

9 
	~<Pyth⁄.h
>

10 
	~<as£π.h
>

11 
	~<î∫o.h
>

12 
	~<°dboﬁ.h
>

13 
	~<°dlib.h
>

14 
	~<°dio.h
>

15 
	~<utmpx.h
>

16 
	~<sys/sys˘l.h
>

17 
	~<sys/vmmëî.h
>

18 
	~<lib¥oc.h
>

19 
	~<sys/¥oc_öfo.h
>

20 
	~<√töë/t˝_fsm.h
>

21 
	~<¨∑/öë.h
>

22 
	~<√t/if_dl.h
>

23 
	~<pwd.h
>

25 
	~<mach/mach.h
>

26 
	~<mach/èsk.h
>

27 
	~<mach/mach_öô.h
>

28 
	~<mach/ho°_öfo.h
>

29 
	~<mach/mach_ho°.h
>

30 
	~<mach/mach_å≠s.h
>

31 
	~<mach/mach_vm.h
>

32 
	~<mach/sh¨ed_ªgi⁄.h
>

34 
	~<mach-o/lﬂdî.h
>

36 
	~<C‹eFound©i⁄/C‹eFound©i⁄.h
>

37 
	~<IOKô/IOKôLib.h
>

38 
	~<IOKô/°‹age/IOBlockSt‹ageDrivî.h
>

39 
	~<IOKô/°‹age/IOMedü.h
>

40 
	~<IOKô/IOBSD.h
>

42 
	~"_psutû_osx.h
"

43 
	~"_psutû_comm⁄.h
"

44 
	~"¨ch/osx/¥o˚ss_öfo.h
"

51 
	$psutû_sys_vmöfo
(
vm_°©i°ics_d©a_t
 *
vm°©
)

53 
kîn_ªtu∫_t
 
ªt
;

54 
mach_msg_ty≥_numbî_t
 
cou¡
 = (*
vm°©
Ë/ (
öãgî_t
);

55 
mach_p‹t_t
 
mp‹t
 = 
	`mach_ho°_£lf
();

57 
ªt
 = 
	`ho°_°©i°ics
(
mp‹t
, 
HOST_VM_INFO
, (
ho°_öfo_t
)
vm°©
, &
cou¡
);

58 i‡(
ªt
 !
KERN_SUCCESS
) {

59 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

60 "ho°_°©i°ics(ËÁûed: %s", 
	`mach_îr‹_°rög
(
ªt
));

63 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
mp‹t
);

65 
	}
}

71 
PyObje˘
 *

72 
	$psutû_pids
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

74 
köfo_¥oc
 *
¥o˛i°
 = 
NULL
;

75 
köfo_¥oc
 *
‹ig_addªss
 = 
NULL
;

76 
size_t
 
num_¥o˚s£s
;

77 
size_t
 
idx
;

78 
PyObje˘
 *
pid
 = 
NULL
;

79 
PyObje˘
 *
ªéi°
 = 
	`PyLi°_New
(0);

81 i‡(
ªéi°
 =
NULL
)

82  
NULL
;

84 i‡(
	`psutû_gë_¥oc_li°
(&
¥o˛i°
, &
num_¥o˚s£s
) != 0) {

85 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

87 
îr‹
;

90 i‡(
num_¥o˚s£s
 > 0) {

92 
‹ig_addªss
 = 
¥o˛i°
;

93 
idx
 = 0; idx < 
num_¥o˚s£s
; idx++) {

94 
pid
 = 
	`Py_BuûdVÆue
("i", 
¥o˛i°
->
kp_¥oc
.
p_pid
);

95 i‡(!
pid
)

96 
îr‹
;

97 i‡(
	`PyLi°_Aµíd
(
ªéi°
, 
pid
))

98 
îr‹
;

99 
	`Py_DECREF
(
pid
);

100 
¥o˛i°
++;

102 
	`‰ì
(
‹ig_addªss
);

104  
ªéi°
;

106 
îr‹
:

107 
	`Py_XDECREF
(
pid
);

108 
	`Py_DECREF
(
ªéi°
);

109 i‡(
‹ig_addªss
 !
NULL
)

110 
	`‰ì
(
‹ig_addªss
);

111  
NULL
;

112 
	}
}

118 
PyObje˘
 *

119 
	$psutû_¥oc_«me
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

121 
pid
;

122 
köfo_¥oc
 
kp
;

123 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

124  
NULL
;

126 i‡(
	`psutû_gë_köfo_¥oc
(
pid
, &
kp
) == -1) {

127  
NULL
;

129  
	`Py_BuûdVÆue
("s", 
kp
.
kp_¥oc
.
p_comm
);

130 
	}
}

136 
PyObje˘
 *

137 
	$psutû_¥oc_cwd
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

139 
pid
;

140 
¥oc_vnodï©höfo
 
∑thöfo
;

142 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

143  
NULL
;

146 i‡(! 
	`psutû_¥oc_pidöfo
(
pid
, 
PROC_PIDVNODEPATHINFO
, &
∑thöfo
,

147 (
∑thöfo
)))

149  
NULL
;

151  
	`Py_BuûdVÆue
("s", 
∑thöfo
.
pvi_cdú
.
vù_∑th
);

152 
	}
}

158 
PyObje˘
 *

159 
	$psutû_¥oc_exe
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

161 
pid
;

162 
buf
[
PATH_MAX
];

163 
ªt
;

165 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

166  
NULL
;

168 
ªt
 = 
	`¥oc_pid∑th
(
pid
, &
buf
, (buf));

169 i‡(
ªt
 == 0) {

170 i‡(! 
	`psutû_pid_exi°s
(
pid
)) {

171  
	`NoSuchPro˚ss
();

174  
	`Ac˚ssDíõd
();

177  
	`Py_BuûdVÆue
("s", 
buf
);

178 
	}
}

184 
PyObje˘
 *

185 
	$psutû_¥oc_cmdlöe
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

187 
pid
;

188 
PyObje˘
 *
¨gli°
 = 
NULL
;

190 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

191  
NULL
;

195 
¨gli°
 = 
	`psutû_gë_¨g_li°
(
pid
);

196  
¨gli°
;

197 
	}
}

203 
PyObje˘
 *

204 
	$psutû_¥oc_µid
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

206 
pid
;

207 
köfo_¥oc
 
kp
;

208 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

209  
NULL
;

211 i‡(
	`psutû_gë_köfo_¥oc
(
pid
, &
kp
) == -1) {

212  
NULL
;

214  
	`Py_BuûdVÆue
("l", ()
kp
.
kp_ïroc
.
e_µid
);

215 
	}
}

221 
PyObje˘
 *

222 
	$psutû_¥oc_uids
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

224 
pid
;

225 
köfo_¥oc
 
kp
;

226 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

227  
NULL
;

229 i‡(
	`psutû_gë_köfo_¥oc
(
pid
, &
kp
) == -1) {

230  
NULL
;

232  
	`Py_BuûdVÆue
("lll",

233 ()
kp
.
kp_ïroc
.
e_p¸ed
.
p_ruid
,

234 ()
kp
.
kp_ïroc
.
e_u¸ed
.
¸_uid
,

235 ()
kp
.
kp_ïroc
.
e_p¸ed
.
p_svuid
);

236 
	}
}

242 
PyObje˘
 *

243 
	$psutû_¥oc_gids
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

245 
pid
;

246 
köfo_¥oc
 
kp
;

247 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

248  
NULL
;

250 i‡(
	`psutû_gë_köfo_¥oc
(
pid
, &
kp
) == -1) {

251  
NULL
;

253  
	`Py_BuûdVÆue
("lll",

254 ()
kp
.
kp_ïroc
.
e_p¸ed
.
p_rgid
,

255 ()
kp
.
kp_ïroc
.
e_u¸ed
.
¸_groups
[0],

256 ()
kp
.
kp_ïroc
.
e_p¸ed
.
p_svgid
);

257 
	}
}

263 
PyObje˘
 *

264 
	$psutû_¥oc_ây_ƒ
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

266 
pid
;

267 
köfo_¥oc
 
kp
;

268 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

269  
NULL
;

271 i‡(
	`psutû_gë_köfo_¥oc
(
pid
, &
kp
) == -1) {

272  
NULL
;

274  
	`Py_BuûdVÆue
("i", 
kp
.
kp_ïroc
.
e_tdev
);

275 
	}
}

282 
PyObje˘
 *

283 
	$psutû_¥oc_mem‹y_m≠s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

285 
buf
[
PATH_MAX
];

286 
addr_°r
[34];

287 
≥rms
[8];

288 
∑gesize
 = 
	`gë∑gesize
();

289 
pid
;

290 
kîn_ªtu∫_t
 
îr
 = 
KERN_SUCCESS
;

291 
mach_p‹t_t
 
èsk
 = 
MACH_PORT_NULL
;

292 
uöt32_t
 
dïth
 = 1;

293 
vm_addªss_t
 
addªss
 = 0;

294 
vm_size_t
 
size
 = 0;

296 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

297 
PyObje˘
 *
py_li°
 = 
	`PyLi°_New
(0);

299 i‡(
py_li°
 =
NULL
)

300  
NULL
;

302 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

303 
îr‹
;

306 
îr
 = 
	`èsk_f‹_pid
(
	`mach_èsk_£lf
(), 
pid
, &
èsk
);

308 i‡(
îr
 !
KERN_SUCCESS
) {

309 i‡(! 
	`psutû_pid_exi°s
(
pid
)) {

310 
	`NoSuchPro˚ss
();

315 
	`Ac˚ssDíõd
();

317 
îr‹
;

321 
py_tu∂e
 = 
NULL
;

322 
vm_ªgi⁄_subm≠_öfo_64
 
öfo
;

323 
mach_msg_ty≥_numbî_t
 
cou¡
 = 
VM_REGION_SUBMAP_INFO_COUNT_64
;

325 
îr
 = 
	`vm_ªgi⁄_ªcur£_64
(
èsk
, &
addªss
, &
size
, &
dïth
,

326 (
vm_ªgi⁄_öfo_64_t
)&
öfo
, &
cou¡
);

328 i‡(
îr
 =
KERN_INVALID_ADDRESS
) {

332 i‡(
öfo
.
is_subm≠
) {

333 
dïth
++;

337 
	`mem£t
(
buf
, 0, (buf));

338 
	`mem£t
(
addr_°r
, 0, (addr_str));

339 
	`mem£t
(
≥rms
, 0, (perms));

341 
	`•rötf
(
addr_°r
, "%016lx-%016lx", 
addªss
,áddªs†+ 
size
);

342 
	`•rötf
(
≥rms
, "%c%c%c/%c%c%c",

343 (
öfo
.
¥Ÿe˘i⁄
 & 
VM_PROT_READ
) ? 'r' : '-',

344 (
öfo
.
¥Ÿe˘i⁄
 & 
VM_PROT_WRITE
) ? 'w' : '-',

345 (
öfo
.
¥Ÿe˘i⁄
 & 
VM_PROT_EXECUTE
) ? 'x' : '-',

346 (
öfo
.
max_¥Ÿe˘i⁄
 & 
VM_PROT_READ
) ? 'r' : '-',

347 (
öfo
.
max_¥Ÿe˘i⁄
 & 
VM_PROT_WRITE
) ? 'w' : '-',

348 (
öfo
.
max_¥Ÿe˘i⁄
 & 
VM_PROT_EXECUTE
) ? 'x' : '-');

350 
îr
 = 
	`¥oc_ªgi⁄fûíame
(
pid
, 
addªss
, 
buf
, (buf));

352 i‡(
öfo
.
sh¨e_mode
 =
SM_COW
 && info.
ªf_cou¡
 == 1) {

354 
öfo
.
sh¨e_mode
 = 
SM_PRIVATE
;

357 i‡(
	`°æí
(
buf
) == 0) {

358 
öfo
.
sh¨e_mode
) {

364 
SM_COW
:

365 
	`°r˝y
(
buf
, "[cow]");

367 
SM_PRIVATE
:

368 
	`°r˝y
(
buf
, "[prv]");

370 
SM_EMPTY
:

371 
	`°r˝y
(
buf
, "[nul]");

373 
SM_SHARED
:

374 
SM_TRUESHARED
:

375 
	`°r˝y
(
buf
, "[shm]");

377 
SM_PRIVATE_ALIASED
:

378 
	`°r˝y
(
buf
, "[ali]");

380 
SM_SHARED_ALIASED
:

381 
	`°r˝y
(
buf
, "[s/a]");

384 
	`°r˝y
(
buf
, "[???]");

388 
py_tu∂e
 = 
	`Py_BuûdVÆue
(

390 
addr_°r
,

391 
≥rms
,

392 
buf
,

393 
öfo
.
∑ges_ªsidít
 * 
∑gesize
,

394 
öfo
.
∑ges_sh¨ed_now_¥iv©e
 * 
∑gesize
,

395 
öfo
.
∑ges_sw≠≥d_out
 * 
∑gesize
,

396 
öfo
.
∑ges_dútõd
 * 
∑gesize
,

397 
öfo
.
ªf_cou¡
,

398 
öfo
.
shadow_dïth


400 i‡(!
py_tu∂e
)

401 
îr‹
;

402 i‡(
	`PyLi°_Aµíd
(
py_li°
, 
py_tu∂e
))

403 
îr‹
;

404 
	`Py_DECREF
(
py_tu∂e
);

408 
addªss
 +
size
;

411 i‡(
èsk
 !
MACH_PORT_NULL
)

412 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
èsk
);

414  
py_li°
;

416 
îr‹
:

417 i‡(
èsk
 !
MACH_PORT_NULL
)

418 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
èsk
);

419 
	`Py_XDECREF
(
py_tu∂e
);

420 
	`Py_DECREF
(
py_li°
);

421  
NULL
;

422 
	}
}

429 
PyObje˘
 *

430 
	$psutû_˝u_cou¡_logiˇl
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

432 
mib
[2];

433 
n˝u
;

434 
size_t
 
Àn
;

436 
mib
[0] = 
CTL_HW
;

437 
mib
[1] = 
HW_NCPU
;

438 
Àn
 = (
n˝u
);

440 i‡(
	`sys˘l
(
mib
, 2, &
n˝u
, &
Àn
, 
NULL
, 0) == -1) {

442 
	`Py_INCREF
(
Py_N⁄e
);

443  
Py_N⁄e
;

446  
	`Py_BuûdVÆue
("i", 
n˝u
);

448 
	}
}

454 
PyObje˘
 *

455 
	$psutû_˝u_cou¡_phys
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

457 
num
;

458 
size_t
 
size
 = ();

459 i‡(
	`sys˘lby«me
("hw.physiˇl˝u", &
num
, &
size
, 
NULL
, 0)) {

461 
	`Py_INCREF
(
Py_N⁄e
);

462  
Py_N⁄e
;

464  
	`Py_BuûdVÆue
("i", 
num
);

465 
	}
}

468 
	#TV2DOUBLE
(
t
Ë(—).
tv_£c
 + (t).
tv_u£c
 / 1000000.0)

	)

473 
PyObje˘
 *

474 
	$psutû_¥oc_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

476 
pid
;

477 
¥oc_èsköfo
 
±i
;

478 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

479  
NULL
;

481 i‡(! 
	`psutû_¥oc_pidöfo
(
pid
, 
PROC_PIDTASKINFO
, &
±i
, (pti))) {

482  
NULL
;

484  
	`Py_BuûdVÆue
("(dd)",

485 ()
±i
.
±i_tŸÆ_u£r
 / 1000000000.0,

486 ()
±i
.
±i_tŸÆ_sy°em
 / 1000000000.0);

487 
	}
}

494 
PyObje˘
 *

495 
	$psutû_¥oc_¸óã_time
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

497 
pid
;

498 
köfo_¥oc
 
kp
;

499 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

500  
NULL
;

502 i‡(
	`psutû_gë_köfo_¥oc
(
pid
, &
kp
) == -1) {

503  
NULL
;

505  
	`Py_BuûdVÆue
("d", 
	`TV2DOUBLE
(
kp
.
kp_¥oc
.
p_°¨âime
));

506 
	}
}

512 
PyObje˘
 *

513 
	$psutû_¥oc_mem‹y_öfo
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

515 
pid
;

516 
¥oc_èsköfo
 
±i
;

517 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

518  
NULL
;

520 i‡(! 
	`psutû_¥oc_pidöfo
(
pid
, 
PROC_PIDTASKINFO
, &
±i
, (pti))) {

521  
NULL
;

529  
	`Py_BuûdVÆue
(

531 
±i
.
±i_ªsidít_size
,

532 
±i
.
±i_vútuÆ_size
,

533 
±i
.
±i_Áu…s
,

534 
±i
.
±i_∑geös


536 
	}
}

542 
PyObje˘
 *

543 
	$psutû_¥oc_num_thªads
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

545 
pid
;

546 
¥oc_èsköfo
 
±i
;

547 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

548  
NULL
;

550 i‡(! 
	`psutû_¥oc_pidöfo
(
pid
, 
PROC_PIDTASKINFO
, &
±i
, (pti))) {

551  
NULL
;

553  
	`Py_BuûdVÆue
("k", 
±i
.
±i_thªadnum
);

554 
	}
}

560 
PyObje˘
 *

561 
	$psutû_¥oc_num_˘x_swôches
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

563 
pid
;

564 
¥oc_èsköfo
 
±i
;

565 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

566  
NULL
;

568 i‡(! 
	`psutû_¥oc_pidöfo
(
pid
, 
PROC_PIDTASKINFO
, &
±i
, (pti))) {

569  
NULL
;

574  
	`Py_BuûdVÆue
("ki", 
±i
.
±i_csw
, 0);

575 
	}
}

581 
PyObje˘
 *

582 
	$psutû_vútuÆ_mem
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

585 
mib
[2];

586 
uöt64_t
 
tŸÆ
;

587 
size_t
 
Àn
 = (
tŸÆ
);

588 
vm_°©i°ics_d©a_t
 
vm
;

589 
∑gesize
 = 
	`gë∑gesize
();

592 
mib
[0] = 
CTL_HW
;

593 
mib
[1] = 
HW_MEMSIZE
;

594 i‡(
	`sys˘l
(
mib
, 2, &
tŸÆ
, &
Àn
, 
NULL
, 0)) {

595 i‡(
î∫o
 != 0)

596 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

598 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "sysctl(HW_MEMSIZE) failed");

599  
NULL
;

603 i‡(!
	`psutû_sys_vmöfo
(&
vm
)) {

604  
NULL
;

607  
	`Py_BuûdVÆue
(

609 
tŸÆ
,

610 (Ë
vm
.
a˘ive_cou¡
 * 
∑gesize
,

611 (Ë
vm
.
öa˘ive_cou¡
 * 
∑gesize
,

612 (Ë
vm
.
wúe_cou¡
 * 
∑gesize
,

613 (Ë
vm
.
‰ì_cou¡
 * 
∑gesize


615 
	}
}

621 
PyObje˘
 *

622 
	$psutû_sw≠_mem
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

624 
mib
[2];

625 
size_t
 
size
;

626 
xsw_ußge
 
tŸÆs
;

627 
vm_°©i°ics_d©a_t
 
vm°©
;

628 
∑gesize
 = 
	`gë∑gesize
();

630 
mib
[0] = 
CTL_VM
;

631 
mib
[1] = 
VM_SWAPUSAGE
;

632 
size
 = (
tŸÆs
);

633 i‡(
	`sys˘l
(
mib
, 2, &
tŸÆs
, &
size
, 
NULL
, 0) == -1) {

634 i‡(
î∫o
 != 0)

635 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

637 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "sysctl(VM_SWAPUSAGE) failed");

638  
NULL
;

640 i‡(!
	`psutû_sys_vmöfo
(&
vm°©
)) {

641  
NULL
;

644  
	`Py_BuûdVÆue
(

646 
tŸÆs
.
xsu_tŸÆ
,

647 
tŸÆs
.
xsu_u£d
,

648 
tŸÆs
.
xsu_avaû
,

649 ()
vm°©
.
∑geös
 * 
∑gesize
,

650 ()
vm°©
.
∑geouts
 * 
∑gesize
);

651 
	}
}

657 
PyObje˘
 *

658 
	$psutû_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

660 
mach_msg_ty≥_numbî_t
 
cou¡
 = 
HOST_CPU_LOAD_INFO_COUNT
;

661 
kîn_ªtu∫_t
 
îr‹
;

662 
ho°_˝u_lﬂd_öfo_d©a_t
 
r_lﬂd
;

664 
mach_p‹t_t
 
ho°_p‹t
 = 
	`mach_ho°_£lf
();

665 
îr‹
 = 
	`ho°_°©i°ics
(
ho°_p‹t
, 
HOST_CPU_LOAD_INFO
,

666 (
ho°_öfo_t
)&
r_lﬂd
, &
cou¡
);

667 i‡(
îr‹
 !
KERN_SUCCESS
) {

668  
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

670 
	`mach_îr‹_°rög
(
îr‹
));

672 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
ho°_p‹t
);

674  
	`Py_BuûdVÆue
(

676 ()
r_lﬂd
.
˝u_ticks
[
CPU_STATE_USER
] / 
CLK_TCK
,

677 ()
r_lﬂd
.
˝u_ticks
[
CPU_STATE_NICE
] / 
CLK_TCK
,

678 ()
r_lﬂd
.
˝u_ticks
[
CPU_STATE_SYSTEM
] / 
CLK_TCK
,

679 ()
r_lﬂd
.
˝u_ticks
[
CPU_STATE_IDLE
] / 
CLK_TCK


681 
	}
}

687 
PyObje˘
 *

688 
	$psutû_≥r_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

690 
«tuøl_t
 
˝u_cou¡
;

691 
¥o˚ss‹_öfo_¨øy_t
 
öfo_¨øy
;

692 
mach_msg_ty≥_numbî_t
 
öfo_cou¡
;

693 
kîn_ªtu∫_t
 
îr‹
;

694 
¥o˚ss‹_˝u_lﬂd_öfo_d©a_t
 *
˝u_lﬂd_öfo
 = 
NULL
;

695 
i
, 
ªt
;

696 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

697 
PyObje˘
 *
py_˝utime
 = 
NULL
;

699 i‡(
py_ªéi°
 =
NULL
)

700  
NULL
;

702 
mach_p‹t_t
 
ho°_p‹t
 = 
	`mach_ho°_£lf
();

703 
îr‹
 = 
	`ho°_¥o˚ss‹_öfo
(
ho°_p‹t
, 
PROCESSOR_CPU_LOAD_INFO
,

704 &
˝u_cou¡
, &
öfo_¨øy
, &
öfo_cou¡
);

705 i‡(
îr‹
 !
KERN_SUCCESS
) {

706 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "Error in host_processor_info(): %s",

707 
	`mach_îr‹_°rög
(
îr‹
));

708 
îr‹
;

710 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
ho°_p‹t
);

712 
˝u_lﬂd_öfo
 = (
¥o˚ss‹_˝u_lﬂd_öfo_d©a_t
 *Ë
öfo_¨øy
;

714 
i
 = 0; i < 
˝u_cou¡
; i++) {

715 
py_˝utime
 = 
	`Py_BuûdVÆue
(

717 ()
˝u_lﬂd_öfo
[
i
].
˝u_ticks
[
CPU_STATE_USER
] / 
CLK_TCK
,

718 ()
˝u_lﬂd_öfo
[
i
].
˝u_ticks
[
CPU_STATE_NICE
] / 
CLK_TCK
,

719 ()
˝u_lﬂd_öfo
[
i
].
˝u_ticks
[
CPU_STATE_SYSTEM
] / 
CLK_TCK
,

720 ()
˝u_lﬂd_öfo
[
i
].
˝u_ticks
[
CPU_STATE_IDLE
] / 
CLK_TCK


722 i‡(!
py_˝utime
)

723 
îr‹
;

724 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_˝utime
))

725 
îr‹
;

726 
	`Py_DECREF
(
py_˝utime
);

729 
ªt
 = 
	`vm_dóŒoˇã
(
	`mach_èsk_£lf
(), (
vm_addªss_t
)
öfo_¨øy
,

730 
öfo_cou¡
 * ());

731 i‡(
ªt
 !
KERN_SUCCESS
) {

732 
	`PyEº_W¨nEx
(
PyExc_Ru¡imeW¨nög
, "vm_deallocate() failed", 2);

734  
py_ªéi°
;

736 
îr‹
:

737 
	`Py_XDECREF
(
py_˝utime
);

738 
	`Py_DECREF
(
py_ªéi°
);

739 i‡(
˝u_lﬂd_öfo
 !
NULL
) {

740 
ªt
 = 
	`vm_dóŒoˇã
(
	`mach_èsk_£lf
(), (
vm_addªss_t
)
öfo_¨øy
,

741 
öfo_cou¡
 * ());

742 i‡(
ªt
 !
KERN_SUCCESS
) {

743 
	`PyEº_W¨nEx
(
PyExc_Ru¡imeW¨nög
, "vm_deallocate() failed", 2);

746  
NULL
;

747 
	}
}

754 
PyObje˘
 *

755 
	$psutû_boŸ_time
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

758 
ªque°
[2] = { 
CTL_KERN
, 
KERN_BOOTTIME
 };

759 
timevÆ
 
ªsu…
;

760 
size_t
 
ªsu…_Àn
 =  
ªsu…
;

761 
time_t
 
boŸ_time
 = 0;

763 i‡(
	`sys˘l
(
ªque°
, 2, &
ªsu…
, &
ªsu…_Àn
, 
NULL
, 0) == -1) {

764 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

765  
NULL
;

767 
boŸ_time
 = 
ªsu…
.
tv_£c
;

768  
	`Py_BuûdVÆue
("f", ()
boŸ_time
);

769 
	}
}

776 
PyObje˘
 *

777 
	$psutû_disk_∑πôi⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

779 
num
;

780 
i
;

781 
Àn
;

782 
uöt64_t
 
Êags
;

783 
›ts
[400];

784 
°©fs
 *
fs
 = 
NULL
;

785 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

786 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

788 i‡(
py_ªéi°
 =
NULL
)

789  
NULL
;

792 
Py_BEGIN_ALLOW_THREADS


793 
num
 = 
	`gëfs°©
(
NULL
, 0, 
MNT_NOWAIT
);

794 
Py_END_ALLOW_THREADS


795 i‡(
num
 == -1) {

796 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

797 
îr‹
;

800 
Àn
 = (*
fs
Ë* 
num
;

801 
fs
 = 
	`mÆloc
(
Àn
);

802 i‡(
fs
 =
NULL
) {

803 
	`PyEº_NoMem‹y
();

804 
îr‹
;

807 
Py_BEGIN_ALLOW_THREADS


808 
num
 = 
	`gëfs°©
(
fs
, 
Àn
, 
MNT_NOWAIT
);

809 
Py_END_ALLOW_THREADS


810 i‡(
num
 == -1) {

811 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

812 
îr‹
;

815 
i
 = 0; i < 
num
; i++) {

816 
›ts
[0] = 0;

817 
Êags
 = 
fs
[
i
].
f_Êags
;

820 i‡(
Êags
 & 
MNT_RDONLY
)

821 
	`°æˇt
(
›ts
, "ro", (opts));

823 
	`°æˇt
(
›ts
, "rw", (opts));

824 i‡(
Êags
 & 
MNT_SYNCHRONOUS
)

825 
	`°æˇt
(
›ts
, ",sync", (opts));

826 i‡(
Êags
 & 
MNT_NOEXEC
)

827 
	`°æˇt
(
›ts
, ",noexec", (opts));

828 i‡(
Êags
 & 
MNT_NOSUID
)

829 
	`°æˇt
(
›ts
, ",nosuid", (opts));

830 i‡(
Êags
 & 
MNT_UNION
)

831 
	`°æˇt
(
›ts
, ",union", (opts));

832 i‡(
Êags
 & 
MNT_ASYNC
)

833 
	`°æˇt
(
›ts
, ",async", (opts));

834 i‡(
Êags
 & 
MNT_EXPORTED
)

835 
	`°æˇt
(
›ts
, ",exported", (opts));

836 i‡(
Êags
 & 
MNT_QUARANTINE
)

837 
	`°æˇt
(
›ts
, ",quarantine", (opts));

838 i‡(
Êags
 & 
MNT_LOCAL
)

839 
	`°æˇt
(
›ts
, ",local", (opts));

840 i‡(
Êags
 & 
MNT_QUOTA
)

841 
	`°æˇt
(
›ts
, ",quota", (opts));

842 i‡(
Êags
 & 
MNT_ROOTFS
)

843 
	`°æˇt
(
›ts
, ",rootfs", (opts));

844 i‡(
Êags
 & 
MNT_DOVOLFS
)

845 
	`°æˇt
(
›ts
, ",dovolfs", (opts));

846 i‡(
Êags
 & 
MNT_DONTBROWSE
)

847 
	`°æˇt
(
›ts
, ",dontbrowse", (opts));

848 i‡(
Êags
 & 
MNT_IGNORE_OWNERSHIP
)

849 
	`°æˇt
(
›ts
, ",ignore-ownership", (opts));

850 i‡(
Êags
 & 
MNT_AUTOMOUNTED
)

851 
	`°æˇt
(
›ts
, ",automounted", (opts));

852 i‡(
Êags
 & 
MNT_JOURNALED
)

853 
	`°æˇt
(
›ts
, ",journaled", (opts));

854 i‡(
Êags
 & 
MNT_NOUSERXATTR
)

855 
	`°æˇt
(
›ts
, ",nouserxattr", (opts));

856 i‡(
Êags
 & 
MNT_DEFWRITE
)

857 
	`°æˇt
(
›ts
, ",defwrite", (opts));

858 i‡(
Êags
 & 
MNT_MULTILABEL
)

859 
	`°æˇt
(
›ts
, ",multilabel", (opts));

860 i‡(
Êags
 & 
MNT_NOATIME
)

861 
	`°æˇt
(
›ts
, ",noatime", (opts));

862 i‡(
Êags
 & 
MNT_UPDATE
)

863 
	`°æˇt
(
›ts
, ",update", (opts));

864 i‡(
Êags
 & 
MNT_RELOAD
)

865 
	`°æˇt
(
›ts
, ",reload", (opts));

866 i‡(
Êags
 & 
MNT_FORCE
)

867 
	`°æˇt
(
›ts
, ",force", (opts));

868 i‡(
Êags
 & 
MNT_CMDFLAGS
)

869 
	`°æˇt
(
›ts
, ",cmdflags", (opts));

871 
py_tu∂e
 = 
	`Py_BuûdVÆue
(

872 "(ssss)", 
fs
[
i
].
f_m¡‰om«me
,

873 
fs
[
i
].
f_m¡⁄«me
,

874 
fs
[
i
].
f_f°y≥«me
,

875 
›ts
);

876 i‡(!
py_tu∂e
)

877 
îr‹
;

878 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

879 
îr‹
;

880 
	`Py_DECREF
(
py_tu∂e
);

883 
	`‰ì
(
fs
);

884  
py_ªéi°
;

886 
îr‹
:

887 
	`Py_XDECREF
(
py_tu∂e
);

888 
	`Py_DECREF
(
py_ªéi°
);

889 i‡(
fs
 !
NULL
)

890 
	`‰ì
(
fs
);

891  
NULL
;

892 
	}
}

898 
PyObje˘
 *

899 
	$psutû_¥oc_°©us
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

901 
pid
;

902 
köfo_¥oc
 
kp
;

903 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

904  
NULL
;

906 i‡(
	`psutû_gë_köfo_¥oc
(
pid
, &
kp
) == -1) {

907  
NULL
;

909  
	`Py_BuûdVÆue
("i", ()
kp
.
kp_¥oc
.
p_°©
);

910 
	}
}

916 
PyObje˘
 *

917 
	$psutû_¥oc_thªads
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

919 
pid
;

920 
îr
, 
j
, 
ªt
;

921 
kîn_ªtu∫_t
 
kr
;

922 
öfo_cou¡
 = 
TASK_BASIC_INFO_COUNT
;

923 
mach_p‹t_t
 
èsk
 = 
MACH_PORT_NULL
;

924 
èsk_basic_öfo
 
èsks_öfo
;

925 
thªad_a˘_p‹t_¨øy_t
 
thªad_li°
 = 
NULL
;

926 
thªad_öfo_d©a_t
 
thöfo_basic
;

927 
thªad_basic_öfo_t
 
basic_öfo_th
;

928 
mach_msg_ty≥_numbî_t
 
thªad_cou¡
, 
thªad_öfo_cou¡
;

930 
PyObje˘
 *
ªtLi°
 = 
	`PyLi°_New
(0);

931 
PyObje˘
 *
pyTu∂e
 = 
NULL
;

933 i‡(
ªtLi°
 =
NULL
)

934  
NULL
;

937 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

938 
îr‹
;

942 
îr
 = 
	`èsk_f‹_pid
(
	`mach_èsk_£lf
(), 
pid
, &
èsk
);

943 i‡(
îr
 !
KERN_SUCCESS
) {

944 i‡(! 
	`psutû_pid_exi°s
(
pid
)) {

945 
	`NoSuchPro˚ss
();

948 
	`Ac˚ssDíõd
();

950 
îr‹
;

953 
öfo_cou¡
 = 
TASK_BASIC_INFO_COUNT
;

954 
îr
 = 
	`èsk_öfo
(
èsk
, 
TASK_BASIC_INFO
, (
èsk_öfo_t
)&
èsks_öfo
,

955 &
öfo_cou¡
);

956 i‡(
îr
 !
KERN_SUCCESS
) {

958 i‡(
îr
 == 4) {

959 
	`Ac˚ssDíõd
();

963 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

966 
îr‹
;

969 
îr
 = 
	`èsk_thªads
(
èsk
, &
thªad_li°
, &
thªad_cou¡
);

970 i‡(
îr
 !
KERN_SUCCESS
) {

971 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "task_threads() failed");

972 
îr‹
;

975 
j
 = 0; j < 
thªad_cou¡
; j++) {

976 
pyTu∂e
 = 
NULL
;

977 
thªad_öfo_cou¡
 = 
THREAD_INFO_MAX
;

978 
kr
 = 
	`thªad_öfo
(
thªad_li°
[
j
], 
THREAD_BASIC_INFO
,

979 (
thªad_öfo_t
)
thöfo_basic
, &
thªad_öfo_cou¡
);

980 i‡(
kr
 !
KERN_SUCCESS
) {

981 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

983 
îr‹
;

986 
basic_öfo_th
 = (
thªad_basic_öfo_t
)
thöfo_basic
;

987 
pyTu∂e
 = 
	`Py_BuûdVÆue
(

989 
j
 + 1,

990 ()
basic_öfo_th
->
u£r_time
.
mi¸o£c⁄ds
 / 1000000.0,

991 ()
basic_öfo_th
->
sy°em_time
.
mi¸o£c⁄ds
 / 1000000.0

993 i‡(!
pyTu∂e
)

994 
îr‹
;

995 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
pyTu∂e
))

996 
îr‹
;

997 
	`Py_DECREF
(
pyTu∂e
);

1000 
ªt
 = 
	`vm_dóŒoˇã
(
èsk
, (
vm_addªss_t
)
thªad_li°
,

1001 
thªad_cou¡
 * ());

1002 i‡(
ªt
 !
KERN_SUCCESS
) {

1003 
	`PyEº_W¨nEx
(
PyExc_Ru¡imeW¨nög
, "vm_deallocate() failed", 2);

1006 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
èsk
);

1008  
ªtLi°
;

1010 
îr‹
:

1011 i‡(
èsk
 !
MACH_PORT_NULL
)

1012 
	`mach_p‹t_dóŒoˇã
(
	`mach_èsk_£lf
(), 
èsk
);

1013 
	`Py_XDECREF
(
pyTu∂e
);

1014 
	`Py_DECREF
(
ªtLi°
);

1015 i‡(
thªad_li°
 !
NULL
) {

1016 
ªt
 = 
	`vm_dóŒoˇã
(
èsk
, (
vm_addªss_t
)
thªad_li°
,

1017 
thªad_cou¡
 * ());

1018 i‡(
ªt
 !
KERN_SUCCESS
) {

1019 
	`PyEº_W¨nEx
(
PyExc_Ru¡imeW¨nög
, "vm_deallocate() failed", 2);

1022  
NULL
;

1023 
	}
}

1032 
PyObje˘
 *

1033 
	$psutû_¥oc_›í_fûes
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1035 
pid
;

1036 
pidöfo_ªsu…
;

1037 
ôî©i⁄s
;

1038 
i
;

1039 
nb
;

1041 
¥oc_fdöfo
 *
fds_poöãr
 = 
NULL
;

1042 
¥oc_fdöfo
 *
fdp_poöãr
;

1043 
vnode_fdöfowôh∑th
 
vi
;

1045 
PyObje˘
 *
ªtLi°
 = 
	`PyLi°_New
(0);

1046 
PyObje˘
 *
tu∂e
 = 
NULL
;

1048 i‡(
ªtLi°
 =
NULL
)

1049  
NULL
;

1051 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1052 
îr‹
;

1055 
pidöfo_ªsu…
 = 
	`¥oc_pidöfo
(
pid
, 
PROC_PIDLISTFDS
, 0, 
NULL
, 0);

1056 i‡(
pidöfo_ªsu…
 <= 0) {

1058 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

1060 
îr‹
;

1063 
fds_poöãr
 = 
	`mÆloc
(
pidöfo_ªsu…
);

1064 i‡(
fds_poöãr
 =
NULL
) {

1065 
	`PyEº_NoMem‹y
();

1066 
îr‹
;

1068 
pidöfo_ªsu…
 = 
	`¥oc_pidöfo
(
pid
, 
PROC_PIDLISTFDS
, 0, 
fds_poöãr
,

1069 
pidöfo_ªsu…
);

1070 i‡(
pidöfo_ªsu…
 <= 0) {

1072 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

1074 
îr‹
;

1077 
ôî©i⁄s
 = (
pidöfo_ªsu…
 / 
PROC_PIDLISTFD_SIZE
);

1079 
i
 = 0; i < 
ôî©i⁄s
; i++) {

1080 
tu∂e
 = 
NULL
;

1081 
fdp_poöãr
 = &
fds_poöãr
[
i
];

1083 i‡(
fdp_poöãr
->
¥oc_fdty≥
 =
PROX_FDTYPE_VNODE
)

1085 
nb
 = 
	`¥oc_pidfdöfo
(
pid
,

1086 
fdp_poöãr
->
¥oc_fd
,

1087 
PROC_PIDFDVNODEPATHINFO
,

1088 &
vi
,

1089 (
vi
));

1092 i‡(
nb
 <= 0) {

1093 i‡((
î∫o
 =
ENOENT
Ë|| (î∫ÿ=
EBADF
)) {

1099 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

1101 
îr‹
;

1103 i‡(
nb
 < (
vi
)) {

1104 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

1107 
îr‹
;

1112 
tu∂e
 = 
	`Py_BuûdVÆue
("(si)",

1113 
vi
.
pvù
.
vù_∑th
,

1114 ()
fdp_poöãr
->
¥oc_fd
);

1115 i‡(!
tu∂e
)

1116 
îr‹
;

1117 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
tu∂e
))

1118 
îr‹
;

1119 
	`Py_DECREF
(
tu∂e
);

1124 
	`‰ì
(
fds_poöãr
);

1125  
ªtLi°
;

1127 
îr‹
:

1128 
	`Py_XDECREF
(
tu∂e
);

1129 
	`Py_DECREF
(
ªtLi°
);

1130 i‡(
fds_poöãr
 !
NULL
) {

1131 
	`‰ì
(
fds_poöãr
);

1133 i‡(
î∫o
 != 0) {

1134  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1136 i‡(! 
	`psutû_pid_exi°s
(
pid
)) {

1137  
	`NoSuchPro˚ss
();

1141  
NULL
;

1143 
	}
}

1147 
	gPSUTIL_CONN_NONE
 = 128;

1155 
PyObje˘
 *

1156 
	$psutû_¥oc_c⁄√˘i⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1158 
pid
;

1159 
pidöfo_ªsu…
;

1160 
ôî©i⁄s
;

1161 
i
;

1162 
nb
;

1164 
¥oc_fdöfo
 *
fds_poöãr
 = 
NULL
;

1165 
¥oc_fdöfo
 *
fdp_poöãr
;

1166 
sockë_fdöfo
 
si
;

1168 
PyObje˘
 *
ªtLi°
 = 
	`PyLi°_New
(0);

1169 
PyObje˘
 *
tu∂e
 = 
NULL
;

1170 
PyObje˘
 *
œddr
 = 
NULL
;

1171 
PyObje˘
 *
øddr
 = 
NULL
;

1172 
PyObje˘
 *
af_fûãr
 = 
NULL
;

1173 
PyObje˘
 *
ty≥_fûãr
 = 
NULL
;

1175 i‡(
ªtLi°
 =
NULL
)

1176  
NULL
;

1178 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "lOO", &
pid
, &
af_fûãr
, &
ty≥_fûãr
)) {

1179 
îr‹
;

1182 i‡(!
	`PySequí˚_Check
(
af_fûãr
Ë|| !PySequí˚_Check(
ty≥_fûãr
)) {

1183 
	`PyEº_SëSåög
(
PyExc_Ty≥Eº‹
, "arg 2 or 3 isÇotá sequence");

1184 
îr‹
;

1187 i‡(
pid
 == 0) {

1188  
ªtLi°
;

1191 
pidöfo_ªsu…
 = 
	`¥oc_pidöfo
(
pid
, 
PROC_PIDLISTFDS
, 0, 
NULL
, 0);

1192 i‡(
pidöfo_ªsu…
 <= 0) {

1193 
îr‹
;

1196 
fds_poöãr
 = 
	`mÆloc
(
pidöfo_ªsu…
);

1197 i‡(
fds_poöãr
 =
NULL
) {

1198 
	`PyEº_NoMem‹y
();

1199 
îr‹
;

1201 
pidöfo_ªsu…
 = 
	`¥oc_pidöfo
(
pid
, 
PROC_PIDLISTFDS
, 0, 
fds_poöãr
,

1202 
pidöfo_ªsu…
);

1204 i‡(
pidöfo_ªsu…
 <= 0) {

1205 
îr‹
;

1208 
ôî©i⁄s
 = (
pidöfo_ªsu…
 / 
PROC_PIDLISTFD_SIZE
);

1210 
i
 = 0; i < 
ôî©i⁄s
; i++) {

1211 
tu∂e
 = 
NULL
;

1212 
œddr
 = 
NULL
;

1213 
øddr
 = 
NULL
;

1214 
î∫o
 = 0;

1215 
fdp_poöãr
 = &
fds_poöãr
[
i
];

1217 i‡(
fdp_poöãr
->
¥oc_fdty≥
 =
PROX_FDTYPE_SOCKET
)

1219 
nb
 = 
	`¥oc_pidfdöfo
(
pid
, 
fdp_poöãr
->
¥oc_fd
,

1220 
PROC_PIDFDSOCKETINFO
, &
si
, (si));

1223 i‡(
nb
 <= 0) {

1224 i‡(
î∫o
 =
EBADF
) {

1228 i‡(
î∫o
 != 0) {

1229 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1232 
	`PyEº_F‹m©
(

1233 
PyExc_Ru¡imeEº‹
,

1236 
îr‹
;

1238 i‡(
nb
 < (
si
)) {

1239 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

1242 
îr‹
;

1247 
fd
, 
Ámûy
, 
ty≥
, 
Õ‹t
, 
Ω‹t
, 
°©e
;

1248 
lù
[200], 
rù
[200];

1249 
ö£q
;

1250 
PyObje˘
 *
_Ámûy
;

1251 
PyObje˘
 *
_ty≥
;

1253 
fd
 = ()
fdp_poöãr
->
¥oc_fd
;

1254 
Ámûy
 = 
si
.
psi
.
soi_Ámûy
;

1255 
ty≥
 = 
si
.
psi
.
soi_ty≥
;

1258 
_Ámûy
 = 
	`PyL⁄g_FromL⁄g
(()
Ámûy
);

1259 
ö£q
 = 
	`PySequí˚_C⁄èös
(
af_fûãr
, 
_Ámûy
);

1260 
	`Py_DECREF
(
_Ámûy
);

1261 i‡(
ö£q
 == 0) {

1264 
_ty≥
 = 
	`PyL⁄g_FromL⁄g
(()
ty≥
);

1265 
ö£q
 = 
	`PySequí˚_C⁄èös
(
ty≥_fûãr
, 
_ty≥
);

1266 
	`Py_DECREF
(
_ty≥
);

1267 i‡(
ö£q
 == 0) {

1271 i‡(
î∫o
 != 0) {

1272 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1273 
îr‹
;

1276 i‡((
Ámûy
 =
AF_INET
Ë|| (Ámûy =
AF_INET6
)) {

1277 i‡(
Ámûy
 =
AF_INET
) {

1278 
	`öë_¡›
(
AF_INET
,

1279 &
si
.
psi
.
soi_¥Ÿo
.
¥i_t˝
.
t˝si_öi
. \

1280 
ösi_œddr
.
öa_46
.
i46a_addr4
,

1281 
lù
,

1282 (
lù
));

1283 
	`öë_¡›
(
AF_INET
,

1284 &
si
.
psi
.
soi_¥Ÿo
.
¥i_t˝
.
t˝si_öi
.
ösi_Áddr
. \

1285 
öa_46
.
i46a_addr4
,

1286 
rù
,

1287 (
rù
));

1290 
	`öë_¡›
(
AF_INET6
,

1291 &
si
.
psi
.
soi_¥Ÿo
.
¥i_t˝
.
t˝si_öi
. \

1292 
ösi_œddr
.
öa_6
,

1293 
lù
, (lip));

1294 
	`öë_¡›
(
AF_INET6
,

1295 &
si
.
psi
.
soi_¥Ÿo
.
¥i_t˝
.
t˝si_öi
. \

1296 
ösi_Áddr
.
öa_6
,

1297 
rù
, (rip));

1301 i‡(
î∫o
 != 0) {

1302 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1303 
îr‹
;

1306 
Õ‹t
 = 
	`¡ohs
(
si
.
psi
.
soi_¥Ÿo
.
¥i_t˝
.
t˝si_öi
.
ösi_Õ‹t
);

1307 
Ω‹t
 = 
	`¡ohs
(
si
.
psi
.
soi_¥Ÿo
.
¥i_t˝
.
t˝si_öi
.
ösi_Â‹t
);

1308 i‡(
ty≥
 =
SOCK_STREAM
) {

1309 
°©e
 = ()
si
.
psi
.
soi_¥Ÿo
.
¥i_t˝
.
t˝si_°©e
;

1312 
°©e
 = 
PSUTIL_CONN_NONE
;

1315 
œddr
 = 
	`Py_BuûdVÆue
("(si)", 
lù
, 
Õ‹t
);

1316 i‡(!
œddr
)

1317 
îr‹
;

1318 i‡(
Ω‹t
 != 0) {

1319 
øddr
 = 
	`Py_BuûdVÆue
("(si)", 
rù
, 
Ω‹t
);

1322 
øddr
 = 
	`Py_BuûdVÆue
("()");

1324 i‡(!
øddr
)

1325 
îr‹
;

1328 
tu∂e
 = 
	`Py_BuûdVÆue
("(iiiNNi)", 
fd
, 
Ámûy
, 
ty≥
, 
œddr
,

1329 
øddr
, 
°©e
);

1330 i‡(!
tu∂e
)

1331 
îr‹
;

1332 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
tu∂e
))

1333 
îr‹
;

1334 
	`Py_DECREF
(
tu∂e
);

1336 i‡(
Ámûy
 =
AF_UNIX
) {

1338 
tu∂e
 = 
	`Py_BuûdVÆue
(

1340 
fd
, 
Ámûy
, 
ty≥
,

1341 
si
.
psi
.
soi_¥Ÿo
.
¥i_un
.
unsi_addr
.
ua_sun
.
sun_∑th
,

1342 
si
.
psi
.
soi_¥Ÿo
.
¥i_un
.
unsi_ˇddr
.
ua_sun
.
sun_∑th
,

1343 
PSUTIL_CONN_NONE
);

1344 i‡(!
tu∂e
)

1345 
îr‹
;

1346 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
tu∂e
))

1347 
îr‹
;

1348 
	`Py_DECREF
(
tu∂e
);

1353 
	`‰ì
(
fds_poöãr
);

1354  
ªtLi°
;

1356 
îr‹
:

1357 
	`Py_XDECREF
(
tu∂e
);

1358 
	`Py_XDECREF
(
œddr
);

1359 
	`Py_XDECREF
(
øddr
);

1360 
	`Py_DECREF
(
ªtLi°
);

1362 i‡(
fds_poöãr
 !
NULL
) {

1363 
	`‰ì
(
fds_poöãr
);

1365 i‡(
î∫o
 != 0) {

1366  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1368 i‡(! 
	`psutû_pid_exi°s
(
pid
) ) {

1369  
	`NoSuchPro˚ss
();

1372  
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
,

1375 
	}
}

1381 
PyObje˘
 *

1382 
	$psutû_¥oc_num_fds
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1384 
pid
;

1385 
pidöfo_ªsu…
;

1386 
num
;

1387 
¥oc_fdöfo
 *
fds_poöãr
;

1389 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1390  
NULL
;

1393 
pidöfo_ªsu…
 = 
	`¥oc_pidöfo
(
pid
, 
PROC_PIDLISTFDS
, 0, 
NULL
, 0);

1394 i‡(
pidöfo_ªsu…
 <= 0) {

1395  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1398 
fds_poöãr
 = 
	`mÆloc
(
pidöfo_ªsu…
);

1399 i‡(
fds_poöãr
 =
NULL
) {

1400  
	`PyEº_NoMem‹y
();

1402 
pidöfo_ªsu…
 = 
	`¥oc_pidöfo
(
pid
, 
PROC_PIDLISTFDS
, 0, 
fds_poöãr
,

1403 
pidöfo_ªsu…
);

1404 i‡(
pidöfo_ªsu…
 <= 0) {

1405 
	`‰ì
(
fds_poöãr
);

1406  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1409 
num
 = (
pidöfo_ªsu…
 / 
PROC_PIDLISTFD_SIZE
);

1410 
	`‰ì
(
fds_poöãr
);

1411  
	`Py_BuûdVÆue
("i", 
num
);

1412 
	}
}

1418 
PyObje˘
 *

1419 
	$psutû_√t_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1421 *
buf
 = 
NULL
, *
lim
, *
√xt
;

1422 
if_msghdr
 *
ifm
;

1423 
mib
[6];

1424 
size_t
 
Àn
;

1425 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

1426 
PyObje˘
 *
py_ifc_öfo
 = 
NULL
;

1428 i‡(
py_ªtdi˘
 =
NULL
)

1429  
NULL
;

1431 
mib
[0] = 
CTL_NET
;

1432 
mib
[1] = 
PF_ROUTE
;

1433 
mib
[2] = 0;

1434 
mib
[3] = 0;

1435 
mib
[4] = 
NET_RT_IFLIST2
;

1436 
mib
[5] = 0;

1438 i‡(
	`sys˘l
(
mib
, 6, 
NULL
, &
Àn
, NULL, 0) < 0) {

1439 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1440 
îr‹
;

1443 
buf
 = 
	`mÆloc
(
Àn
);

1444 i‡(
buf
 =
NULL
) {

1445 
	`PyEº_NoMem‹y
();

1446 
îr‹
;

1449 i‡(
	`sys˘l
(
mib
, 6, 
buf
, &
Àn
, 
NULL
, 0) < 0) {

1450 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

1451 
îr‹
;

1454 
lim
 = 
buf
 + 
Àn
;

1456 
√xt
 = 
buf
;Çexà< 
lim
; ) {

1457 
ifm
 = (
if_msghdr
 *)
√xt
;

1458 
√xt
 +
ifm
->
ifm_msgÀn
;

1460 i‡(
ifm
->
ifm_ty≥
 =
RTM_IFINFO2
) {

1461 
py_ifc_öfo
 = 
NULL
;

1462 
if_msghdr2
 *
if2m
 = (if_msghdr2 *)
ifm
;

1463 
sockaddr_dl
 *
sdl
 = (sockaddr_d»*)(
if2m
 + 1);

1464 
ifc_«me
[32];

1466 
	`°∫˝y
(
ifc_«me
, 
sdl
->
sdl_d©a
, sdl->
sdl_∆í
);

1467 
ifc_«me
[
sdl
->
sdl_∆í
] = 0;

1469 
py_ifc_öfo
 = 
	`Py_BuûdVÆue
(

1471 
if2m
->
ifm_d©a
.
ifi_obyãs
,

1472 
if2m
->
ifm_d©a
.
ifi_ibyãs
,

1473 
if2m
->
ifm_d©a
.
ifi_›ackës
,

1474 
if2m
->
ifm_d©a
.
ifi_ùackës
,

1475 
if2m
->
ifm_d©a
.
ifi_õº‹s
,

1476 
if2m
->
ifm_d©a
.
ifi_€º‹s
,

1477 
if2m
->
ifm_d©a
.
ifi_iqdr›s
,

1480 i‡(!
py_ifc_öfo
)

1481 
îr‹
;

1482 i‡(
	`PyDi˘_SëIãmSåög
(
py_ªtdi˘
, 
ifc_«me
, 
py_ifc_öfo
))

1483 
îr‹
;

1484 
	`Py_DECREF
(
py_ifc_öfo
);

1491 
	`‰ì
(
buf
);

1492  
py_ªtdi˘
;

1494 
îr‹
:

1495 
	`Py_XDECREF
(
py_ifc_öfo
);

1496 
	`Py_DECREF
(
py_ªtdi˘
);

1497 i‡(
buf
 !
NULL
)

1498 
	`‰ì
(
buf
);

1499  
NULL
;

1500 
	}
}

1506 
PyObje˘
 *

1507 
	$psutû_disk_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1509 
CFDi˘i⁄¨yRef
 
∑ª¡_di˘
;

1510 
CFDi˘i⁄¨yRef
 
¥›s_di˘
;

1511 
CFDi˘i⁄¨yRef
 
°©s_di˘
;

1512 
io_ªgi°ry_íåy_t
 
∑ª¡
;

1513 
io_ªgi°ry_íåy_t
 
disk
;

1514 
io_ôî©‹_t
 
disk_li°
;

1515 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

1516 
PyObje˘
 *
py_disk_öfo
 = 
NULL
;

1518 i‡(
py_ªtdi˘
 =
NULL
)

1519  
NULL
;

1522 i‡(
	`IOSîvi˚GëM©chögSîvi˚s
(
kIOMa°îP‹tDeÁu…
,

1523 
	`IOSîvi˚M©chög
(
kIOMedüCœss
),

1524 &
disk_li°
Ë!
kIORëu∫Suc˚ss
) {

1525 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

1527 
îr‹
;

1531 (
disk
 = 
	`IOIãøt‹Next
(
disk_li°
)) != 0) {

1532 
py_disk_öfo
 = 
NULL
;

1533 
∑ª¡_di˘
 = 
NULL
;

1534 
¥›s_di˘
 = 
NULL
;

1535 
°©s_di˘
 = 
NULL
;

1537 i‡(
	`IORegi°ryE¡ryGëP¨ítE¡ry
(
disk
, 
kIOSîvi˚Pœ√
, &
∑ª¡
)

1538 !
kIORëu∫Suc˚ss
) {

1539 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

1541 
	`IOObje˘Rñó£
(
disk
);

1542 
îr‹
;

1545 i‡(
	`IOObje˘C⁄f‹msTo
(
∑ª¡
, "IOBlockStorageDriver")) {

1546 i‡(
	`IORegi°ryE¡ryCª©eCFPr›îtõs
(

1547 
disk
,

1548 (
CFMuèbÀDi˘i⁄¨yRef
 *Ë&
∑ª¡_di˘
,

1549 
kCFAŒoˇt‹DeÁu…
,

1550 
kNûO±i⁄s


1551 Ë!
kIORëu∫Suc˚ss
)

1553 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

1555 
	`IOObje˘Rñó£
(
disk
);

1556 
	`IOObje˘Rñó£
(
∑ª¡
);

1557 
îr‹
;

1560 i‡(
	`IORegi°ryE¡ryCª©eCFPr›îtõs
(

1561 
∑ª¡
,

1562 (
CFMuèbÀDi˘i⁄¨yRef
 *Ë&
¥›s_di˘
,

1563 
kCFAŒoˇt‹DeÁu…
,

1564 
kNûO±i⁄s


1565 Ë!
kIORëu∫Suc˚ss
)

1567 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

1569 
	`CFRñó£
(
¥›s_di˘
);

1570 
	`IOObje˘Rñó£
(
disk
);

1571 
	`IOObje˘Rñó£
(
∑ª¡
);

1572 
îr‹
;

1575 c⁄° 
kMaxDiskNameSize
 = 64;

1576 
CFSåögRef
 
disk_«me_ªf
 = (CFSåögRef)
	`CFDi˘i⁄¨yGëVÆue
(

1577 
∑ª¡_di˘
, 
	`CFSTR
(
kIOBSDNameKey
));

1578 
disk_«me
[
kMaxDiskNameSize
];

1580 
	`CFSåögGëCSåög
(
disk_«me_ªf
,

1581 
disk_«me
,

1582 
kMaxDiskNameSize
,

1583 
	`CFSåögGëSy°emEncodög
());

1585 
°©s_di˘
 = (
CFDi˘i⁄¨yRef
)
	`CFDi˘i⁄¨yGëVÆue
(

1586 
¥›s_di˘
, 
	`CFSTR
(
kIOBlockSt‹ageDrivîSèti°icsKey
));

1588 i‡(
°©s_di˘
 =
NULL
) {

1589 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

1591 
îr‹
;

1594 
CFNumbîRef
 
numbî
;

1595 
öt64_t
 
ªads
 = 0;

1596 
öt64_t
 
wrôes
 = 0;

1597 
öt64_t
 
ªad_byãs
 = 0;

1598 
öt64_t
 
wrôe_byãs
 = 0;

1599 
öt64_t
 
ªad_time
 = 0;

1600 
öt64_t
 
wrôe_time
 = 0;

1603 i‡((
numbî
 = (
CFNumbîRef
)
	`CFDi˘i⁄¨yGëVÆue
(

1604 
°©s_di˘
,

1605 
	`CFSTR
(
kIOBlockSt‹ageDrivîSèti°icsRódsKey
))))

1607 
	`CFNumbîGëVÆue
(
numbî
, 
kCFNumbîSI¡64Ty≥
, &
ªads
);

1609 i‡((
numbî
 = (
CFNumbîRef
)
	`CFDi˘i⁄¨yGëVÆue
(

1610 
°©s_di˘
,

1611 
	`CFSTR
(
kIOBlockSt‹ageDrivîSèti°icsWrôesKey
))))

1613 
	`CFNumbîGëVÆue
(
numbî
, 
kCFNumbîSI¡64Ty≥
, &
wrôes
);

1617 i‡((
numbî
 = (
CFNumbîRef
)
	`CFDi˘i⁄¨yGëVÆue
(

1618 
°©s_di˘
,

1619 
	`CFSTR
(
kIOBlockSt‹ageDrivîSèti°icsByãsRódKey
))))

1621 
	`CFNumbîGëVÆue
(
numbî
, 
kCFNumbîSI¡64Ty≥
, &
ªad_byãs
);

1623 i‡((
numbî
 = (
CFNumbîRef
)
	`CFDi˘i⁄¨yGëVÆue
(

1624 
°©s_di˘
,

1625 
	`CFSTR
(
kIOBlockSt‹ageDrivîSèti°icsByãsWrôãnKey
))))

1627 
	`CFNumbîGëVÆue
(
numbî
, 
kCFNumbîSI¡64Ty≥
, &
wrôe_byãs
);

1631 i‡((
numbî
 = (
CFNumbîRef
)
	`CFDi˘i⁄¨yGëVÆue
(

1632 
°©s_di˘
,

1633 
	`CFSTR
(
kIOBlockSt‹ageDrivîSèti°icsTŸÆRódTimeKey
))))

1635 
	`CFNumbîGëVÆue
(
numbî
, 
kCFNumbîSI¡64Ty≥
, &
ªad_time
);

1637 i‡((
numbî
 = (
CFNumbîRef
)
	`CFDi˘i⁄¨yGëVÆue
(

1638 
°©s_di˘
,

1639 
	`CFSTR
(
kIOBlockSt‹ageDrivîSèti°icsTŸÆWrôeTimeKey
))))

1641 
	`CFNumbîGëVÆue
(
numbî
, 
kCFNumbîSI¡64Ty≥
, &
wrôe_time
);

1646 
py_disk_öfo
 = 
	`Py_BuûdVÆue
(

1648 
ªads
,

1649 
wrôes
,

1650 
ªad_byãs
,

1651 
wrôe_byãs
,

1652 
ªad_time
 / 1000 / 1000,

1653 
wrôe_time
 / 1000 / 1000);

1654 i‡(!
py_disk_öfo
)

1655 
îr‹
;

1656 i‡(
	`PyDi˘_SëIãmSåög
(
py_ªtdi˘
, 
disk_«me
, 
py_disk_öfo
))

1657 
îr‹
;

1658 
	`Py_DECREF
(
py_disk_öfo
);

1660 
	`CFRñó£
(
∑ª¡_di˘
);

1661 
	`IOObje˘Rñó£
(
∑ª¡
);

1662 
	`CFRñó£
(
¥›s_di˘
);

1663 
	`IOObje˘Rñó£
(
disk
);

1667 
	`IOObje˘Rñó£
 (
disk_li°
);

1669  
py_ªtdi˘
;

1671 
îr‹
:

1672 
	`Py_XDECREF
(
py_disk_öfo
);

1673 
	`Py_DECREF
(
py_ªtdi˘
);

1674  
NULL
;

1675 
	}
}

1681 
PyObje˘
 *

1682 
	$psutû_u£rs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1684 
utmpx
 *
utx
;

1685 
PyObje˘
 *
ªt_li°
 = 
	`PyLi°_New
(0);

1686 
PyObje˘
 *
tu∂e
 = 
NULL
;

1688 i‡(
ªt_li°
 =
NULL
)

1689  
NULL
;

1690 (
utx
 = 
	`gëutxít
()Ë!
NULL
) {

1691 i‡(
utx
->
ut_ty≥
 !
USER_PROCESS
)

1693 
tu∂e
 = 
	`Py_BuûdVÆue
(

1695 
utx
->
ut_u£r
,

1696 
utx
->
ut_löe
,

1697 
utx
->
ut_ho°
,

1698 ()
utx
->
ut_tv
.
tv_£c


1700 i‡(!
tu∂e
) {

1701 
	`ídutxít
();

1702 
îr‹
;

1704 i‡(
	`PyLi°_Aµíd
(
ªt_li°
, 
tu∂e
)) {

1705 
	`ídutxít
();

1706 
îr‹
;

1708 
	`Py_DECREF
(
tu∂e
);

1711 
	`ídutxít
();

1712  
ªt_li°
;

1714 
îr‹
:

1715 
	`Py_XDECREF
(
tu∂e
);

1716 
	`Py_DECREF
(
ªt_li°
);

1717  
NULL
;

1718 
	}
}

1724 
PyMëhodDef


1725 
	gPsutûMëhods
[] =

1729 {"¥oc_«me", 
psutû_¥oc_«me
, 
METH_VARARGS
,

1731 {"¥oc_cmdlöe", 
psutû_¥oc_cmdlöe
, 
METH_VARARGS
,

1733 {"¥oc_exe", 
psutû_¥oc_exe
, 
METH_VARARGS
,

1735 {"¥oc_cwd", 
psutû_¥oc_cwd
, 
METH_VARARGS
,

1737 {"¥oc_µid", 
psutû_¥oc_µid
, 
METH_VARARGS
,

1739 {"¥oc_uids", 
psutû_¥oc_uids
, 
METH_VARARGS
,

1741 {"¥oc_gids", 
psutû_¥oc_gids
, 
METH_VARARGS
,

1743 {"¥oc_˝u_times", 
psutû_¥oc_˝u_times
, 
METH_VARARGS
,

1745 {"¥oc_¸óã_time", 
psutû_¥oc_¸óã_time
, 
METH_VARARGS
,

1748 {"¥oc_mem‹y_öfo", 
psutû_¥oc_mem‹y_öfo
, 
METH_VARARGS
,

1750 {"¥oc_num_thªads", 
psutû_¥oc_num_thªads
, 
METH_VARARGS
,

1752 {"¥oc_°©us", 
psutû_¥oc_°©us
, 
METH_VARARGS
,

1754 {"¥oc_thªads", 
psutû_¥oc_thªads
, 
METH_VARARGS
,

1756 {"¥oc_›í_fûes", 
psutû_¥oc_›í_fûes
, 
METH_VARARGS
,

1758 {"¥oc_num_fds", 
psutû_¥oc_num_fds
, 
METH_VARARGS
,

1760 {"¥oc_num_˘x_swôches", 
psutû_¥oc_num_˘x_swôches
, 
METH_VARARGS
,

1762 {"¥oc_c⁄√˘i⁄s", 
psutû_¥oc_c⁄√˘i⁄s
, 
METH_VARARGS
,

1764 {"¥oc_ây_ƒ", 
psutû_¥oc_ây_ƒ
, 
METH_VARARGS
,

1766 {"¥oc_mem‹y_m≠s", 
psutû_¥oc_mem‹y_m≠s
, 
METH_VARARGS
,

1771 {"pids", 
psutû_pids
, 
METH_VARARGS
,

1773 {"˝u_cou¡_logiˇl", 
psutû_˝u_cou¡_logiˇl
, 
METH_VARARGS
,

1775 {"˝u_cou¡_phys", 
psutû_˝u_cou¡_phys
, 
METH_VARARGS
,

1777 {"vútuÆ_mem", 
psutû_vútuÆ_mem
, 
METH_VARARGS
,

1779 {"sw≠_mem", 
psutû_sw≠_mem
, 
METH_VARARGS
,

1781 {"˝u_times", 
psutû_˝u_times
, 
METH_VARARGS
,

1783 {"≥r_˝u_times", 
psutû_≥r_˝u_times
, 
METH_VARARGS
,

1785 {"boŸ_time", 
psutû_boŸ_time
, 
METH_VARARGS
,

1787 {"disk_∑πôi⁄s", 
psutû_disk_∑πôi⁄s
, 
METH_VARARGS
,

1790 {"√t_io_cou¡îs", 
psutû_√t_io_cou¡îs
, 
METH_VARARGS
,

1792 {"disk_io_cou¡îs", 
psutû_disk_io_cou¡îs
, 
METH_VARARGS
,

1794 {"u£rs", 
psutû_u£rs
, 
METH_VARARGS
,

1797 {
NULL
, NULL, 0, NULL}

1801 
	smoduÀ_°©e
 {

1802 
PyObje˘
 *
	mîr‹
;

1805 #i‡
PY_MAJOR_VERSION
 >= 3

1806 
	#GETSTATE
(
m
Ë((
moduÀ_°©e
*)
	`PyModuÀ_GëSèã
(m))

	)

1808 
	#GETSTATE
(
m
Ë(&
_°©e
)

	)

1811 #i‡
PY_MAJOR_VERSION
 >= 3

1814 
	$psutû_osx_åavî£
(
PyObje˘
 *
m
, 
visô¥oc
 
visô
, *
¨g
) {

1815 
	`Py_VISIT
(
	`GETSTATE
(
m
)->
îr‹
);

1817 
	}
}

1820 
	$psutû_osx_˛ór
(
PyObje˘
 *
m
) {

1821 
	`Py_CLEAR
(
	`GETSTATE
(
m
)->
îr‹
);

1823 
	}
}

1826 
PyModuÀDef
 
	gmoduÀdef
 = {

1827 
PyModuÀDef_HEAD_INIT
,

1829 
NULL
,

1830 (
moduÀ_°©e
),

1831 
PsutûMëhods
,

1832 
NULL
,

1833 
psutû_osx_åavî£
,

1834 
psutû_osx_˛ór
,

1835 
NULL


1838 
	#INITERROR
  
NULL


	)

1840 
PyMODINIT_FUNC
 
	$PyInô__psutû_osx
()

1843 
	#INITERROR
 

	)

1846 
	$öô_psutû_osx
()

1849 #i‡
PY_MAJOR_VERSION
 >= 3

1850 
PyObje˘
 *
moduÀ
 = 
	`PyModuÀ_Cª©e
(&
moduÀdef
);

1852 
PyObje˘
 *
moduÀ
 = 
	`Py_InôModuÀ
("_psutû_osx", 
PsutûMëhods
);

1856 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SIDL", 
SIDL
);

1857 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SRUN", 
SRUN
);

1858 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SSLEEP", 
SSLEEP
);

1859 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SSTOP", 
SSTOP
);

1860 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SZOMB", 
SZOMB
);

1862 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSED", 
TCPS_CLOSED
);

1863 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSING", 
TCPS_CLOSING
);

1864 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSE_WAIT", 
TCPS_CLOSE_WAIT
);

1865 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_LISTEN", 
TCPS_LISTEN
);

1866 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_ESTABLISHED", 
TCPS_ESTABLISHED
);

1867 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_SYN_SENT", 
TCPS_SYN_SENT
);

1868 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_SYN_RECEIVED", 
TCPS_SYN_RECEIVED
);

1869 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_FIN_WAIT_1", 
TCPS_FIN_WAIT_1
);

1870 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_FIN_WAIT_2", 
TCPS_FIN_WAIT_2
);

1871 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_LAST_ACK", 
TCPS_LAST_ACK
);

1872 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_TIME_WAIT", 
TCPS_TIME_WAIT
);

1873 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "PSUTIL_CONN_NONE", 
PSUTIL_CONN_NONE
);

1875 i‡(
moduÀ
 =
NULL
) {

1876 
INITERROR
;

1878 #i‡
PY_MAJOR_VERSION
 >= 3

1879  
moduÀ
;

1881 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_osx.h

7 
	~<Pyth⁄.h
>

10 
PyObje˘
* 
psutû_¥oc_cmdlöe
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

11 
PyObje˘
* 
psutû_¥oc_c⁄√˘i⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

12 
PyObje˘
* 
psutû_¥oc_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

13 
PyObje˘
* 
psutû_¥oc_¸óã_time
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

14 
PyObje˘
* 
psutû_¥oc_cwd
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

15 
PyObje˘
* 
psutû_¥oc_exe
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

16 
PyObje˘
* 
psutû_¥oc_gids
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

17 
PyObje˘
* 
psutû_¥oc_mem‹y_öfo
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

18 
PyObje˘
* 
psutû_¥oc_mem‹y_m≠s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

19 
PyObje˘
* 
psutû_¥oc_«me
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

20 
PyObje˘
* 
psutû_¥oc_num_fds
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

21 
PyObje˘
* 
psutû_¥oc_num_thªads
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

22 
PyObje˘
* 
psutû_¥oc_›í_fûes
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

23 
PyObje˘
* 
psutû_¥oc_µid
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

24 
PyObje˘
* 
psutû_¥oc_°©us
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

25 
PyObje˘
* 
psutû_¥oc_thªads
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

26 
PyObje˘
* 
psutû_¥oc_ây_ƒ
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

27 
PyObje˘
* 
psutû_¥oc_uids
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

30 
PyObje˘
* 
psutû_boŸ_time
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

31 
PyObje˘
* 
psutû_˝u_cou¡_logiˇl
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

32 
PyObje˘
* 
psutû_˝u_cou¡_phys
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

33 
PyObje˘
* 
psutû_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

34 
PyObje˘
* 
psutû_disk_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

35 
PyObje˘
* 
psutû_disk_∑πôi⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

36 
PyObje˘
* 
psutû_√t_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

37 
PyObje˘
* 
psutû_≥r_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

38 
PyObje˘
* 
psutû_pids
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

39 
PyObje˘
* 
psutû_sw≠_mem
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

40 
PyObje˘
* 
psutû_u£rs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

41 
PyObje˘
* 
psutû_vútuÆ_mem
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_posix.c

9 
	~<Pyth⁄.h
>

10 
	~<î∫o.h
>

11 
	~<°dlib.h
>

12 
	~<sys/ªsour˚.h
>

14 
	~"_psutû_posix.h
"

20 
PyObje˘
 *

21 
	$psutû_posix_gë¥i‹ôy
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

23 
pid
;

24 
¥i‹ôy
;

25 
î∫o
 = 0;

26 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

27  
NULL
;

29 
¥i‹ôy
 = 
	`gë¥i‹ôy
(
PRIO_PROCESS
, 
pid
);

30 i‡(
î∫o
 != 0) {

31  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

33  
	`Py_BuûdVÆue
("i", 
¥i‹ôy
);

34 
	}
}

40 
PyObje˘
 *

41 
	$psutû_posix_£çri‹ôy
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

43 
pid
;

44 
¥i‹ôy
;

45 
ªtvÆ
;

46 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "li", &
pid
, &
¥i‹ôy
)) {

47  
NULL
;

49 
ªtvÆ
 = 
	`£çri‹ôy
(
PRIO_PROCESS
, 
pid
, 
¥i‹ôy
);

50 i‡(
ªtvÆ
 == -1) {

51  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

53 
	`Py_INCREF
(
Py_N⁄e
);

54  
Py_N⁄e
;

55 
	}
}

61 
PyMëhodDef


62 
	gPsutûMëhods
[] =

64 {"gë¥i‹ôy", 
psutû_posix_gë¥i‹ôy
, 
METH_VARARGS
,

66 {"£çri‹ôy", 
psutû_posix_£çri‹ôy
, 
METH_VARARGS
,

68 {
NULL
, NULL, 0, NULL}

71 
	smoduÀ_°©e
 {

72 
PyObje˘
 *
	mîr‹
;

75 #i‡
PY_MAJOR_VERSION
 >= 3

76 
	#GETSTATE
(
m
Ë((
moduÀ_°©e
*)
	`PyModuÀ_GëSèã
(m))

	)

78 
	#GETSTATE
(
m
Ë(&
_°©e
)

	)

81 #i‡
PY_MAJOR_VERSION
 >= 3

84 
	$psutû_posix_åavî£
(
PyObje˘
 *
m
, 
visô¥oc
 
visô
, *
¨g
) {

85 
	`Py_VISIT
(
	`GETSTATE
(
m
)->
îr‹
);

87 
	}
}

90 
	$psutû_posix_˛ór
(
PyObje˘
 *
m
) {

91 
	`Py_CLEAR
(
	`GETSTATE
(
m
)->
îr‹
);

93 
	}
}

95 
PyModuÀDef
 
	gmoduÀdef
 = {

96 
PyModuÀDef_HEAD_INIT
,

98 
NULL
,

99 (
moduÀ_°©e
),

100 
PsutûMëhods
,

101 
NULL
,

102 
psutû_posix_åavî£
,

103 
psutû_posix_˛ór
,

104 
NULL


107 
	#INITERROR
  
NULL


	)

109 
PyMODINIT_FUNC
 
	$PyInô__psutû_posix
()

112 
	#INITERROR
 

	)

114 
	$öô_psutû_posix
()

117 #i‡
PY_MAJOR_VERSION
 >= 3

118 
PyObje˘
 *
moduÀ
 = 
	`PyModuÀ_Cª©e
(&
moduÀdef
);

120 
PyObje˘
 *
moduÀ
 = 
	`Py_InôModuÀ
("_psutû_posix", 
PsutûMëhods
);

122 i‡(
moduÀ
 =
NULL
) {

123 
INITERROR
;

125 #i‡
PY_MAJOR_VERSION
 >= 3

126  
moduÀ
;

128 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_posix.h

7 
	~<Pyth⁄.h
>

9 
PyObje˘
* 
psutû_posix_gë¥i‹ôy
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

10 
PyObje˘
* 
psutû_posix_£çri‹ôy
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_sunos.c

13 
	~<Pyth⁄.h
>

18 #unde‡
_FILE_OFFSET_BITS


19 
	#_STRUCTURED_PROC
 1

	)

23 
	#NEW_MIB_COMPLIANT


	)

25 
	~<sys/ty≥s.h
>

26 
	~<sys/°©.h
>

27 
	~<sys/¥oc.h
>

28 
	~<sys/sw≠.h
>

29 
	~<sys/sysöfo.h
>

30 
	~<sys/m¡ít.h
>

31 
	~<sys/m¡èb.h
>

32 
	~<sys/¥ocfs.h
>

33 
	~<f˙é.h
>

34 
	~<utmpx.h
>

35 
	~<k°©.h
>

36 
	~<sys/io˘l.h
>

37 
	~<sys/tihdr.h
>

38 
	~<°r›ts.h
>

39 
	~<öë/t˝.h
>

40 
	~<¨∑/öë.h
>

42 
	~"_psutû_sunos.h
"

45 
	#TV2DOUBLE
(
t
Ë((—).
tv_n£c
 * 0.000000001Ë+ (t).
tv_£c
)

	)

51 
	$psutû_fûe_to_°ru˘
(*
∑th
, *
f°ru˘
, 
size_t
 
size
)

53 
fd
;

54 
size_t
 
nbyãs
;

55 
fd
 = 
	`›í
(
∑th
, 
O_RDONLY
);

56 i‡(
fd
 == -1) {

57 
	`PyEº_SëFromEºnoWôhFûíame
(
PyExc_OSEº‹
, 
∑th
);

60 
nbyãs
 = 
	`ªad
(
fd
, 
f°ru˘
, 
size
);

61 i‡(
nbyãs
 <= 0) {

62 
	`˛o£
(
fd
);

63 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

66 i‡(
nbyãs
 !
size
) {

67 
	`˛o£
(
fd
);

68 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "structure size mismatch");

71 
	`˛o£
(
fd
);

72  
nbyãs
;

73 
	}
}

80 
PyObje˘
 *

81 
	$psutû_¥oc_basic_öfo
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

83 
pid
;

84 
∑th
[100];

85 
psöfo_t
 
öfo
;

87 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

88  
NULL
;

89 
	`•rötf
(
∑th
, "/¥oc/%i/psöfo", 
pid
);

90 i‡(! 
	`psutû_fûe_to_°ru˘
(
∑th
, (*)&
öfo
, (info)))

91  
NULL
;

92  
	`Py_BuûdVÆue
("ikkdiiik",

93 
öfo
.
¥_µid
,

94 
öfo
.
¥_rssize
,

95 
öfo
.
¥_size
,

96 
	`TV2DOUBLE
(
öfo
.
¥_°¨t
),

97 
öfo
.
¥_lwp
.
¥_ni˚
,

98 
öfo
.
¥_∆wp
,

99 
öfo
.
¥_lwp
.
¥_°©e
,

100 
öfo
.
¥_âydev


102 
	}
}

108 
PyObje˘
 *

109 
	$psutû_¥oc_«me_™d_¨gs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

111 
pid
;

112 
∑th
[100];

113 
psöfo_t
 
öfo
;

115 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

116  
NULL
;

117 
	`•rötf
(
∑th
, "/¥oc/%i/psöfo", 
pid
);

118 i‡(! 
	`psutû_fûe_to_°ru˘
(
∑th
, (*)&
öfo
, (info)))

119  
NULL
;

120  
	`Py_BuûdVÆue
("ss", 
öfo
.
¥_‚ame
, info.
¥_pßrgs
);

121 
	}
}

127 
PyObje˘
 *

128 
	$psutû_¥oc_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

130 
pid
;

131 
∑th
[100];

132 
p°©us_t
 
öfo
;

134 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

135  
NULL
;

136 
	`•rötf
(
∑th
, "/¥oc/%i/°©us", 
pid
);

137 i‡(! 
	`psutû_fûe_to_°ru˘
(
∑th
, (*)&
öfo
, (info)))

138  
NULL
;

140  
	`Py_BuûdVÆue
("dd",

141 
	`TV2DOUBLE
(
öfo
.
¥_utime
),

142 
	`TV2DOUBLE
(
öfo
.
¥_°ime
));

143 
	}
}

149 
PyObje˘
 *

150 
	$psutû_¥oc_¸ed
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

152 
pid
;

153 
∑th
[100];

154 
¥¸ed_t
 
öfo
;

156 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

157  
NULL
;

158 
	`•rötf
(
∑th
, "/¥oc/%i/¸ed", 
pid
);

159 i‡(! 
	`psutû_fûe_to_°ru˘
(
∑th
, (*)&
öfo
, (info)))

160  
NULL
;

161  
	`Py_BuûdVÆue
("iiiiii",

162 
öfo
.
¥_ruid
, info.
¥_euid
, info.
¥_suid
,

163 
öfo
.
¥_rgid
, info.
¥_egid
, info.
¥_sgid
);

164 
	}
}

170 
PyObje˘
 *

171 
	$psutû_¥oc_num_˘x_swôches
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

173 
pid
;

174 
∑th
[100];

175 
¥ußge_t
 
öfo
;

177 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
))

178  
NULL
;

179 
	`•rötf
(
∑th
, "/¥oc/%i/ußge", 
pid
);

180 i‡(! 
	`psutû_fûe_to_°ru˘
(
∑th
, (*)&
öfo
, (info)))

181  
NULL
;

182  
	`Py_BuûdVÆue
("kk", 
öfo
.
¥_v˘x
, info.
¥_i˘x
);

183 
	}
}

229 
PyObje˘
 *

230 
	$psutû_¥oc_quîy_thªad
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

232 
pid
, 
tid
;

233 
∑th
[100];

234 
lwp°©us_t
 
öfo
;

236 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "ii", &
pid
, &
tid
))

237  
NULL
;

238 
	`•rötf
(
∑th
, "/¥oc/%i/lwp/%i/lwp°©us", 
pid
, 
tid
);

239 i‡(! 
	`psutû_fûe_to_°ru˘
(
∑th
, (*)&
öfo
, (info)))

240  
NULL
;

241  
	`Py_BuûdVÆue
("dd",

242 
	`TV2DOUBLE
(
öfo
.
¥_utime
),

243 
	`TV2DOUBLE
(
öfo
.
¥_°ime
));

244 
	}
}

250 
PyObje˘
 *

251 
	$psutû_sw≠_mem
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

309 
k°©_˘l_t
 *
kc
;

310 
k°©_t
 *
k
;

311 
˝u_°©_t
 *
˝u
;

312 
˝u_cou¡
 = 0;

313 
Êag
 = 0;

314 
uöt_t
 
sö
 = 0;

315 
uöt_t
 
sout
 = 0;

317 
kc
 = 
	`k°©_›í
();

318 i‡(
kc
 =
NULL
) {

319  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);;

322 
k
 = 
kc
->
kc_chaö
;

323 
k
 !
NULL
) {

324 i‡((
	`°∫cmp
(
k
->
ks_«me
, "cpu_stat", 8) == 0) && \

325 (
	`k°©_ªad
(
kc
, 
k
, 
NULL
) != -1) )

327 
Êag
 = 1;

328 
˝u
 = (
˝u_°©_t
 *Ë
k
->
ks_d©a
;

329 
sö
 +
˝u
->
˝u_vmöfo
.
pgsw≠ö
;

330 
sout
 +
˝u
->
˝u_vmöfo
.
pgsw≠out
;

332 
˝u_cou¡
 += 1;

333 
k
 = k->
ks_√xt
;

335 
	`k°©_˛o£
(
kc
);

336 i‡(!
Êag
) {

337 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "no swap device was found");

338  
NULL
;

340  
	`Py_BuûdVÆue
("(II)", 
sö
, 
sout
);

341 
	}
}

347 
PyObje˘
 *

348 
	$psutû_u£rs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

350 
utmpx
 *
ut
;

351 
PyObje˘
 *
ªt_li°
 = 
	`PyLi°_New
(0);

352 
PyObje˘
 *
tu∂e
 = 
NULL
;

353 
PyObje˘
 *
u£r_¥oc
 = 
NULL
;

355 i‡(
ªt_li°
 =
NULL
)

356  
NULL
;

358 
NULL
 !(
ut
 = 
	`gëutxít
())) {

359 i‡(
ut
->
ut_ty≥
 =
USER_PROCESS
)

360 
u£r_¥oc
 = 
Py_True
;

362 
u£r_¥oc
 = 
Py_FÆ£
;

363 
tu∂e
 = 
	`Py_BuûdVÆue
(

365 
ut
->
ut_u£r
,

366 
ut
->
ut_löe
,

367 
ut
->
ut_ho°
,

368 ()
ut
->
ut_tv
.
tv_£c
,

369 
u£r_¥oc
);

370 i‡(
tu∂e
 =
NULL
)

371 
îr‹
;

372 i‡(
	`PyLi°_Aµíd
(
ªt_li°
, 
tu∂e
))

373 
îr‹
;

374 
	`Py_DECREF
(
tu∂e
);

376 
	`íduã¡
();

378  
ªt_li°
;

380 
îr‹
:

381 
	`Py_XDECREF
(
tu∂e
);

382 
	`Py_DECREF
(
ªt_li°
);

383 i‡(
ut
 !
NULL
)

384 
	`íduã¡
();

385  
NULL
;

386 
	}
}

393 
PyObje˘
 *

394 
	$psutû_disk_∑πôi⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

396 
FILE
 *
fûe
;

397 
m¡èb
 
mt
;

398 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

399 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

401 i‡(
py_ªéi°
 =
NULL
)

402  
NULL
;

404 
fûe
 = 
	`f›í
(
MNTTAB
, "rb");

405 i‡(
fûe
 =
NULL
) {

406 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

407 
îr‹
;

410 
	`gëm¡ít
(
fûe
, &
mt
) == 0) {

411 
py_tu∂e
 = 
	`Py_BuûdVÆue
(

413 
mt
.
m¡_•ecül
,

414 
mt
.
m¡_mou¡p
,

415 
mt
.
m¡_f°y≥
,

416 
mt
.
m¡_m¡›ts
);

417 i‡(
py_tu∂e
 =
NULL
)

418 
îr‹
;

419 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

420 
îr‹
;

421 
	`Py_DECREF
(
py_tu∂e
);

424 
	`f˛o£
(
fûe
);

425  
py_ªéi°
;

427 
îr‹
:

428 
	`Py_XDECREF
(
py_tu∂e
);

429 
	`Py_DECREF
(
py_ªéi°
);

430 i‡(
fûe
 !
NULL
)

431 
	`f˛o£
(
fûe
);

432  
NULL
;

433 
	}
}

439 
PyObje˘
 *

440 
	$psutû_≥r_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

442 
k°©_˘l_t
 *
kc
;

443 
k°©_t
 *
k•
;

444 
˝u_°©_t
 
cs
;

445 
num˝us
;

446 
i
;

447 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

448 
PyObje˘
 *
py_˝utime
 = 
NULL
;

450 i‡(
py_ªéi°
 =
NULL
)

451  
NULL
;

453 
kc
 = 
	`k°©_›í
();

454 i‡(
kc
 =
NULL
) {

455 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

456 
îr‹
;

459 
num˝us
 = 
	`sysc⁄f
(
_SC_NPROCESSORS_ONLN
) - 1;

460 
i
 = 0; i <
num˝us
; i++) {

461 
k•
 = 
	`k°©_lookup
(
kc
, "˝u_°©", 
i
, 
NULL
);

462 i‡(
k•
 =
NULL
) {

463 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

464 
îr‹
;

466 i‡(
	`k°©_ªad
(
kc
, 
k•
, &
cs
) == -1) {

467 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

468 
îr‹
;

471 
py_˝utime
 = 
	`Py_BuûdVÆue
("ffff",

472 ()
cs
.
˝u_sysöfo
.
˝u
[
CPU_USER
],

473 ()
cs
.
˝u_sysöfo
.
˝u
[
CPU_KERNEL
],

474 ()
cs
.
˝u_sysöfo
.
˝u
[
CPU_IDLE
],

475 ()
cs
.
˝u_sysöfo
.
˝u
[
CPU_WAIT
]);

476 i‡(
py_˝utime
 =
NULL
)

477 
îr‹
;

478 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_˝utime
))

479 
îr‹
;

480 
	`Py_DECREF
(
py_˝utime
);

484 
	`k°©_˛o£
(
kc
);

485  
py_ªéi°
;

487 
îr‹
:

488 
	`Py_XDECREF
(
py_˝utime
);

489 
	`Py_DECREF
(
py_ªéi°
);

490 i‡(
kc
 !
NULL
)

491 
	`k°©_˛o£
(
kc
);

492  
NULL
;

493 
	}
}

499 
PyObje˘
 *

500 
	$psutû_disk_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

502 
k°©_˘l_t
 *
kc
;

503 
k°©_t
 *
k•
;

504 
k°©_io_t
 
kio
;

505 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

506 
PyObje˘
 *
py_disk_öfo
 = 
NULL
;

508 i‡(
py_ªtdi˘
 =
NULL
)

509  
NULL
;

510 
kc
 = 
	`k°©_›í
();

511 i‡(
kc
 =
NULL
) {

512 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);;

513 
îr‹
;

515 
k•
 = 
kc
->
kc_chaö
;

516 
k•
 !
NULL
) {

517 i‡(
k•
->
ks_ty≥
 =
KSTAT_TYPE_IO
) {

518 i‡(
	`°rcmp
(
k•
->
ks_˛ass
, "disk") == 0) {

519 i‡(
	`k°©_ªad
(
kc
, 
k•
, &
kio
) == -1) {

520 
	`k°©_˛o£
(
kc
);

521  
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);;

523 
py_disk_öfo
 = 
	`Py_BuûdVÆue
(

525 
kio
.
ªads
,

526 
kio
.
wrôes
,

527 
kio
.
ƒód
,

528 
kio
.
nwrôãn
,

529 
kio
.
πime
 / 1000 / 1000,

530 
kio
.
wtime
 / 1000 / 1000

532 i‡(!
py_disk_öfo
)

533 
îr‹
;

534 i‡(
	`PyDi˘_SëIãmSåög
(
py_ªtdi˘
, 
k•
->
ks_«me
,

535 
py_disk_öfo
))

536 
îr‹
;

537 
	`Py_DECREF
(
py_disk_öfo
);

540 
k•
 = k•->
ks_√xt
;

542 
	`k°©_˛o£
(
kc
);

544  
py_ªtdi˘
;

546 
îr‹
:

547 
	`Py_XDECREF
(
py_disk_öfo
);

548 
	`Py_DECREF
(
py_ªtdi˘
);

549 i‡(
kc
 !
NULL
)

550 
	`k°©_˛o£
(
kc
);

551  
NULL
;

552 
	}
}

558 
PyObje˘
 *

559 
	$psutû_¥oc_mem‹y_m≠s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

561 
pid
;

562 
fd
 = -1;

563 
∑th
[100];

564 
≥rms
[10];

565 *
«me
;

566 
°©
 
°
;

567 
p°©us_t
 
°©us
;

569 
¥xm≠_t
 *
xm≠
 = 
NULL
, *
p
;

570 
off_t
 
size
;

571 
size_t
 
ƒód
;

572 
nm≠
;

573 
uöçå_t
 
¥_addr_sz
;

574 
uöçå_t
 
°k_ba£_sz
, 
brk_ba£_sz
;

576 
PyObje˘
 *
pytu∂e
 = 
NULL
;

577 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

579 i‡(
py_ªéi°
 =
NULL
) {

580  
NULL
;

582 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "i", &
pid
)) {

583 
îr‹
;

586 
	`•rötf
(
∑th
, "/¥oc/%i/°©us", 
pid
);

587 i‡(! 
	`psutû_fûe_to_°ru˘
(
∑th
, (*)&
°©us
, (status))) {

588 
îr‹
;

591 
	`•rötf
(
∑th
, "/¥oc/%i/xm≠", 
pid
);

592 i‡(
	`°©
(
∑th
, &
°
) == -1) {

593 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

594 
îr‹
;

597 
size
 = 
°
.
°_size
;

599 
fd
 = 
	`›í
(
∑th
, 
O_RDONLY
);

600 i‡(
fd
 == -1) {

601 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

602 
îr‹
;

605 
xm≠
 = (
¥xm≠_t
 *)
	`mÆloc
(
size
);

606 i‡(
xm≠
 =
NULL
) {

607 
	`PyEº_NoMem‹y
();

608 
îr‹
;

611 
ƒód
 = 
	`¥ód
(
fd
, 
xm≠
, 
size
, 0);

612 
nm≠
 = 
ƒód
 / (
¥xm≠_t
);

613 
p
 = 
xm≠
;

615 
nm≠
) {

616 
nm≠
 -= 1;

617 i‡(
p
 =
NULL
) {

618 
p
 += 1;

622 
≥rms
[0] = '\0';

623 
¥_addr_sz
 = 
p
->
¥_vaddr
 +Ö->
¥_size
;

626 
	`•rötf
(
≥rms
, "%c%c%c%c%c%c", 
p
->
¥_mÊags
 & 
MA_READ
 ? 'r' : '-',

627 
p
->
¥_mÊags
 & 
MA_WRITE
 ? 'w' : '-',

628 
p
->
¥_mÊags
 & 
MA_EXEC
 ? 'x' : '-',

629 
p
->
¥_mÊags
 & 
MA_SHARED
 ? 's' : '-',

630 
p
->
¥_mÊags
 & 
MA_NORESERVE
 ? 'R' : '-',

631 
p
->
¥_mÊags
 & 
MA_RESERVED1
 ? '*' : ' ');

634 i‡(
	`°æí
(
p
->
¥_m≠«me
) > 0) {

635 
«me
 = 
p
->
¥_m≠«me
;

638 i‡((
p
->
¥_mÊags
 & 
MA_ISM
Ë|| (p->¥_mÊag†& 
MA_SHM
)) {

639 
«me
 = "[shmid]";

642 
°k_ba£_sz
 = 
°©us
.
¥_°kba£
 + sètus.
¥_°ksize
;

643 
brk_ba£_sz
 = 
°©us
.
¥_brkba£
 + sètus.
¥_brksize
;

645 i‡((
¥_addr_sz
 > 
°©us
.
¥_°kba£
) &&

646 (
p
->
¥_vaddr
 < 
°k_ba£_sz
)) {

647 
«me
 = "[stack]";

649 i‡((
p
->
¥_mÊags
 & 
MA_ANON
) && \

650 (
¥_addr_sz
 > 
°©us
.
¥_brkba£
) && \

651 (
p
->
¥_vaddr
 < 
brk_ba£_sz
)) {

652 
«me
 = "[heap]";

655 
«me
 = "[anon]";

660 
pytu∂e
 = 
	`Py_BuûdVÆue
("iisslll",

661 
p
->
¥_vaddr
,

662 
¥_addr_sz
,

663 
≥rms
,

664 
«me
,

665 ()
p
->
¥_rss
 *Ö->
¥_∑gesize
,

666 ()
p
->
¥_™⁄
 *Ö->
¥_∑gesize
,

667 ()
p
->
¥_locked
 *Ö->
¥_∑gesize
);

668 i‡(!
pytu∂e
)

669 
îr‹
;

670 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
pytu∂e
))

671 
îr‹
;

672 
	`Py_DECREF
(
pytu∂e
);

675 
p
 += 1;

678 
	`˛o£
(
fd
);

679 
	`‰ì
(
xm≠
);

680  
py_ªéi°
;

682 
îr‹
:

683 i‡(
fd
 != -1)

684 
	`˛o£
(
fd
);

685 
	`Py_XDECREF
(
pytu∂e
);

686 
	`Py_DECREF
(
py_ªéi°
);

687 i‡(
xm≠
 !
NULL
)

688 
	`‰ì
(
xm≠
);

689  
NULL
;

690 
	}
}

696 
PyObje˘
 *

697 
	$psutû_√t_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

699 
k°©_˘l_t
 *
kc
 = 
NULL
;

700 
k°©_t
 *
k•
;

701 
k°©_«med_t
 *
rbyãs
, *
wbyãs
, *
Ωkts
, *
wpkts
, *
õºs
, *
€ºs
;

703 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

704 
PyObje˘
 *
py_ifc_öfo
 = 
NULL
;

706 i‡(
py_ªtdi˘
 =
NULL
)

707  
NULL
;

708 
kc
 = 
	`k°©_›í
();

709 i‡(
kc
 =
NULL
)

710 
îr‹
;

712 
k•
 = 
kc
->
kc_chaö
;

713 
k•
 !
NULL
) {

714 i‡(
k•
->
ks_ty≥
 !
KSTAT_TYPE_NAMED
)

715 
√xt
;

716 i‡(
	`°rcmp
(
k•
->
ks_˛ass
, "net") != 0)

717 
√xt
;

725 i‡((
	`°rcmp
(
k•
->
ks_moduÀ
, "link") != 0)) {

726 
√xt
;

729 i‡(
	`k°©_ªad
(
kc
, 
k•
, 
NULL
) == -1) {

730 
î∫o
 = 0;

734 
rbyãs
 = (
k°©_«med_t
 *)
	`k°©_d©a_lookup
(
k•
, "rbytes");

735 
wbyãs
 = (
k°©_«med_t
 *)
	`k°©_d©a_lookup
(
k•
, "obytes");

736 
Ωkts
 = (
k°©_«med_t
 *)
	`k°©_d©a_lookup
(
k•
, "ipackets");

737 
wpkts
 = (
k°©_«med_t
 *)
	`k°©_d©a_lookup
(
k•
, "opackets");

738 
õºs
 = (
k°©_«med_t
 *)
	`k°©_d©a_lookup
(
k•
, "ierrors");

739 
€ºs
 = (
k°©_«med_t
 *)
	`k°©_d©a_lookup
(
k•
, "oerrors");

741 i‡((
rbyãs
 =
NULL
Ë|| (
wbyãs
 =NULLË|| (
Ωkts
 == NULL) ||

742 (
wpkts
 =
NULL
Ë|| (
õºs
 =NULLË|| (
€ºs
 == NULL))

744 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "kstat_data_lookup() failed");

745 
îr‹
;

748 #i‡
	`deföed
(
_INT64_TYPE
)

749 
py_ifc_öfo
 = 
	`Py_BuûdVÆue
("(KKKKkkii)",

750 
rbyãs
->
vÆue
.
ui64
,

751 
wbyãs
->
vÆue
.
ui64
,

752 
Ωkts
->
vÆue
.
ui64
,

753 
wpkts
->
vÆue
.
ui64
,

754 
õºs
->
vÆue
.
ui32
,

755 
€ºs
->
vÆue
.
ui32
,

757 
py_ifc_öfo
 = 
	`Py_BuûdVÆue
("(kkkkkkii)",

758 
rbyãs
->
vÆue
.
ui32
,

759 
wbyãs
->
vÆue
.
ui32
,

760 
Ωkts
->
vÆue
.
ui32
,

761 
wpkts
->
vÆue
.
ui32
,

762 
õºs
->
vÆue
.
ui32
,

763 
€ºs
->
vÆue
.
ui32
,

768 i‡(!
py_ifc_öfo
)

769 
îr‹
;

770 i‡(
	`PyDi˘_SëIãmSåög
(
py_ªtdi˘
, 
k•
->
ks_«me
, 
py_ifc_öfo
))

771 
îr‹
;

772 
	`Py_DECREF
(
py_ifc_öfo
);

773 
√xt
;

775 
√xt
:

776 
k•
 = k•->
ks_√xt
;

779 
	`k°©_˛o£
(
kc
);

780  
py_ªtdi˘
;

782 
îr‹
:

783 
	`Py_XDECREF
(
py_ifc_öfo
);

784 
	`Py_DECREF
(
py_ªtdi˘
);

785 i‡(
kc
 !
NULL
)

786 
	`k°©_˛o£
(
kc
);

787  
NULL
;

788 
	}
}

791 #i‚de‡
EXPER_IP_AND_ALL_IRES


792 
	#EXPER_IP_AND_ALL_IRES
 (1024+4)

	)

796 
	gPSUTIL_CONN_NONE
 = 128;

809 
PyObje˘
 *

810 
	$psutû_√t_c⁄√˘i⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

812 
pid
;

813 
sd
 = 
NULL
;

814 
mib2_t˝C⁄nE¡ry_t
 *
ç
 = 
NULL
;

815 
mib2_udpE¡ry_t
 *
ude
;

816 #i‡
	`deföed
(
AF_INET6
)

817 
mib2_t˝6C⁄nE¡ry_t
 *
ç6
;

818 
mib2_udp6E¡ry_t
 *
ude6
;

820 
buf
[512];

821 
i
, 
Êags
, 
gëcode
, 
num_ít
, 
°©e
;

822 
lù
[200], 
rù
[200];

823 
Õ‹t
, 
Ω‹t
;

824 
¥o˚s£d_pid
;

825 
°rbuf
 
˘lbuf
, 
d©abuf
;

826 
T_›tmgmt_ªq
 *
t‹
 = (T_›tmgmt_ªq *)
buf
;

827 
T_›tmgmt_ack
 *
tﬂ
 = (T_›tmgmt_ack *)
buf
;

828 
T_îr‹_ack
 *
ãa
 = (T_îr‹_ack *)
buf
;

829 
›thdr
 *
mibhdr
;

831 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

832 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

833 
PyObje˘
 *
py_œddr
 = 
NULL
;

834 
PyObje˘
 *
py_øddr
 = 
NULL
;

835 
PyObje˘
 *
af_fûãr
 = 
NULL
;

836 
PyObje˘
 *
ty≥_fûãr
 = 
NULL
;

838 i‡(
py_ªéi°
 =
NULL
)

839  
NULL
;

840 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "lOO", &
pid
, &
af_fûãr
, &
ty≥_fûãr
))

841 
îr‹
;

842 i‡(!
	`PySequí˚_Check
(
af_fûãr
Ë|| !PySequí˚_Check(
ty≥_fûãr
)) {

843 
	`PyEº_SëSåög
(
PyExc_Ty≥Eº‹
, "arg 2 or 3 isÇotá sequence");

844 
îr‹
;

847 
sd
 = 
	`›í
("/dev/¨p", 
O_RDWR
);

848 i‡(
sd
 == -1) {

849 
	`PyEº_SëFromEºnoWôhFûíame
(
PyExc_OSEº‹
, "/dev/arp");

850 
îr‹
;

871 
t‹
->
PRIM_ty≥
 = 
T_SVR4_OPTMGMT_REQ
;

872 
t‹
->
OPT_off£t
 =  (
T_›tmgmt_ªq
);

873 
t‹
->
OPT_Àngth
 =  (
›thdr
);

874 
t‹
->
MGMT_Êags
 = 
T_CURRENT
;

875 
mibhdr
 = (
›thdr
 *)&
t‹
[1];

876 
mibhdr
->
Àvñ
 = 
EXPER_IP_AND_ALL_IRES
;

877 
mibhdr
->
«me
 = 0;

878 
mibhdr
->
Àn
 = 0;

880 
˘lbuf
.
buf
 = buf;

881 
˘lbuf
.
Àn
 = 
t‹
->
OPT_off£t
 +Å‹->
OPT_Àngth
;

882 
Êags
 = 0;

884 i‡(
	`putmsg
(
sd
, &
˘lbuf
, (
°rbuf
 *)0, 
Êags
) == -1) {

885 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

886 
îr‹
;

889 
mibhdr
 = (
›thdr
 *)&
tﬂ
[1];

890 
˘lbuf
.
maxÀn
 =  (
buf
);

893 
Êags
 = 0;

894 
gëcode
 = 
	`gëmsg
(
sd
, &
˘lbuf
, (
°rbuf
 *)0, &
Êags
);

896 i‡(
gëcode
 !
MOREDATA
 ||

897 
˘lbuf
.
Àn
 <  (
T_›tmgmt_ack
) ||

898 
tﬂ
->
PRIM_ty≥
 !
T_OPTMGMT_ACK
 ||

899 
tﬂ
->
MGMT_Êags
 !
T_SUCCESS
)

903 i‡(
˘lbuf
.
Àn
 > (
T_îr‹_ack
) &&

904 
ãa
->
PRIM_ty≥
 =
T_ERROR_ACK
)

906 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "ERROR_ACK");

907 
îr‹
;

909 i‡(
gëcode
 == 0 &&

910 
˘lbuf
.
Àn
 > (
T_›tmgmt_ack
) &&

911 
tﬂ
->
PRIM_ty≥
 =
T_OPTMGMT_ACK
 &&

912 
tﬂ
->
MGMT_Êags
 =
T_SUCCESS
)

914 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "ERROR_T_OPTMGMT_ACK");

915 
îr‹
;

918 
d©abuf
.
maxÀn
 = 
mibhdr
->
Àn
;

919 
d©abuf
.
Àn
 = 0;

920 
d©abuf
.
buf
 = (*)
	`mÆloc
(()
mibhdr
->
Àn
);

921 i‡(!
d©abuf
.
buf
) {

922 
	`PyEº_NoMem‹y
();

923 
îr‹
;

926 
Êags
 = 0;

927 
gëcode
 = 
	`gëmsg
(
sd
, (
°rbuf
 *)0, &
d©abuf
, &
Êags
);

928 i‡(
gëcode
 < 0) {

929 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

930 
îr‹
;

934 i‡(
mibhdr
->
Àvñ
 =
MIB2_TCP
 && mibhdr->
«me
 =
MIB2_TCP_13
) {

935 
ç
 = (
mib2_t˝C⁄nE¡ry_t
 *)
d©abuf
.
buf
;

936 
num_ít
 = 
mibhdr
->
Àn
 / (
mib2_t˝C⁄nE¡ry_t
);

937 
i
 = 0; i < 
num_ít
; i++, 
ç
++) {

938 
¥o˚s£d_pid
 = 
ç
->
t˝C⁄nCª©i⁄Pro˚ss
;

939 i‡(
pid
 !-1 && 
¥o˚s£d_pid
 !=Öid)

942 
	`öë_¡›
(
AF_INET
, &
ç
->
t˝C⁄nLoˇlAddªss
, 
lù
, (lip));

943 
	`öë_¡›
(
AF_INET
, &
ç
->
t˝C⁄nRemAddªss
, 
rù
, (rip));

944 
Õ‹t
 = 
ç
->
t˝C⁄nLoˇlP‹t
;

945 
Ω‹t
 = 
ç
->
t˝C⁄nRemP‹t
;

948 
py_œddr
 = 
	`Py_BuûdVÆue
("(si)", 
lù
, 
Õ‹t
);

949 i‡(!
py_œddr
)

950 
îr‹
;

951 i‡(
Ω‹t
 != 0) {

952 
py_øddr
 = 
	`Py_BuûdVÆue
("(si)", 
rù
, 
Ω‹t
);

955 
py_øddr
 = 
	`Py_BuûdVÆue
("()");

957 i‡(!
py_øddr
)

958 
îr‹
;

959 
°©e
 = 
ç
->
t˝C⁄nE¡ryInfo
.
˚_°©e
;

962 
py_tu∂e
 = 
	`Py_BuûdVÆue
("(iiiNNiI)", -1, 
AF_INET
, 
SOCK_STREAM
,

963 
py_œddr
, 
py_øddr
, 
°©e
,

964 
¥o˚s£d_pid
);

965 i‡(!
py_tu∂e
) {

966 
îr‹
;

968 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

969 
îr‹
;

970 
	`Py_DECREF
(
py_tu∂e
);

973 #i‡
	`deföed
(
AF_INET6
)

975 i‡(
mibhdr
->
Àvñ
 =
MIB2_TCP6
 && mibhdr->
«me
 =
MIB2_TCP6_CONN
)

977 
ç6
 = (
mib2_t˝6C⁄nE¡ry_t
 *)
d©abuf
.
buf
;

978 
num_ít
 = 
mibhdr
->
Àn
 / (
mib2_t˝6C⁄nE¡ry_t
);

980 
i
 = 0; i < 
num_ít
; i++, 
ç6
++) {

981 
¥o˚s£d_pid
 = 
ç6
->
t˝6C⁄nCª©i⁄Pro˚ss
;

982 i‡(
pid
 !-1 && 
¥o˚s£d_pid
 !=Öid)

985 
	`öë_¡›
(
AF_INET6
, &
ç6
->
t˝6C⁄nLoˇlAddªss
, 
lù
, (lip));

986 
	`öë_¡›
(
AF_INET6
, &
ç6
->
t˝6C⁄nRemAddªss
, 
rù
, (rip));

987 
Õ‹t
 = 
ç6
->
t˝6C⁄nLoˇlP‹t
;

988 
Ω‹t
 = 
ç6
->
t˝6C⁄nRemP‹t
;

991 
py_œddr
 = 
	`Py_BuûdVÆue
("(si)", 
lù
, 
Õ‹t
);

992 i‡(!
py_œddr
)

993 
îr‹
;

994 i‡(
Ω‹t
 != 0) {

995 
py_øddr
 = 
	`Py_BuûdVÆue
("(si)", 
rù
, 
Ω‹t
);

998 
py_øddr
 = 
	`Py_BuûdVÆue
("()");

1000 i‡(!
py_øddr
)

1001 
îr‹
;

1002 
°©e
 = 
ç6
->
t˝6C⁄nE¡ryInfo
.
˚_°©e
;

1005 
py_tu∂e
 = 
	`Py_BuûdVÆue
("(iiiNNiI)", -1, 
AF_INET6
, 
SOCK_STREAM
,

1006 
py_œddr
, 
py_øddr
, 
°©e
, 
¥o˚s£d_pid
);

1007 i‡(!
py_tu∂e
) {

1008 
îr‹
;

1010 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

1011 
îr‹
;

1012 
	`Py_DECREF
(
py_tu∂e
);

1017 i‡(
mibhdr
->
Àvñ
 =
MIB2_UDP
 || mibhdr->Àvñ =
MIB2_UDP_ENTRY
) {

1018 
ude
 = (
mib2_udpE¡ry_t
 *)
d©abuf
.
buf
;

1019 
num_ít
 = 
mibhdr
->
Àn
 / (
mib2_udpE¡ry_t
);

1020 
i
 = 0; i < 
num_ít
; i++, 
ude
++) {

1021 
¥o˚s£d_pid
 = 
ude
->
udpCª©i⁄Pro˚ss
;

1022 i‡(
pid
 !-1 && 
¥o˚s£d_pid
 !=Öid)

1029 i‡(
¥o˚s£d_pid
 > 131072)

1031 
	`öë_¡›
(
AF_INET
, &
ude
->
udpLoˇlAddªss
, 
lù
, (lip));

1032 
Õ‹t
 = 
ude
->
udpLoˇlP‹t
;

1033 
py_œddr
 = 
	`Py_BuûdVÆue
("(si)", 
lù
, 
Õ‹t
);

1034 i‡(!
py_œddr
)

1035 
îr‹
;

1036 
py_øddr
 = 
	`Py_BuûdVÆue
("()");

1037 i‡(!
py_øddr
)

1038 
îr‹
;

1039 
py_tu∂e
 = 
	`Py_BuûdVÆue
("(iiiNNiI)", -1, 
AF_INET
, 
SOCK_DGRAM
,

1040 
py_œddr
, 
py_øddr
, 
PSUTIL_CONN_NONE
,

1041 
¥o˚s£d_pid
);

1042 i‡(!
py_tu∂e
) {

1043 
îr‹
;

1045 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

1046 
îr‹
;

1047 
	`Py_DECREF
(
py_tu∂e
);

1050 #i‡
	`deföed
(
AF_INET6
)

1052 i‡(
mibhdr
->
Àvñ
 =
MIB2_UDP6
 || mibhdr->Àvñ =
MIB2_UDP6_ENTRY
) {

1053 
ude6
 = (
mib2_udp6E¡ry_t
 *)
d©abuf
.
buf
;

1054 
num_ít
 = 
mibhdr
->
Àn
 / (
mib2_udp6E¡ry_t
);

1055 
i
 = 0; i < 
num_ít
; i++, 
ude6
++) {

1056 
¥o˚s£d_pid
 = 
ude6
->
udp6Cª©i⁄Pro˚ss
;

1057 i‡(
pid
 !-1 && 
¥o˚s£d_pid
 !=Öid)

1059 
	`öë_¡›
(
AF_INET6
, &
ude6
->
udp6LoˇlAddªss
, 
lù
, (lip));

1060 
Õ‹t
 = 
ude6
->
udp6LoˇlP‹t
;

1061 
py_œddr
 = 
	`Py_BuûdVÆue
("(si)", 
lù
, 
Õ‹t
);

1062 i‡(!
py_œddr
)

1063 
îr‹
;

1064 
py_øddr
 = 
	`Py_BuûdVÆue
("()");

1065 i‡(!
py_øddr
)

1066 
îr‹
;

1067 
py_tu∂e
 = 
	`Py_BuûdVÆue
("(iiiNNiI)", -1, 
AF_INET6
, 
SOCK_DGRAM
,

1068 
py_œddr
, 
py_øddr
, 
PSUTIL_CONN_NONE
,

1069 
¥o˚s£d_pid
);

1070 i‡(!
py_tu∂e
) {

1071 
îr‹
;

1073 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

1074 
îr‹
;

1075 
	`Py_DECREF
(
py_tu∂e
);

1079 
	`‰ì
(
d©abuf
.
buf
);

1082 
	`˛o£
(
sd
);

1083  
py_ªéi°
;

1085 
îr‹
:

1086 
	`Py_XDECREF
(
py_tu∂e
);

1087 
	`Py_XDECREF
(
py_œddr
);

1088 
	`Py_XDECREF
(
py_øddr
);

1089 
	`Py_DECREF
(
py_ªéi°
);

1091 i‡(
sd
 !
NULL
)

1092 
	`˛o£
(
sd
);

1093  
NULL
;

1094 
	}
}

1097 
PyObje˘
 *

1098 
	$psutû_boŸ_time
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1100 
boŸ_time
 = 0.0;

1101 
utmpx
 *
ut
;

1103 
NULL
 !(
ut
 = 
	`gëutxít
())) {

1104 i‡(
ut
->
ut_ty≥
 =
BOOT_TIME
) {

1105 
boŸ_time
 = ()
ut
->
ut_tv
.
tv_£c
;

1109 
	`íduã¡
();

1110 i‡(
boŸ_time
 != 0.0) {

1111  
	`Py_BuûdVÆue
("f", 
boŸ_time
);

1114 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "can't determine bootÅime");

1115  
NULL
;

1117 
	}
}

1123 
PyObje˘
 *

1124 
	$psutû_˝u_cou¡_phys
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1126 
k°©_˘l_t
 *
kc
;

1127 
k°©_t
 *
k•
;

1128 
n˝us
 = 0;

1130 
kc
 = 
	`k°©_›í
();

1131 i‡(
kc
 =
NULL
)

1132 
îr‹
;

1133 
k•
 = 
	`k°©_lookup
(
kc
, "˝u_öfo", -1, 
NULL
);

1134 i‡(
k•
 =
NULL
)

1135 
îr‹
;

1137 
k•
 = 
kc
->
kc_chaö
; k•; k• = k•->
ks_√xt
) {

1138 i‡(
	`°rcmp
(
k•
->
ks_moduÀ
, "cpu_info") != 0)

1140 i‡(
	`k°©_ªad
(
kc
, 
k•
, 
NULL
) == NULL)

1141 
îr‹
;

1142 
n˝us
 += 1;

1145 
	`k°©_˛o£
(
kc
);

1146 i‡(
n˝us
 > 0)

1147  
	`Py_BuûdVÆue
("i", 
n˝us
);

1149 
îr‹
;

1151 
îr‹
:

1153 i‡(
kc
 !
NULL
)

1154 
	`k°©_˛o£
(
kc
);

1155 
	`Py_INCREF
(
Py_N⁄e
);

1156  
Py_N⁄e
;

1157 
	}
}

1163 
PyMëhodDef


1164 
	gPsutûMëhods
[] =

1167 {"¥oc_basic_öfo", 
psutû_¥oc_basic_öfo
, 
METH_VARARGS
,

1169 {"¥oc_«me_™d_¨gs", 
psutû_¥oc_«me_™d_¨gs
, 
METH_VARARGS
,

1171 {"¥oc_˝u_times", 
psutû_¥oc_˝u_times
, 
METH_VARARGS
,

1173 {"¥oc_¸ed", 
psutû_¥oc_¸ed
, 
METH_VARARGS
,

1175 {"quîy_¥o˚ss_thªad", 
psutû_¥oc_quîy_thªad
, 
METH_VARARGS
,

1177 {"¥oc_mem‹y_m≠s", 
psutû_¥oc_mem‹y_m≠s
, 
METH_VARARGS
,

1179 {"¥oc_num_˘x_swôches", 
psutû_¥oc_num_˘x_swôches
, 
METH_VARARGS
,

1183 {"sw≠_mem", 
psutû_sw≠_mem
, 
METH_VARARGS
,

1185 {"u£rs", 
psutû_u£rs
, 
METH_VARARGS
,

1187 {"disk_∑πôi⁄s", 
psutû_disk_∑πôi⁄s
, 
METH_VARARGS
,

1189 {"≥r_˝u_times", 
psutû_≥r_˝u_times
, 
METH_VARARGS
,

1191 {"disk_io_cou¡îs", 
psutû_disk_io_cou¡îs
, 
METH_VARARGS
,

1193 {"√t_io_cou¡îs", 
psutû_√t_io_cou¡îs
, 
METH_VARARGS
,

1195 {"boŸ_time", 
psutû_boŸ_time
, 
METH_VARARGS
,

1197 {"˝u_cou¡_phys", 
psutû_˝u_cou¡_phys
, 
METH_VARARGS
,

1199 {"√t_c⁄√˘i⁄s", 
psutû_√t_c⁄√˘i⁄s
, 
METH_VARARGS
,

1202 {
NULL
, NULL, 0, NULL}

1206 
	smoduÀ_°©e
 {

1207 
PyObje˘
 *
	mîr‹
;

1210 #i‡
PY_MAJOR_VERSION
 >= 3

1211 
	#GETSTATE
(
m
Ë((
moduÀ_°©e
*)
	`PyModuÀ_GëSèã
(m))

	)

1213 
	#GETSTATE
(
m
Ë(&
_°©e
)

	)

1216 #i‡
PY_MAJOR_VERSION
 >= 3

1219 
	$psutû_sunos_åavî£
(
PyObje˘
 *
m
, 
visô¥oc
 
visô
, *
¨g
) {

1220 
	`Py_VISIT
(
	`GETSTATE
(
m
)->
îr‹
);

1222 
	}
}

1225 
	$psutû_sunos_˛ór
(
PyObje˘
 *
m
) {

1226 
	`Py_CLEAR
(
	`GETSTATE
(
m
)->
îr‹
);

1228 
	}
}

1230 
PyModuÀDef
 
	gmoduÀdef
 = {

1231 
PyModuÀDef_HEAD_INIT
,

1233 
NULL
,

1234 (
moduÀ_°©e
),

1235 
PsutûMëhods
,

1236 
NULL
,

1237 
psutû_sunos_åavî£
,

1238 
psutû_sunos_˛ór
,

1239 
NULL


1242 
	#INITERROR
  
NULL


	)

1244 
PyMODINIT_FUNC
 
	$PyInô__psutû_sunos
()

1247 
	#INITERROR
 

	)

1249 
	$öô_psutû_sunos
()

1252 #i‡
PY_MAJOR_VERSION
 >= 3

1253 
PyObje˘
 *
moduÀ
 = 
	`PyModuÀ_Cª©e
(&
moduÀdef
);

1255 
PyObje˘
 *
moduÀ
 = 
	`Py_InôModuÀ
("_psutû_sunos", 
PsutûMëhods
);

1257 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SSLEEP", 
SSLEEP
);

1258 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SRUN", 
SRUN
);

1259 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SZOMB", 
SZOMB
);

1260 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SSTOP", 
SSTOP
);

1261 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SIDL", 
SIDL
);

1262 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SONPROC", 
SONPROC
);

1263 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "SWAIT", 
SWAIT
);

1265 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "PRNODEV", 
PRNODEV
);

1267 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSED", 
TCPS_CLOSED
);

1268 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSING", 
TCPS_CLOSING
);

1269 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_CLOSE_WAIT", 
TCPS_CLOSE_WAIT
);

1270 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_LISTEN", 
TCPS_LISTEN
);

1271 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_ESTABLISHED", 
TCPS_ESTABLISHED
);

1272 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_SYN_SENT", 
TCPS_SYN_SENT
);

1273 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_SYN_RCVD", 
TCPS_SYN_RCVD
);

1274 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_FIN_WAIT_1", 
TCPS_FIN_WAIT_1
);

1275 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_FIN_WAIT_2", 
TCPS_FIN_WAIT_2
);

1276 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_LAST_ACK", 
TCPS_LAST_ACK
);

1277 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_TIME_WAIT", 
TCPS_TIME_WAIT
);

1279 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_IDLE", 
TCPS_IDLE
);

1281 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "TCPS_BOUND", 
TCPS_BOUND
);

1282 
	`PyModuÀ_AddI¡C⁄°™t
(
moduÀ
, "PSUTIL_CONN_NONE", 
PSUTIL_CONN_NONE
);

1284 i‡(
moduÀ
 =
NULL
) {

1285 
INITERROR
;

1287 #i‡
PY_MAJOR_VERSION
 >= 3

1288  
moduÀ
;

1290 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_sunos.h

7 
	~<Pyth⁄.h
>

10 
PyObje˘
* 
psutû_¥oc_basic_öfo
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

11 
PyObje˘
* 
psutû_¥oc_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

12 
PyObje˘
* 
psutû_¥oc_¸ed
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

13 
PyObje˘
* 
psutû_¥oc_mem‹y_m≠s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

14 
PyObje˘
* 
psutû_¥oc_«me_™d_¨gs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

15 
PyObje˘
* 
psutû_¥oc_num_˘x_swôches
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

16 
PyObje˘
* 
psutû_¥oc_quîy_thªad
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

19 
PyObje˘
* 
psutû_boŸ_time
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

20 
PyObje˘
* 
psutû_˝u_cou¡_phys
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

21 
PyObje˘
* 
psutû_disk_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

22 
PyObje˘
* 
psutû_disk_∑πôi⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

23 
PyObje˘
* 
psutû_√t_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

24 
PyObje˘
* 
psutû_≥r_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

25 
PyObje˘
* 
psutû_sw≠_mem
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

26 
PyObje˘
* 
psutû_u£rs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

27 
PyObje˘
* 
psutû_√t_c⁄√˘i⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_windows.c

10 
	#WIN32_LEAN_AND_MEAN


	)

12 
	~<Pyth⁄.h
>

13 
	~<wödows.h
>

14 
	~<Pßpi.h
>

15 
	~<time.h
>

16 
	~<lm.h
>

17 
	~<WöIoCé.h
>

18 
	~<tch¨.h
>

19 
	~<éhñp32.h
>

20 
	~<wösock2.h
>

21 
	~<ùhÕ≠i.h
>

22 
	~<wtßpi32.h
>

25 #¥agm®
commít
(
lib
, "IPHLPAPI.lib")

27 
	~"_psutû_wödows.h
"

28 
	~"_psutû_comm⁄.h
"

29 
	~"¨ch/wödows/£curôy.h
"

30 
	~"¨ch/wödows/¥o˚ss_öfo.h
"

31 
	~"¨ch/wödows/¥o˚ss_h™dÀs.h
"

32 
	~"¨ch/wödows/¡exèpi.h
"

34 #ifde‡
__MINGW32__


35 
	~"¨ch/wödows/gÕi.h
"

42 
PyObje˘
 *

43 
	$psutû_boŸ_time
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

45 
u±ime
;

46 
time_t
 
±
;

47 
FILETIME
 
fûeTime
;

48 
Œ
;

50 
	`GëSy°emTimeAsFûeTime
(&
fûeTime
);

65 
Œ
 = (((
LONGLONG
)(
fûeTime
.
dwHighD©eTime
)) << 32) \

66 + 
fûeTime
.
dwLowD©eTime
;

67 
±
 = (
time_t
)((
Œ
 - 116444736000000000ull) / 10000000ull);

71 
u±ime
 = 
	`GëTickCou¡
() / 1000.00f;

72  
	`Py_BuûdVÆue
("d", ()
±
 - 
u±ime
);

73 
	}
}

79 
PyObje˘
 *

80 
	$psutû_pid_exi°s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

82 
pid
;

83 
°©us
;

85 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

86  
NULL
;

89 
°©us
 = 
	`psutû_pid_is_ru¬ög
(
pid
);

90 i‡(-1 =
°©us
) {

91  
NULL
;

93  
	`PyBoﬁ_FromL⁄g
(
°©us
);

94 
	}
}

100 
PyObje˘
 *

101 
	$psutû_pids
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

103 
DWORD
 *
¥o˛i°
 = 
NULL
;

104 
DWORD
 
numbîOfRëu∫edPIDs
;

105 
DWORD
 
i
;

106 
PyObje˘
 *
pid
 = 
NULL
;

107 
PyObje˘
 *
ªéi°
 = 
	`PyLi°_New
(0);

109 i‡(
ªéi°
 =
NULL
) {

110  
NULL
;

112 
¥o˛i°
 = 
	`psutû_gë_pids
(&
numbîOfRëu∫edPIDs
);

113 i‡(
NULL
 =
¥o˛i°
) {

114 
îr‹
;

117 
i
 = 0; i < 
numbîOfRëu∫edPIDs
; i++) {

118 
pid
 = 
	`Py_BuûdVÆue
("I", 
¥o˛i°
[
i
]);

119 i‡(!
pid
)

120 
îr‹
;

121 i‡(
	`PyLi°_Aµíd
(
ªéi°
, 
pid
))

122 
îr‹
;

123 
	`Py_DECREF
(
pid
);

127 
	`‰ì
(
¥o˛i°
);

128  
ªéi°
;

130 
îr‹
:

131 
	`Py_XDECREF
(
pid
);

132 
	`Py_DECREF
(
ªéi°
);

133 i‡(
¥o˛i°
 !
NULL
)

134 
	`‰ì
(
¥o˛i°
);

135  
NULL
;

136 
	}
}

142 
PyObje˘
 *

143 
	$psutû_¥oc_kûl
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

145 
HANDLE
 
hPro˚ss
;

146 
pid
;

148 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

149  
NULL
;

151 i‡(
pid
 == 0) {

152  
	`Ac˚ssDíõd
();

155 
hPro˚ss
 = 
	`O≥nPro˚ss
(
PROCESS_TERMINATE
, 
FALSE
, 
pid
);

156 i‡(
hPro˚ss
 =
NULL
) {

157 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_INVALID_PARAMETER
) {

159 
	`NoSuchPro˚ss
();

162 
	`PyEº_SëFromWödowsEº
(0);

164  
NULL
;

168 i‡(! 
	`Tîmö©ePro˚ss
(
hPro˚ss
, 0)) {

169 
	`PyEº_SëFromWödowsEº
(0);

170 
	`Clo£H™dÀ
(
hPro˚ss
);

171  
NULL
;

174 
	`Clo£H™dÀ
(
hPro˚ss
);

175 
	`Py_INCREF
(
Py_N⁄e
);

176  
Py_N⁄e
;

177 
	}
}

183 
PyObje˘
 *

184 
	$psutû_¥oc_waô
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

186 
HANDLE
 
hPro˚ss
;

187 
DWORD
 
ExôCode
;

188 
DWORD
 
ªtVÆ
;

189 
pid
;

190 
timeout
;

192 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "Œ", &
pid
, &
timeout
)) {

193  
NULL
;

195 i‡(
pid
 == 0) {

196  
	`Ac˚ssDíõd
();

199 
hPro˚ss
 = 
	`O≥nPro˚ss
(
SYNCHRONIZE
 | 
PROCESS_QUERY_INFORMATION
,

200 
FALSE
, 
pid
);

201 i‡(
hPro˚ss
 =
NULL
) {

202 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_INVALID_PARAMETER
) {

205 
	`Py_INCREF
(
Py_N⁄e
);

206  
Py_N⁄e
;

209 
	`PyEº_SëFromWödowsEº
(0);

210  
NULL
;

215 
Py_BEGIN_ALLOW_THREADS


216 
ªtVÆ
 = 
	`WaôF‹SögÀObje˘
(
hPro˚ss
, 
timeout
);

217 
Py_END_ALLOW_THREADS


219 i‡(
ªtVÆ
 =
WAIT_FAILED
) {

220 
	`Clo£H™dÀ
(
hPro˚ss
);

221  
	`PyEº_SëFromWödowsEº
(
	`GëLa°Eº‹
());

223 i‡(
ªtVÆ
 =
WAIT_TIMEOUT
) {

224 
	`Clo£H™dÀ
(
hPro˚ss
);

225  
	`Py_BuûdVÆue
("l", 
WAIT_TIMEOUT
);

230 i‡(
	`GëExôCodePro˚ss
(
hPro˚ss
, &
ExôCode
) == 0) {

231 
	`Clo£H™dÀ
(
hPro˚ss
);

232  
	`PyEº_SëFromWödowsEº
(
	`GëLa°Eº‹
());

234 
	`Clo£H™dÀ
(
hPro˚ss
);

235 #i‡
PY_MAJOR_VERSION
 >= 3

236  
	`PyL⁄g_FromL⁄g
((Ë
ExôCode
);

238  
	`PyI¡_FromL⁄g
((Ë
ExôCode
);

240 
	}
}

246 
PyObje˘
 *

247 
	$psutû_¥oc_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

249 
pid
;

250 
HANDLE
 
hPro˚ss
;

251 
FILETIME
 
·Cª©e
, 
·Exô
, 
·Kî√l
, 
·U£r
;

253 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

254  
NULL
;

257 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

258 i‡(
hPro˚ss
 =
NULL
) {

259  
NULL
;

262 i‡(! 
	`GëPro˚ssTimes
(
hPro˚ss
, &
·Cª©e
, &
·Exô
, &
·Kî√l
, &
·U£r
)) {

263 
	`Clo£H™dÀ
(
hPro˚ss
);

264 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_ACCESS_DENIED
) {

267  
	`NoSuchPro˚ss
();

270 
	`PyEº_SëFromWödowsEº
(0);

271  
NULL
;

275 
	`Clo£H™dÀ
(
hPro˚ss
);

286  
	`Py_BuûdVÆue
(

288 ()(
·U£r
.
dwHighD©eTime
 * 429.4967296 + \

289 
·U£r
.
dwLowD©eTime
 * 1e-7),

290 ()(
·Kî√l
.
dwHighD©eTime
 * 429.4967296 + \

291 
·Kî√l
.
dwLowD©eTime
 * 1e-7)

293 
	}
}

299 
PyObje˘
 *

300 
	$psutû_¥oc_˝u_times_2
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

302 
DWORD
 
pid
;

303 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

304 
PVOID
 
buf„r
;

305 
u£r
, 
kî√l
;

307 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

308  
NULL
;

310 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

311  
NULL
;

313 
u£r
 = ()
¥o˚ss
->
U£rTime
.
HighP¨t
 * 429.4967296 + \

314 ()
¥o˚ss
->
U£rTime
.
LowP¨t
 * 1e-7;

315 
kî√l
 = ()
¥o˚ss
->
Kî√lTime
.
HighP¨t
 * 429.4967296 + \

316 ()
¥o˚ss
->
Kî√lTime
.
LowP¨t
 * 1e-7;

317 
	`‰ì
(
buf„r
);

318  
	`Py_BuûdVÆue
("(dd)", 
u£r
, 
kî√l
);

319 
	}
}

326 
PyObje˘
 *

327 
	$psutû_¥oc_¸óã_time
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

329 
pid
;

330 
unix_time
;

331 
DWORD
 
exôCode
;

332 
HANDLE
 
hPro˚ss
;

333 
BOOL
 
ªt
;

334 
FILETIME
 
·Cª©e
, 
·Exô
, 
·Kî√l
, 
·U£r
;

336 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

337  
NULL
;

341 i‡(0 =
pid
 || 4 ==Öid) {

342  
	`psutû_boŸ_time
(
NULL
, NULL);

345 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

346 i‡(
hPro˚ss
 =
NULL
) {

347  
NULL
;

350 i‡(! 
	`GëPro˚ssTimes
(
hPro˚ss
, &
·Cª©e
, &
·Exô
, &
·Kî√l
, &
·U£r
)) {

351 
	`Clo£H™dÀ
(
hPro˚ss
);

352 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_ACCESS_DENIED
) {

355  
	`NoSuchPro˚ss
();

358 
	`PyEº_SëFromWödowsEº
(0);

359  
NULL
;

368 
ªt
 = 
	`GëExôCodePro˚ss
(
hPro˚ss
, &
exôCode
);

369 
	`Clo£H™dÀ
(
hPro˚ss
);

370 i‡(
ªt
 != 0) {

371 i‡(
exôCode
 !
STILL_ACTIVE
) {

372  
	`NoSuchPro˚ss
();

378 i‡(
	`GëLa°Eº‹
(Ë!
ERROR_ACCESS_DENIED
) {

379 
	`PyEº_SëFromWödowsEº
(0);

380  
NULL
;

389 
unix_time
 = ((
LONGLONG
)
·Cª©e
.
dwHighD©eTime
) << 32;

390 
unix_time
 +
·Cª©e
.
dwLowD©eTime
 - 116444736000000000LL;

391 
unix_time
 /= 10000000;

392  
	`Py_BuûdVÆue
("d", ()
unix_time
);

393 
	}
}

399 
PyObje˘
 *

400 
	$psutû_¥oc_¸óã_time_2
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

402 
DWORD
 
pid
;

403 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

404 
PVOID
 
buf„r
;

405 
unix_time
;

407 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

408  
NULL
;

410 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

411  
NULL
;

414 i‡(0 =
pid
 || 4 ==Öid) {

415  
	`psutû_boŸ_time
(
NULL
, NULL);

422 
unix_time
 = ((
LONGLONG
)
¥o˚ss
->
Cª©eTime
.
HighP¨t
) << 32;

423 
unix_time
 +
¥o˚ss
->
Cª©eTime
.
LowP¨t
 - 116444736000000000LL;

424 
unix_time
 /= 10000000;

425 
	`‰ì
(
buf„r
);

426  
	`Py_BuûdVÆue
("d", ()
unix_time
);

427 
	}
}

433 
PyObje˘
 *

434 
	$psutû_˝u_cou¡_logiˇl
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

436 
SYSTEM_INFO
 
sy°em_öfo
;

437 
sy°em_öfo
.
dwNumbîOfPro˚ss‹s
 = 0;

439 
	`GëSy°emInfo
(&
sy°em_öfo
);

440 i‡(
sy°em_öfo
.
dwNumbîOfPro˚ss‹s
 == 0) {

442 
	`Py_INCREF
(
Py_N⁄e
);

443  
Py_N⁄e
;

446  
	`Py_BuûdVÆue
("I", 
sy°em_öfo
.
dwNumbîOfPro˚ss‹s
);

448 
	}
}

451 
	$BOOL
 (
	tWINAPI
 *
	tLPFN_GLPI
Ë(
	tPSYSTEM_LOGICAL_PROCESSOR_INFORMATION
,

452 
	tPDWORD
);

457 
PyObje˘
 *

458 
	$psutû_˝u_cou¡_phys
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

460 
LPFN_GLPI
 
gÕi
;

461 
DWORD
 
rc
;

462 
PSYSTEM_LOGICAL_PROCESSOR_INFORMATION
 
buf„r
 = 
NULL
;

463 
PSYSTEM_LOGICAL_PROCESSOR_INFORMATION
 
±r
 = 
NULL
;

464 
DWORD
 
Àngth
 = 0;

465 
DWORD
 
off£t
 = 0;

466 
n˝us
 = 0;

468 
gÕi
 = (
LPFN_GLPI
)
	`GëProcAddªss
(
	`GëModuÀH™dÀ
(
	`TEXT
("kernel32")),

470 i‡(
gÕi
 =
NULL
)

471 
ªtu∫_n⁄e
;

474 
rc
 = 
	`gÕi
(
buf„r
, &
Àngth
);

475 i‡(
rc
 =
FALSE
) {

476 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_INSUFFICIENT_BUFFER
) {

477 i‡(
buf„r
)

478 
	`‰ì
(
buf„r
);

479 
buf„r
 = (
PSYSTEM_LOGICAL_PROCESSOR_INFORMATION
)
	`mÆloc
(

480 
Àngth
);

481 i‡(
NULL
 =
buf„r
) {

482 
	`PyEº_NoMem‹y
();

483  
NULL
;

487 
ªtu∫_n⁄e
;

495 
±r
 = 
buf„r
;

496 
off£t
 + (
SYSTEM_LOGICAL_PROCESSOR_INFORMATION
Ë<
Àngth
) {

497 i‡(
±r
->
Rñ©i⁄shù
 =
Rñ©i⁄Pro˚ss‹C‹e
)

498 
n˝us
 += 1;

499 
off£t
 +(
SYSTEM_LOGICAL_PROCESSOR_INFORMATION
);

500 
±r
++;

503 
	`‰ì
(
buf„r
);

504 i‡(
n˝us
 == 0)

505 
ªtu∫_n⁄e
;

507  
	`Py_BuûdVÆue
("i", 
n˝us
);

509 
ªtu∫_n⁄e
:

511 i‡(
buf„r
 !
NULL
)

512 
	`‰ì
(
buf„r
);

513 
	`Py_INCREF
(
Py_N⁄e
);

514  
Py_N⁄e
;

515 
	}
}

521 
PyObje˘
 *

522 
	$psutû_¥oc_cmdlöe
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
) {

523 
pid
;

524 
pid_ªtu∫
;

525 
PyObje˘
 *
¨gli°
;

527 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

528  
NULL
;

530 i‡((
pid
 == 0) || (pid == 4)) {

531  
	`Py_BuûdVÆue
("[]");

534 
pid_ªtu∫
 = 
	`psutû_pid_is_ru¬ög
(
pid
);

535 i‡(
pid_ªtu∫
 == 0) {

536  
	`NoSuchPro˚ss
();

538 i‡(
pid_ªtu∫
 == -1) {

539  
NULL
;

547 
¨gli°
 = 
	`psutû_gë_¨g_li°
(
pid
);

548 i‡–
NULL
 =
¨gli°
 ) {

550 
	`PyEº_CÀ¨
();

551  
	`Py_BuûdVÆue
("[]");

554  
¨gli°
;

555 
	}
}

561 
PyObje˘
 *

562 
	$psutû_¥oc_exe
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
) {

563 
pid
;

564 
HANDLE
 
hPro˚ss
;

565 
wch¨_t
 
exe
[
MAX_PATH
];

566 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

567  
NULL
;

570 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid_wac˚ss
(
pid
, 
PROCESS_QUERY_INFORMATION
);

571 i‡(
NULL
 =
hPro˚ss
) {

572  
NULL
;

574 i‡(
	`GëPro˚ssImageFûeNameW
(
hPro˚ss
, &
exe
, 
MAX_PATH
) == 0) {

575 
	`Clo£H™dÀ
(
hPro˚ss
);

576 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_INVALID_PARAMETER
) {

578 
	`Ac˚ssDíõd
();

581 
	`PyEº_SëFromWödowsEº
(0);

583  
NULL
;

585 
	`Clo£H™dÀ
(
hPro˚ss
);

586  
	`Py_BuûdVÆue
("u", 
exe
);

587 
	}
}

593 
PyObje˘
 *

594 
	$psutû_¥oc_mem‹y_öfo
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

596 
HANDLE
 
hPro˚ss
;

597 
DWORD
 
pid
;

598 #i‡(
_WIN32_WINNT
 >= 0x0501)

599 
PROCESS_MEMORY_COUNTERS_EX
 
˙t
;

601 
PROCESS_MEMORY_COUNTERS
 
˙t
;

603 
SIZE_T
 
¥iv©e
 = 0;

605 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

606  
NULL
;

609 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

610 i‡(
NULL
 =
hPro˚ss
) {

611  
NULL
;

614 i‡(! 
	`GëPro˚ssMem‹yInfo
(
hPro˚ss
, &
˙t
, (cnt)) ) {

615 
	`Clo£H™dÀ
(
hPro˚ss
);

616  
	`PyEº_SëFromWödowsEº
(0);

619 #i‡(
_WIN32_WINNT
 >= 0x0501)

620 
¥iv©e
 = 
˙t
.
Priv©eUßge
;

623 
	`Clo£H™dÀ
(
hPro˚ss
);

629 #i‡
	`deföed
(
_WIN64
)

630  
	`Py_BuûdVÆue
(

632 
˙t
.
PageFau…Cou¡
,

633 ()
˙t
.
PókW‹kögSëSize
,

634 ()
˙t
.
W‹kögSëSize
,

635 ()
˙t
.
QuŸaPókPagedPoﬁUßge
,

636 ()
˙t
.
QuŸaPagedPoﬁUßge
,

637 ()
˙t
.
QuŸaPókN⁄PagedPoﬁUßge
,

638 ()
˙t
.
QuŸaN⁄PagedPoﬁUßge
,

639 ()
˙t
.
PagefûeUßge
,

640 ()
˙t
.
PókPagefûeUßge
,

641 ()
¥iv©e
);

643  
	`Py_BuûdVÆue
(

645 
˙t
.
PageFau…Cou¡
,

646 ()
˙t
.
PókW‹kögSëSize
,

647 ()
˙t
.
W‹kögSëSize
,

648 ()
˙t
.
QuŸaPókPagedPoﬁUßge
,

649 ()
˙t
.
QuŸaPagedPoﬁUßge
,

650 ()
˙t
.
QuŸaPókN⁄PagedPoﬁUßge
,

651 ()
˙t
.
QuŸaN⁄PagedPoﬁUßge
,

652 ()
˙t
.
PagefûeUßge
,

653 ()
˙t
.
PókPagefûeUßge
,

654 ()
¥iv©e
);

656 
	}
}

662 
PyObje˘
 *

663 
	$psutû_¥oc_mem‹y_öfo_2
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

665 
DWORD
 
pid
;

666 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

667 
PVOID
 
buf„r
;

668 
SIZE_T
 
¥iv©e
;

669 
pÁu…_cou¡
;

671 #i‡
	`deföed
(
_WIN64
)

672 
m1
, 
m2
, 
m3
, 
m4
, 
m5
, 
m6
, 
m7
, 
m8
;

674 
m1
, 
m2
, 
m3
, 
m4
, 
m5
, 
m6
, 
m7
, 
m8
;

677 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

678  
NULL
;

680 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

681  
NULL
;

684 #i‡(
_WIN32_WINNT
 >= 0x0501)

685 
¥iv©e
 = 
¥o˚ss
->
Priv©ePageCou¡
;

687 
¥iv©e
 = 0;

689 
pÁu…_cou¡
 = 
¥o˚ss
->
PageFau…Cou¡
;

691 
m1
 = 
¥o˚ss
->
PókW‹kögSëSize
;

692 
m2
 = 
¥o˚ss
->
W‹kögSëSize
;

693 
m3
 = 
¥o˚ss
->
QuŸaPókPagedPoﬁUßge
;

694 
m4
 = 
¥o˚ss
->
QuŸaPagedPoﬁUßge
;

695 
m5
 = 
¥o˚ss
->
QuŸaPókN⁄PagedPoﬁUßge
;

696 
m6
 = 
¥o˚ss
->
QuŸaN⁄PagedPoﬁUßge
;

697 
m7
 = 
¥o˚ss
->
PagefûeUßge
;

698 
m8
 = 
¥o˚ss
->
PókPagefûeUßge
;

700 
	`‰ì
(
buf„r
);

706 #i‡
	`deföed
(
_WIN64
)

707  
	`Py_BuûdVÆue
("(kKKKKKKKKK)",

709  
	`Py_BuûdVÆue
("(kIIIIIIIII)",

711 
pÁu…_cou¡
, 
m1
, 
m2
, 
m3
, 
m4
, 
m5
, 
m6
, 
m7
, 
m8
, 
¥iv©e
);

712 
	}
}

719 
PyObje˘
 *

720 
	$psutû_vútuÆ_mem
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

722 
MEMORYSTATUSEX
 
memInfo
;

723 
memInfo
.
dwLígth
 = (
MEMORYSTATUSEX
);

725 i‡(! 
	`GlobÆMem‹ySètusEx
(&
memInfo
) ) {

726  
	`PyEº_SëFromWödowsEº
(0);

729  
	`Py_BuûdVÆue
("(LLLLLL)",

730 
memInfo
.
uŒTŸÆPhys
,

731 
memInfo
.
uŒAvaûPhys
,

732 
memInfo
.
uŒTŸÆPageFûe
,

733 
memInfo
.
uŒAvaûPageFûe
,

734 
memInfo
.
uŒTŸÆVútuÆ
,

735 
memInfo
.
uŒAvaûVútuÆ
);

736 
	}
}

739 
	#LO_T
 (()1e-7)

	)

740 
	#HI_T
 (
LO_T
*4294967296.0)

	)

748 
PyObje˘
 *

749 
	$psutû_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

751 
idÀ
, 
kî√l
, 
u£r
, 
sy°em
;

752 
FILETIME
 
idÀ_time
, 
kî√l_time
, 
u£r_time
;

754 i‡(!
	`GëSy°emTimes
(&
idÀ_time
, &
kî√l_time
, &
u£r_time
)) {

755  
	`PyEº_SëFromWödowsEº
(0);

758 
idÀ
 = ()((
HI_T
 * 
idÀ_time
.
dwHighD©eTime
) + \

759 (
LO_T
 * 
idÀ_time
.
dwLowD©eTime
));

760 
u£r
 = ()((
HI_T
 * 
u£r_time
.
dwHighD©eTime
) + \

761 (
LO_T
 * 
u£r_time
.
dwLowD©eTime
));

762 
kî√l
 = ()((
HI_T
 * 
kî√l_time
.
dwHighD©eTime
) + \

763 (
LO_T
 * 
kî√l_time
.
dwLowD©eTime
));

768 
sy°em
 = (
kî√l
 - 
idÀ
);

769  
	`Py_BuûdVÆue
("(fff)", 
u£r
, 
sy°em
, 
idÀ
);

770 
	}
}

776 
PyObje˘
 *

777 
	$psutû_≥r_˝u_times
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

779 
idÀ
, 
kî√l
, 
u£r
;

780 
	`DWORD
 (
	t_°dˇŒ
 * 
	tNTQSI_PROC
Ë(, 
	tPVOID
, 
	tULONG
, 
	tPULONG
);

781 
NTQSI_PROC
 
NtQuîySy°emInf‹m©i⁄
;

782 
HINSTANCE
 
hNtDŒ
;

783 
SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION
 *
•pi
 = 
NULL
;

784 
SYSTEM_INFO
 
si
;

785 
UINT
 
i
;

786 
PyObje˘
 *
¨g
 = 
NULL
;

787 
PyObje˘
 *
ªéi°
 = 
	`PyLi°_New
(0);

789 i‡(
ªéi°
 =
NULL
)

790  
NULL
;

793 
hNtDŒ
 = 
	`LﬂdLibøry
(
	`TEXT
("ntdll.dll"));

794 i‡(
hNtDŒ
 !
NULL
) {

796 
NtQuîySy°emInf‹m©i⁄
 = (
NTQSI_PROC
)
	`GëProcAddªss
(

797 
hNtDŒ
, "NtQuerySystemInformation");

799 i‡(
NtQuîySy°emInf‹m©i⁄
 !
NULL
)

802 
	`GëSy°emInfo
(&
si
);

806 
•pi
 = (
SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION
 *) \

807 
	`mÆloc
(
si
.
dwNumbîOfPro˚ss‹s
 * \

808 (
SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION
));

809 i‡(
•pi
 !
NULL
)

812 i‡(0 =
	`NtQuîySy°emInf‹m©i⁄
(

813 
Sy°emPro˚ss‹Pîf‹m™˚Inf‹m©i⁄
,

814 
•pi
,

815 
si
.
dwNumbîOfPro˚ss‹s
 * 

816 (
SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION
),

817 
NULL
)

822 
idÀ
 = 
u£r
 = 
kî√l
 = 0;

823 
i
 = 0; i < 
si
.
dwNumbîOfPro˚ss‹s
; i++) {

824 
¨g
 = 
NULL
;

825 
u£r
 = ()((
HI_T
 * 
•pi
[
i
].
U£rTime
.
HighP¨t
) +

826 (
LO_T
 * 
•pi
[
i
].
U£rTime
.
LowP¨t
));

827 
idÀ
 = ()((
HI_T
 * 
•pi
[
i
].
IdÀTime
.
HighP¨t
) +

828 (
LO_T
 * 
•pi
[
i
].
IdÀTime
.
LowP¨t
));

829 
kî√l
 = ()((
HI_T
 * 
•pi
[
i
].
Kî√lTime
.
HighP¨t
) +

830 (
LO_T
 * 
•pi
[
i
].
Kî√lTime
.
LowP¨t
));

834 
¨g
 = 
	`Py_BuûdVÆue
("(ddd)",

835 
u£r
,

836 
kî√l
 - 
idÀ
,

837 
idÀ
);

838 i‡(!
¨g
)

839 
îr‹
;

840 i‡(
	`PyLi°_Aµíd
(
ªéi°
, 
¨g
))

841 
îr‹
;

842 
	`Py_DECREF
(
¨g
);

844 
	`‰ì
(
•pi
);

845 
	`FªeLibøry
(
hNtDŒ
);

846  
ªéi°
;

852 
îr‹
;

854 
îr‹
:

855 
	`Py_XDECREF
(
¨g
);

856 
	`Py_DECREF
(
ªéi°
);

857 i‡(
•pi
) {

858 
	`‰ì
(
•pi
);

860 i‡(
hNtDŒ
) {

861 
	`FªeLibøry
(
hNtDŒ
);

863 
	`PyEº_SëFromWödowsEº
(0);

864  
NULL
;

865 
	}
}

872 
PyObje˘
 *

873 
	$psutû_¥oc_cwd
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

875 
pid
;

876 
HANDLE
 
¥o˚ssH™dÀ
 = 
NULL
;

877 
PVOID
 
≥bAddªss
;

878 
PVOID
 
πlU£rProcP¨amsAddªss
;

879 
UNICODE_STRING
 
cuºítDúe˘‹y
;

880 
WCHAR
 *
cuºítDúe˘‹yC⁄ã¡
 = 
NULL
;

881 
PyObje˘
 *
ªtu∫PyObj
 = 
NULL
;

882 
PyObje˘
 *
cwd_‰om_wch¨
 = 
NULL
;

883 
PyObje˘
 *
cwd
 = 
NULL
;

885 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

886  
NULL
;

889 
¥o˚ssH™dÀ
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

890 i‡(
¥o˚ssH™dÀ
 =
NULL
) {

891  
NULL
;

894 
≥bAddªss
 = 
	`psutû_gë_≥b_addªss
(
¥o˚ssH™dÀ
);

897 #ifde‡
_WIN64


898 i‡(!
	`RódPro˚ssMem‹y
(
¥o˚ssH™dÀ
, (
PCHAR
)
≥bAddªss
 + 32,

899 &
πlU£rProcP¨amsAddªss
, (
PVOID
), 
NULL
))

901 i‡(!
	`RódPro˚ssMem‹y
(
¥o˚ssH™dÀ
, (
PCHAR
)
≥bAddªss
 + 0x10,

902 &
πlU£rProcP¨amsAddªss
, (
PVOID
), 
NULL
))

905 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

906 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_PARTIAL_COPY
) {

908  
	`Ac˚ssDíõd
();

911  
	`PyEº_SëFromWödowsEº
(0);

920 #ifde‡
_WIN64


921 i‡(!
	`RódPro˚ssMem‹y
(
¥o˚ssH™dÀ
, (
PCHAR
)
πlU£rProcP¨amsAddªss
 + 56,

922 &
cuºítDúe˘‹y
, (cuºítDúe˘‹y), 
NULL
))

924 i‡(!
	`RódPro˚ssMem‹y
(
¥o˚ssH™dÀ
,

925 (
PCHAR
)
πlU£rProcP¨amsAddªss
 + 0x24,

926 &
cuºítDúe˘‹y
, (cuºítDúe˘‹y), 
NULL
))

929 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

930 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_PARTIAL_COPY
) {

932  
	`Ac˚ssDíõd
();

935  
	`PyEº_SëFromWödowsEº
(0);

940 
cuºítDúe˘‹yC⁄ã¡
 = (
WCHAR
 *)
	`mÆloc
(
cuºítDúe˘‹y
.
Lígth
 + 1);

941 i‡(
cuºítDúe˘‹yC⁄ã¡
 =
NULL
) {

942 
	`PyEº_NoMem‹y
();

943 
îr‹
;

947 i‡(!
	`RódPro˚ssMem‹y
(
¥o˚ssH™dÀ
, 
cuºítDúe˘‹y
.
Buf„r
,

948 
cuºítDúe˘‹yC⁄ã¡
, 
cuºítDúe˘‹y
.
Lígth
,

949 
NULL
))

951 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_PARTIAL_COPY
) {

953 
	`Ac˚ssDíõd
();

956 
	`PyEº_SëFromWödowsEº
(0);

958 
îr‹
;

964 
cuºítDúe˘‹yC⁄ã¡
[(
cuºítDúe˘‹y
.
Lígth
 / (
WCHAR
))] = '\0';

967 
cwd_‰om_wch¨
 = 
	`PyUnicode_FromWideCh¨
(
cuºítDúe˘‹yC⁄ã¡
,

968 
	`wc¶í
(
cuºítDúe˘‹yC⁄ã¡
));

969 i‡(
cwd_‰om_wch¨
 =
NULL
)

970 
îr‹
;

972 #i‡
PY_MAJOR_VERSION
 >= 3

973 
cwd
 = 
	`PyUnicode_FromObje˘
(
cwd_‰om_wch¨
);

975 
cwd
 = 
	`PyUnicode_AsUTF8Såög
(
cwd_‰om_wch¨
);

977 i‡(
cwd
 =
NULL
)

978 
îr‹
;

982 
ªtu∫PyObj
 = 
	`Py_BuûdVÆue
("N", 
cwd
);

983 i‡(!
ªtu∫PyObj
)

984 
îr‹
;

986 
	`Py_DECREF
(
cwd_‰om_wch¨
);

988 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

989 
	`‰ì
(
cuºítDúe˘‹yC⁄ã¡
);

990  
ªtu∫PyObj
;

992 
îr‹
:

993 
	`Py_XDECREF
(
cwd_‰om_wch¨
);

994 
	`Py_XDECREF
(
cwd
);

995 
	`Py_XDECREF
(
ªtu∫PyObj
);

996 i‡(
cuºítDúe˘‹yC⁄ã¡
 !
NULL
)

997 
	`‰ì
(
cuºítDúe˘‹yC⁄ã¡
);

998 i‡(
¥o˚ssH™dÀ
 !
NULL
)

999 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

1000  
NULL
;

1001 
	}
}

1008 
	$psutû_¥oc_su•íd_‹_ªsume
(
DWORD
 
pid
, 
su•íd
)

1011 
HANDLE
 
hThªadS«p
 = 
NULL
;

1012 
THREADENTRY32
 
ã32
 = {0};

1014 i‡(
pid
 == 0) {

1015 
	`Ac˚ssDíõd
();

1016  
FALSE
;

1019 
hThªadS«p
 = 
	`Cª©eToﬁhñp32S«pshŸ
(
TH32CS_SNAPTHREAD
, 0);

1020 i‡(
hThªadS«p
 =
INVALID_HANDLE_VALUE
) {

1021 
	`PyEº_SëFromWödowsEº
(0);

1022  
FALSE
;

1026 
ã32
.
dwSize
 = (
THREADENTRY32
);

1028 i‡(! 
	`Thªad32Fú°
(
hThªadS«p
, &
ã32
)) {

1029 
	`PyEº_SëFromWödowsEº
(0);

1030 
	`Clo£H™dÀ
(
hThªadS«p
);

1031  
FALSE
;

1039 i‡(
ã32
.
th32Ow√rPro˚ssID
 =
pid
)

1041 
HANDLE
 
hThªad
 = 
	`O≥nThªad
(
THREAD_SUSPEND_RESUME
, 
FALSE
,

1042 
ã32
.
th32ThªadID
);

1043 i‡(
hThªad
 =
NULL
) {

1044 
	`PyEº_SëFromWödowsEº
(0);

1045 
	`Clo£H™dÀ
(
hThªad
);

1046 
	`Clo£H™dÀ
(
hThªadS«p
);

1047  
FALSE
;

1049 i‡(
su•íd
 == 1)

1051 i‡(
	`Su•ídThªad
(
hThªad
Ë=(
DWORD
) - 1) {

1052 
	`PyEº_SëFromWödowsEº
(0);

1053 
	`Clo£H™dÀ
(
hThªad
);

1054 
	`Clo£H™dÀ
(
hThªadS«p
);

1055  
FALSE
;

1060 i‡(
	`ResumeThªad
(
hThªad
Ë=(
DWORD
) - 1) {

1061 
	`PyEº_SëFromWödowsEº
(0);

1062 
	`Clo£H™dÀ
(
hThªad
);

1063 
	`Clo£H™dÀ
(
hThªadS«p
);

1064  
FALSE
;

1067 
	`Clo£H™dÀ
(
hThªad
);

1069 } 
	`Thªad32Next
(
hThªadS«p
, &
ã32
));

1071 
	`Clo£H™dÀ
(
hThªadS«p
);

1072  
TRUE
;

1073 
	}
}

1076 
PyObje˘
 *

1077 
	$psutû_¥oc_su•íd
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1079 
pid
;

1080 
su•íd
 = 1;

1081 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1082  
NULL
;

1085 i‡(! 
	`psutû_¥oc_su•íd_‹_ªsume
(
pid
, 
su•íd
)) {

1086  
NULL
;

1088 
	`Py_INCREF
(
Py_N⁄e
);

1089  
Py_N⁄e
;

1090 
	}
}

1093 
PyObje˘
 *

1094 
	$psutû_¥oc_ªsume
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1096 
pid
;

1097 
su•íd
 = 0;

1098 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1099  
NULL
;

1102 i‡(! 
	`psutû_¥oc_su•íd_‹_ªsume
(
pid
, 
su•íd
)) {

1103  
NULL
;

1105 
	`Py_INCREF
(
Py_N⁄e
);

1106  
Py_N⁄e
;

1107 
	}
}

1110 
PyObje˘
 *

1111 
	$psutû_¥oc_num_thªads
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1113 
DWORD
 
pid
;

1114 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

1115 
PVOID
 
buf„r
;

1116 
num
;

1118 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1119  
NULL
;

1121 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

1122  
NULL
;

1124 
num
 = ()
¥o˚ss
->
NumbîOfThªads
;

1125 
	`‰ì
(
buf„r
);

1126  
	`Py_BuûdVÆue
("i", 
num
);

1127 
	}
}

1130 
PyObje˘
 *

1131 
	$psutû_¥oc_thªads
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1133 
HANDLE
 
hThªad
;

1134 
THREADENTRY32
 
ã32
 = {0};

1135 
pid
;

1136 
pid_ªtu∫
;

1137 
rc
;

1138 
FILETIME
 
·Dummy
, 
·Kî√l
, 
·U£r
;

1139 
PyObje˘
 *
ªtLi°
 = 
	`PyLi°_New
(0);

1140 
PyObje˘
 *
pyTu∂e
 = 
NULL
;

1141 
HANDLE
 
hThªadS«p
 = 
NULL
;

1143 i‡(
ªtLi°
 =
NULL
) {

1144  
NULL
;

1146 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1147 
îr‹
;

1149 i‡(
pid
 == 0) {

1152 
	`Ac˚ssDíõd
();

1153 
îr‹
;

1156 
pid_ªtu∫
 = 
	`psutû_pid_is_ru¬ög
(
pid
);

1157 i‡(
pid_ªtu∫
 == 0) {

1158 
	`NoSuchPro˚ss
();

1159 
îr‹
;

1161 i‡(
pid_ªtu∫
 == -1) {

1162 
îr‹
;

1165 
hThªadS«p
 = 
	`Cª©eToﬁhñp32S«pshŸ
(
TH32CS_SNAPTHREAD
, 0);

1166 i‡(
hThªadS«p
 =
INVALID_HANDLE_VALUE
) {

1167 
	`PyEº_SëFromWödowsEº
(0);

1168 
îr‹
;

1172 
ã32
.
dwSize
 = (
THREADENTRY32
);

1174 i‡(! 
	`Thªad32Fú°
(
hThªadS«p
, &
ã32
)) {

1175 
	`PyEº_SëFromWödowsEº
(0);

1176 
îr‹
;

1183 i‡(
ã32
.
th32Ow√rPro˚ssID
 =
pid
)

1185 
pyTu∂e
 = 
NULL
;

1186 
hThªad
 = 
NULL
;

1187 
hThªad
 = 
	`O≥nThªad
(
THREAD_QUERY_INFORMATION
,

1188 
FALSE
, 
ã32
.
th32ThªadID
);

1189 i‡(
hThªad
 =
NULL
) {

1194 
rc
 = 
	`GëThªadTimes
(
hThªad
, &
·Dummy
, &·Dummy, &
·Kî√l
,

1195 &
·U£r
);

1196 i‡(
rc
 == 0) {

1197 
	`PyEº_SëFromWödowsEº
(0);

1198 
îr‹
;

1210 
pyTu∂e
 = 
	`Py_BuûdVÆue
(

1212 
ã32
.
th32ThªadID
,

1213 ()(
·U£r
.
dwHighD©eTime
 * 429.4967296 + \

1214 
·U£r
.
dwLowD©eTime
 * 1e-7),

1215 ()(
·Kî√l
.
dwHighD©eTime
 * 429.4967296 + \

1216 
·Kî√l
.
dwLowD©eTime
 * 1e-7));

1217 i‡(!
pyTu∂e
)

1218 
îr‹
;

1219 i‡(
	`PyLi°_Aµíd
(
ªtLi°
, 
pyTu∂e
))

1220 
îr‹
;

1221 
	`Py_DECREF
(
pyTu∂e
);

1223 
	`Clo£H™dÀ
(
hThªad
);

1225 } 
	`Thªad32Next
(
hThªadS«p
, &
ã32
));

1227 
	`Clo£H™dÀ
(
hThªadS«p
);

1228  
ªtLi°
;

1230 
îr‹
:

1231 
	`Py_XDECREF
(
pyTu∂e
);

1232 
	`Py_DECREF
(
ªtLi°
);

1233 i‡(
hThªad
 !
NULL
)

1234 
	`Clo£H™dÀ
(
hThªad
);

1235 i‡(
hThªadS«p
 !
NULL
) {

1236 
	`Clo£H™dÀ
(
hThªadS«p
);

1238  
NULL
;

1239 
	}
}

1242 
PyObje˘
 *

1243 
	$psutû_¥oc_›í_fûes
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1245 
pid
;

1246 
HANDLE
 
¥o˚ssH™dÀ
;

1247 
DWORD
 
ac˚ss
 = 
PROCESS_DUP_HANDLE
 | 
PROCESS_QUERY_INFORMATION
;

1248 
PyObje˘
 *
fûesLi°
;

1250 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1251  
NULL
;

1254 
¥o˚ssH™dÀ
 = 
	`psutû_h™dÀ_‰om_pid_wac˚ss
(
pid
, 
ac˚ss
);

1255 i‡(
¥o˚ssH™dÀ
 =
NULL
) {

1256  
NULL
;

1259 
fûesLi°
 = 
	`psutû_gë_›í_fûes
(
pid
, 
¥o˚ssH™dÀ
);

1260 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

1261 i‡(
fûesLi°
 =
NULL
) {

1262  
	`PyEº_SëFromWödowsEº
(0);

1264  
fûesLi°
;

1265 
	}
}

1273 
PyObje˘
 *

1274 
	$psutû_wö32_QuîyDosDevi˚
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1276 
LPCTSTR
 
ÕDevi˚P©h
;

1277 
TCHAR
 
d
 = 
	`TEXT
('A');

1278 
TCHAR
 
szBuff
[5];

1280 i‡(!
	`PyArg_P¨£Tu∂e
(
¨gs
, "s", &
ÕDevi˚P©h
)) {

1281  
NULL
;

1284 
d
 <
	`TEXT
('Z'))

1286 
TCHAR
 
szDevi˚Name
[3] = {
d
, 
	`TEXT
(':'), TEXT('\0')};

1287 
TCHAR
 
szT¨gë
[512] = {0};

1288 i‡(
	`QuîyDosDevi˚
(
szDevi˚Name
, 
szT¨gë
, 511) != 0) {

1289 i‡(
	`_tcscmp
(
ÕDevi˚P©h
, 
szT¨gë
) == 0) {

1290 
	`_°¥ötf
(
szBuff
, 
	`TEXT
("%c:"), 
d
);

1291  
	`Py_BuûdVÆue
("s", 
szBuff
);

1294 
d
++;

1296  
	`Py_BuûdVÆue
("s", "");

1297 
	}
}

1303 
PyObje˘
 *

1304 
	$psutû_¥oc_u£∫ame
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1306 
pid
;

1307 
HANDLE
 
¥o˚ssH™dÀ
;

1308 
HANDLE
 
tokíH™dÀ
;

1309 
PTOKEN_USER
 
u£r
;

1310 
ULONG
 
buf„rSize
;

1311 
PTSTR
 
«me
;

1312 
ULONG
 
«meSize
;

1313 
PTSTR
 
domaöName
;

1314 
ULONG
 
domaöNameSize
;

1315 
SID_NAME_USE
 
«meU£
;

1316 
PTSTR
 
fuŒName
;

1317 
PyObje˘
 *
ªtu∫Obje˘
;

1319 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1320  
NULL
;

1323 
¥o˚ssH™dÀ
 = 
	`psutû_h™dÀ_‰om_pid_wac˚ss
(

1324 
pid
, 
PROCESS_QUERY_INFORMATION
);

1325 i‡(
¥o˚ssH™dÀ
 =
NULL
) {

1326  
NULL
;

1329 i‡(!
	`O≥nPro˚ssTokí
(
¥o˚ssH™dÀ
, 
TOKEN_QUERY
, &
tokíH™dÀ
)) {

1330 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

1331  
	`PyEº_SëFromWödowsEº
(0);

1334 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

1338 
buf„rSize
 = 0x100;

1339 
u£r
 = 
	`mÆloc
(
buf„rSize
);

1340 i‡(
u£r
 =
NULL
) {

1341  
	`PyEº_NoMem‹y
();

1344 i‡(!
	`GëTokíInf‹m©i⁄
(
tokíH™dÀ
, 
TokíU£r
, 
u£r
, 
buf„rSize
,

1345 &
buf„rSize
))

1347 
	`‰ì
(
u£r
);

1348 
u£r
 = 
	`mÆloc
(
buf„rSize
);

1349 i‡(
u£r
 =
NULL
) {

1350 
	`Clo£H™dÀ
(
tokíH™dÀ
);

1351  
	`PyEº_NoMem‹y
();

1353 i‡(!
	`GëTokíInf‹m©i⁄
(
tokíH™dÀ
, 
TokíU£r
, 
u£r
, 
buf„rSize
,

1354 &
buf„rSize
))

1356 
	`‰ì
(
u£r
);

1357 
	`Clo£H™dÀ
(
tokíH™dÀ
);

1358  
	`PyEº_SëFromWödowsEº
(0);

1362 
	`Clo£H™dÀ
(
tokíH™dÀ
);

1365 
«meSize
 = 0x100;

1366 
domaöNameSize
 = 0x100;

1368 
«me
 = 
	`mÆloc
(
«meSize
 * (
TCHAR
));

1369 i‡(
«me
 =
NULL
)

1370  
	`PyEº_NoMem‹y
();

1371 
domaöName
 = 
	`mÆloc
(
domaöNameSize
 * (
TCHAR
));

1372 i‡(
domaöName
 =
NULL
)

1373  
	`PyEº_NoMem‹y
();

1375 i‡(!
	`LookupAccou¡Sid
(
NULL
, 
u£r
->
U£r
.
Sid
, 
«me
, &
«meSize
, 
domaöName
,

1376 &
domaöNameSize
, &
«meU£
))

1378 
	`‰ì
(
«me
);

1379 
	`‰ì
(
domaöName
);

1380 
«me
 = 
	`mÆloc
(
«meSize
 * (
TCHAR
));

1381 i‡(
«me
 =
NULL
)

1382  
	`PyEº_NoMem‹y
();

1383 
domaöName
 = 
	`mÆloc
(
domaöNameSize
 * (
TCHAR
));

1384 i‡(
domaöName
 =
NULL
)

1385  
	`PyEº_NoMem‹y
();

1386 i‡(!
	`LookupAccou¡Sid
(
NULL
, 
u£r
->
U£r
.
Sid
, 
«me
, &
«meSize
,

1387 
domaöName
, &
domaöNameSize
, &
«meU£
))

1389 
	`‰ì
(
«me
);

1390 
	`‰ì
(
domaöName
);

1391 
	`‰ì
(
u£r
);

1393  
	`PyEº_SëFromWödowsEº
(0);

1397 
«meSize
 = 
	`_tc¶í
(
«me
);

1398 
domaöNameSize
 = 
	`_tc¶í
(
domaöName
);

1401 
fuŒName
 = 
	`mÆloc
((
domaöNameSize
 + 1 + 
«meSize
 + 1Ë* (
TCHAR
));

1402 i‡(
fuŒName
 =
NULL
) {

1403 
	`‰ì
(
«me
);

1404 
	`‰ì
(
domaöName
);

1405 
	`‰ì
(
u£r
);

1406  
	`PyEº_NoMem‹y
();

1408 
	`mem˝y
(
fuŒName
, 
domaöName
, 
domaöNameSize
);

1409 
fuŒName
[
domaöNameSize
] = '\\';

1410 
	`mem˝y
(&
fuŒName
[
domaöNameSize
 + 1], 
«me
, 
«meSize
);

1411 
fuŒName
[
domaöNameSize
 + 1 + 
«meSize
] = '\0';

1413 
ªtu∫Obje˘
 = 
	`Py_BuûdVÆue
("s", 
fuŒName
);

1415 
	`‰ì
(
fuŒName
);

1416 
	`‰ì
(
«me
);

1417 
	`‰ì
(
domaöName
);

1418 
	`‰ì
(
u£r
);

1420  
ªtu∫Obje˘
;

1421 
	}
}

1426 #i‚de‡
_IPRTRMIB_H


1427 
	s_MIB_TCP6ROW_OWNER_PID
 {

1428 
UCHAR
 
	mucLoˇlAddr
[16];

1429 
DWORD
 
	mdwLoˇlSc›eId
;

1430 
DWORD
 
	mdwLoˇlP‹t
;

1431 
UCHAR
 
	mucRemŸeAddr
[16];

1432 
DWORD
 
	mdwRemŸeSc›eId
;

1433 
DWORD
 
	mdwRemŸeP‹t
;

1434 
DWORD
 
	mdwSèã
;

1435 
DWORD
 
	mdwOwnögPid
;

1436 } 
	tMIB_TCP6ROW_OWNER_PID
, *
	tPMIB_TCP6ROW_OWNER_PID
;

1438 
	s_MIB_TCP6TABLE_OWNER_PID
 {

1439 
DWORD
 
	mdwNumE¡rõs
;

1440 
MIB_TCP6ROW_OWNER_PID
 
	mèbÀ
[
ANY_SIZE
];

1441 } 
	tMIB_TCP6TABLE_OWNER_PID
, *
	tPMIB_TCP6TABLE_OWNER_PID
;

1444 #i‚de‡
__IPHLPAPI_H__


1445 
	sö6_addr
 {

1447 
UCHAR
 
	mByã
[16];

1448 
USHORT
 
	mW‹d
[8];

1449 } 
	mu
;

1450 } 
	tIN6_ADDR
, *
	tPIN6_ADDR
, 
	tFAR
 *
	tLPIN6_ADDR
;

1452 
	e_UDP_TABLE_CLASS
 {

1453 
	mUDP_TABLE_BASIC
,

1454 
	mUDP_TABLE_OWNER_PID
,

1455 
	mUDP_TABLE_OWNER_MODULE


1456 } 
	tUDP_TABLE_CLASS
, *
	tPUDP_TABLE_CLASS
;

1458 
	s_MIB_UDPROW_OWNER_PID
 {

1459 
DWORD
 
	mdwLoˇlAddr
;

1460 
DWORD
 
	mdwLoˇlP‹t
;

1461 
DWORD
 
	mdwOwnögPid
;

1462 } 
	tMIB_UDPROW_OWNER_PID
, *
	tPMIB_UDPROW_OWNER_PID
;

1464 
	s_MIB_UDPTABLE_OWNER_PID
 {

1465 
DWORD
 
	mdwNumE¡rõs
;

1466 
MIB_UDPROW_OWNER_PID
 
	mèbÀ
[
ANY_SIZE
];

1467 } 
	tMIB_UDPTABLE_OWNER_PID
, *
	tPMIB_UDPTABLE_OWNER_PID
;

1470 
	s_MIB_UDP6ROW_OWNER_PID
 {

1471 
UCHAR
 
	mucLoˇlAddr
[16];

1472 
DWORD
 
	mdwLoˇlSc›eId
;

1473 
DWORD
 
	mdwLoˇlP‹t
;

1474 
DWORD
 
	mdwOwnögPid
;

1475 } 
	tMIB_UDP6ROW_OWNER_PID
, *
	tPMIB_UDP6ROW_OWNER_PID
;

1477 
	s_MIB_UDP6TABLE_OWNER_PID
 {

1478 
DWORD
 
	mdwNumE¡rõs
;

1479 
MIB_UDP6ROW_OWNER_PID
 
	mèbÀ
[
ANY_SIZE
];

1480 } 
	tMIB_UDP6TABLE_OWNER_PID
, *
	tPMIB_UDP6TABLE_OWNER_PID
;

1483 
	#BYTESWAP_USHORT
(
x
Ë((((
USHORT
)(xË<< 8Ë| ((USHORT)(xË>> 8)Ë& 0xffff)

	)

1485 #i‚de‡
AF_INET6


1486 
	#AF_INET6
 23

	)

1489 
	#_psutû_c⁄n_de¸ef_objs
() \

1490 
	`Py_DECREF
(
_AF_INET
); \

1491 
	`Py_DECREF
(
_AF_INET6
);\

1492 
	`Py_DECREF
(
_SOCK_STREAM
);\

1493 
	`Py_DECREF
(
_SOCK_DGRAM
);

	)

1496 
	gPSUTIL_CONN_NONE
 = 128;

1502 
PyObje˘
 *

1503 
	$psutû_√t_c⁄√˘i⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1505 
nuŒ_addªss
[4] = { 0, 0, 0, 0 };

1507 
pid
;

1508 
PyObje˘
 *
c⁄√˘i⁄sLi°
;

1509 
PyObje˘
 *
c⁄√˘i⁄Tu∂e
 = 
NULL
;

1510 
PyObje˘
 *
af_fûãr
 = 
NULL
;

1511 
PyObje˘
 *
ty≥_fûãr
 = 
NULL
;

1513 
PyObje˘
 *
_AF_INET
 = 
	`PyL⁄g_FromL⁄g
(()
AF_INET
);

1514 
PyObje˘
 *
_AF_INET6
 = 
	`PyL⁄g_FromL⁄g
(()
AF_INET6
);

1515 
PyObje˘
 *
_SOCK_STREAM
 = 
	`PyL⁄g_FromL⁄g
(()
SOCK_STREAM
);

1516 
PyObje˘
 *
_SOCK_DGRAM
 = 
	`PyL⁄g_FromL⁄g
(()
SOCK_DGRAM
);

1518 
	`PSTR
 (
	tNTAPI
 * 
	t_RéIpv4AddªssToSåögA
)(
	tö_addr
 *, 
	tPSTR
);

1519 
_RéIpv4AddªssToSåögA
 
πlIpv4AddªssToSåögA
;

1520 
	`PSTR
 (
	tNTAPI
 * 
	t_RéIpv6AddªssToSåögA
)(
	tö6_addr
 *, 
	tPSTR
);

1521 
_RéIpv6AddªssToSåögA
 
πlIpv6AddªssToSåögA
;

1522 
	`DWORD
 (
	tWINAPI
 * 
	t_GëExãndedT˝TabÀ
)(
	tPVOID
, 
	tPDWORD
, 
	tBOOL
, 
	tULONG
,

1523 
	tTCP_TABLE_CLASS
, 
	tULONG
);

1524 
_GëExãndedT˝TabÀ
 
gëExãndedT˝TabÀ
;

1525 
	`DWORD
 (
	tWINAPI
 * 
	t_GëExãndedUdpTabÀ
)(
	tPVOID
, 
	tPDWORD
, 
	tBOOL
, 
	tULONG
,

1526 
	tUDP_TABLE_CLASS
, 
	tULONG
);

1527 
_GëExãndedUdpTabÀ
 
gëExãndedUdpTabÀ
;

1528 
PVOID
 
èbÀ
 = 
NULL
;

1529 
DWORD
 
èbÀSize
;

1530 
PMIB_TCPTABLE_OWNER_PID
 
t˝4TabÀ
;

1531 
PMIB_UDPTABLE_OWNER_PID
 
udp4TabÀ
;

1532 
PMIB_TCP6TABLE_OWNER_PID
 
t˝6TabÀ
;

1533 
PMIB_UDP6TABLE_OWNER_PID
 
udp6TabÀ
;

1534 
ULONG
 
i
;

1535 
CHAR
 
addªssBuf„rLoˇl
[65];

1536 
PyObje˘
 *
addªssTu∂eLoˇl
 = 
NULL
;

1537 
CHAR
 
addªssBuf„rRemŸe
[65];

1538 
PyObje˘
 *
addªssTu∂eRemŸe
 = 
NULL
;

1540 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "lOO", &
pid
, &
af_fûãr
, &
ty≥_fûãr
)) {

1541 
	`_psutû_c⁄n_de¸ef_objs
();

1542  
NULL
;

1545 i‡(!
	`PySequí˚_Check
(
af_fûãr
Ë|| !PySequí˚_Check(
ty≥_fûãr
)) {

1546 
	`_psutû_c⁄n_de¸ef_objs
();

1547 
	`PyEº_SëSåög
(
PyExc_Ty≥Eº‹
, "arg 2 or 3 isÇotá sequence");

1548  
NULL
;

1551 i‡(
pid
 != -1) {

1552 i‡(
	`psutû_pid_is_ru¬ög
(
pid
) == 0) {

1553 
	`_psutû_c⁄n_de¸ef_objs
();

1554  
	`NoSuchPro˚ss
();

1560 
HMODULE
 
¡dŒ
;

1561 
HMODULE
 
ùhÕ≠i
;

1563 
¡dŒ
 = 
	`LﬂdLibøry
(
	`TEXT
("ntdll.dll"));

1564 
πlIpv4AddªssToSåögA
 = (
_RéIpv4AddªssToSåögA
)
	`GëProcAddªss
(

1565 
¡dŒ
, "RtlIpv4AddressToStringA");

1566 
πlIpv6AddªssToSåögA
 = (
_RéIpv6AddªssToSåögA
)
	`GëProcAddªss
(

1567 
¡dŒ
, "RtlIpv6AddressToStringA");

1570 
ùhÕ≠i
 = 
	`LﬂdLibøry
(
	`TEXT
("iphlpapi.dll"));

1571 
gëExãndedT˝TabÀ
 = (
_GëExãndedT˝TabÀ
)
	`GëProcAddªss
(
ùhÕ≠i
,

1573 
gëExãndedUdpTabÀ
 = (
_GëExãndedUdpTabÀ
)
	`GëProcAddªss
(
ùhÕ≠i
,

1575 
	`FªeLibøry
(
¡dŒ
);

1576 
	`FªeLibøry
(
ùhÕ≠i
);

1579 i‡((
gëExãndedT˝TabÀ
 =
NULL
Ë|| (
gëExãndedUdpTabÀ
 == NULL)) {

1580 
	`PyEº_SëSåög
(
PyExc_NŸIm∂emíãdEº‹
,

1582 
	`_psutû_c⁄n_de¸ef_objs
();

1583  
NULL
;

1586 
c⁄√˘i⁄sLi°
 = 
	`PyLi°_New
(0);

1587 i‡(
c⁄√˘i⁄sLi°
 =
NULL
) {

1588 
	`_psutû_c⁄n_de¸ef_objs
();

1589  
NULL
;

1594 i‡((
	`PySequí˚_C⁄èös
(
af_fûãr
, 
_AF_INET
) == 1) &&

1595 (
	`PySequí˚_C⁄èös
(
ty≥_fûãr
, 
_SOCK_STREAM
) == 1))

1597 
èbÀ
 = 
NULL
;

1598 
c⁄√˘i⁄Tu∂e
 = 
NULL
;

1599 
addªssTu∂eLoˇl
 = 
NULL
;

1600 
addªssTu∂eRemŸe
 = 
NULL
;

1601 
èbÀSize
 = 0;

1602 
	`gëExãndedT˝TabÀ
(
NULL
, &
èbÀSize
, 
FALSE
, 
AF_INET
,

1603 
TCP_TABLE_OWNER_PID_ALL
, 0);

1605 
èbÀ
 = 
	`mÆloc
(
èbÀSize
);

1606 i‡(
èbÀ
 =
NULL
) {

1607 
	`PyEº_NoMem‹y
();

1608 
îr‹
;

1611 i‡(
	`gëExãndedT˝TabÀ
(
èbÀ
, &
èbÀSize
, 
FALSE
, 
AF_INET
,

1612 
TCP_TABLE_OWNER_PID_ALL
, 0) == 0)

1614 
t˝4TabÀ
 = 
èbÀ
;

1616 
i
 = 0; i < 
t˝4TabÀ
->
dwNumE¡rõs
; i++)

1618 i‡(
pid
 != -1) {

1619 i‡(
t˝4TabÀ
->
èbÀ
[
i
].
dwOwnögPid
 !
pid
) {

1624 i‡(
t˝4TabÀ
->
èbÀ
[
i
].
dwLoˇlAddr
 != 0 ||

1625 
t˝4TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
 != 0)

1627 
ö_addr
 
addr
;

1629 
addr
.
S_un
.
S_addr
 = 
t˝4TabÀ
->
èbÀ
[
i
].
dwLoˇlAddr
;

1630 
	`πlIpv4AddªssToSåögA
(&
addr
, 
addªssBuf„rLoˇl
);

1631 
addªssTu∂eLoˇl
 = 
	`Py_BuûdVÆue
(

1633 
addªssBuf„rLoˇl
,

1634 
	`BYTESWAP_USHORT
(
t˝4TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
));

1637 
addªssTu∂eLoˇl
 = 
	`PyTu∂e_New
(0);

1640 i‡(
addªssTu∂eLoˇl
 =
NULL
)

1641 
îr‹
;

1645 i‡((
t˝4TabÀ
->
èbÀ
[
i
].
dwRemŸeAddr
 != 0 ||

1646 
t˝4TabÀ
->
èbÀ
[
i
].
dwRemŸeP‹t
 != 0) &&

1647 (
t˝4TabÀ
->
èbÀ
[
i
].
dwSèã
 !
MIB_TCP_STATE_LISTEN
))

1649 
ö_addr
 
addr
;

1651 
addr
.
S_un
.
S_addr
 = 
t˝4TabÀ
->
èbÀ
[
i
].
dwRemŸeAddr
;

1652 
	`πlIpv4AddªssToSåögA
(&
addr
, 
addªssBuf„rRemŸe
);

1653 
addªssTu∂eRemŸe
 = 
	`Py_BuûdVÆue
(

1655 
addªssBuf„rRemŸe
,

1656 
	`BYTESWAP_USHORT
(
t˝4TabÀ
->
èbÀ
[
i
].
dwRemŸeP‹t
));

1660 
addªssTu∂eRemŸe
 = 
	`PyTu∂e_New
(0);

1663 i‡(
addªssTu∂eRemŸe
 =
NULL
)

1664 
îr‹
;

1666 
c⁄√˘i⁄Tu∂e
 = 
	`Py_BuûdVÆue
(

1669 
AF_INET
,

1670 
SOCK_STREAM
,

1671 
addªssTu∂eLoˇl
,

1672 
addªssTu∂eRemŸe
,

1673 
t˝4TabÀ
->
èbÀ
[
i
].
dwSèã
,

1674 
t˝4TabÀ
->
èbÀ
[
i
].
dwOwnögPid
);

1675 i‡(!
c⁄√˘i⁄Tu∂e
)

1676 
îr‹
;

1677 i‡(
	`PyLi°_Aµíd
(
c⁄√˘i⁄sLi°
, 
c⁄√˘i⁄Tu∂e
))

1678 
îr‹
;

1679 
	`Py_DECREF
(
c⁄√˘i⁄Tu∂e
);

1683 
	`‰ì
(
èbÀ
);

1688 i‡((
	`PySequí˚_C⁄èös
(
af_fûãr
, 
_AF_INET6
) == 1) &&

1689 (
	`PySequí˚_C⁄èös
(
ty≥_fûãr
, 
_SOCK_STREAM
) == 1))

1691 
èbÀ
 = 
NULL
;

1692 
c⁄√˘i⁄Tu∂e
 = 
NULL
;

1693 
addªssTu∂eLoˇl
 = 
NULL
;

1694 
addªssTu∂eRemŸe
 = 
NULL
;

1695 
èbÀSize
 = 0;

1696 
	`gëExãndedT˝TabÀ
(
NULL
, &
èbÀSize
, 
FALSE
, 
AF_INET6
,

1697 
TCP_TABLE_OWNER_PID_ALL
, 0);

1699 
èbÀ
 = 
	`mÆloc
(
èbÀSize
);

1700 i‡(
èbÀ
 =
NULL
) {

1701 
	`PyEº_NoMem‹y
();

1702 
îr‹
;

1705 i‡(
	`gëExãndedT˝TabÀ
(
èbÀ
, &
èbÀSize
, 
FALSE
, 
AF_INET6
,

1706 
TCP_TABLE_OWNER_PID_ALL
, 0) == 0)

1708 
t˝6TabÀ
 = 
èbÀ
;

1710 
i
 = 0; i < 
t˝6TabÀ
->
dwNumE¡rõs
; i++)

1712 i‡(
pid
 != -1) {

1713 i‡(
t˝6TabÀ
->
èbÀ
[
i
].
dwOwnögPid
 !
pid
) {

1718 i‡(
	`memcmp
(
t˝6TabÀ
->
èbÀ
[
i
].
ucLoˇlAddr
, 
nuŒ_addªss
, 16)

1719 !0 || 
t˝6TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
 != 0)

1721 
ö6_addr
 
addr
;

1723 
	`mem˝y
(&
addr
, 
t˝6TabÀ
->
èbÀ
[
i
].
ucLoˇlAddr
, 16);

1724 
	`πlIpv6AddªssToSåögA
(&
addr
, 
addªssBuf„rLoˇl
);

1725 
addªssTu∂eLoˇl
 = 
	`Py_BuûdVÆue
(

1727 
addªssBuf„rLoˇl
,

1728 
	`BYTESWAP_USHORT
(
t˝6TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
));

1732 
addªssTu∂eLoˇl
 = 
	`PyTu∂e_New
(0);

1735 i‡(
addªssTu∂eLoˇl
 =
NULL
)

1736 
îr‹
;

1740 i‡((
	`memcmp
(
t˝6TabÀ
->
èbÀ
[
i
].
ucRemŸeAddr
, 
nuŒ_addªss
, 16)

1742 
t˝6TabÀ
->
èbÀ
[
i
].
dwRemŸeP‹t
 != 0) &&

1743 (
t˝6TabÀ
->
èbÀ
[
i
].
dwSèã
 !
MIB_TCP_STATE_LISTEN
))

1745 
ö6_addr
 
addr
;

1747 
	`mem˝y
(&
addr
, 
t˝6TabÀ
->
èbÀ
[
i
].
ucRemŸeAddr
, 16);

1748 
	`πlIpv6AddªssToSåögA
(&
addr
, 
addªssBuf„rRemŸe
);

1749 
addªssTu∂eRemŸe
 = 
	`Py_BuûdVÆue
(

1751 
addªssBuf„rRemŸe
,

1752 
	`BYTESWAP_USHORT
(
t˝6TabÀ
->
èbÀ
[
i
].
dwRemŸeP‹t
));

1756 
addªssTu∂eRemŸe
 = 
	`PyTu∂e_New
(0);

1759 i‡(
addªssTu∂eRemŸe
 =
NULL
)

1760 
îr‹
;

1762 
c⁄√˘i⁄Tu∂e
 = 
	`Py_BuûdVÆue
(

1765 
AF_INET6
,

1766 
SOCK_STREAM
,

1767 
addªssTu∂eLoˇl
,

1768 
addªssTu∂eRemŸe
,

1769 
t˝6TabÀ
->
èbÀ
[
i
].
dwSèã
,

1770 
t˝6TabÀ
->
èbÀ
[
i
].
dwOwnögPid
);

1771 i‡(!
c⁄√˘i⁄Tu∂e
)

1772 
îr‹
;

1773 i‡(
	`PyLi°_Aµíd
(
c⁄√˘i⁄sLi°
, 
c⁄√˘i⁄Tu∂e
))

1774 
îr‹
;

1775 
	`Py_DECREF
(
c⁄√˘i⁄Tu∂e
);

1779 
	`‰ì
(
èbÀ
);

1784 i‡((
	`PySequí˚_C⁄èös
(
af_fûãr
, 
_AF_INET
) == 1) &&

1785 (
	`PySequí˚_C⁄èös
(
ty≥_fûãr
, 
_SOCK_DGRAM
) == 1))

1787 
èbÀ
 = 
NULL
;

1788 
c⁄√˘i⁄Tu∂e
 = 
NULL
;

1789 
addªssTu∂eLoˇl
 = 
NULL
;

1790 
addªssTu∂eRemŸe
 = 
NULL
;

1791 
èbÀSize
 = 0;

1792 
	`gëExãndedUdpTabÀ
(
NULL
, &
èbÀSize
, 
FALSE
, 
AF_INET
,

1793 
UDP_TABLE_OWNER_PID
, 0);

1795 
èbÀ
 = 
	`mÆloc
(
èbÀSize
);

1796 i‡(
èbÀ
 =
NULL
) {

1797 
	`PyEº_NoMem‹y
();

1798 
îr‹
;

1801 i‡(
	`gëExãndedUdpTabÀ
(
èbÀ
, &
èbÀSize
, 
FALSE
, 
AF_INET
,

1802 
UDP_TABLE_OWNER_PID
, 0) == 0)

1804 
udp4TabÀ
 = 
èbÀ
;

1806 
i
 = 0; i < 
udp4TabÀ
->
dwNumE¡rõs
; i++)

1808 i‡(
pid
 != -1) {

1809 i‡(
udp4TabÀ
->
èbÀ
[
i
].
dwOwnögPid
 !
pid
) {

1814 i‡(
udp4TabÀ
->
èbÀ
[
i
].
dwLoˇlAddr
 != 0 ||

1815 
udp4TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
 != 0)

1817 
ö_addr
 
addr
;

1819 
addr
.
S_un
.
S_addr
 = 
udp4TabÀ
->
èbÀ
[
i
].
dwLoˇlAddr
;

1820 
	`πlIpv4AddªssToSåögA
(&
addr
, 
addªssBuf„rLoˇl
);

1821 
addªssTu∂eLoˇl
 = 
	`Py_BuûdVÆue
(

1823 
addªssBuf„rLoˇl
,

1824 
	`BYTESWAP_USHORT
(
udp4TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
));

1827 
addªssTu∂eLoˇl
 = 
	`PyTu∂e_New
(0);

1830 i‡(
addªssTu∂eLoˇl
 =
NULL
)

1831 
îr‹
;

1833 
c⁄√˘i⁄Tu∂e
 = 
	`Py_BuûdVÆue
(

1836 
AF_INET
,

1837 
SOCK_DGRAM
,

1838 
addªssTu∂eLoˇl
,

1839 
	`PyTu∂e_New
(0),

1840 
PSUTIL_CONN_NONE
,

1841 
udp4TabÀ
->
èbÀ
[
i
].
dwOwnögPid
);

1842 i‡(!
c⁄√˘i⁄Tu∂e
)

1843 
îr‹
;

1844 i‡(
	`PyLi°_Aµíd
(
c⁄√˘i⁄sLi°
, 
c⁄√˘i⁄Tu∂e
))

1845 
îr‹
;

1846 
	`Py_DECREF
(
c⁄√˘i⁄Tu∂e
);

1850 
	`‰ì
(
èbÀ
);

1855 i‡((
	`PySequí˚_C⁄èös
(
af_fûãr
, 
_AF_INET6
) == 1) &&

1856 (
	`PySequí˚_C⁄èös
(
ty≥_fûãr
, 
_SOCK_DGRAM
) == 1))

1858 
èbÀ
 = 
NULL
;

1859 
c⁄√˘i⁄Tu∂e
 = 
NULL
;

1860 
addªssTu∂eLoˇl
 = 
NULL
;

1861 
addªssTu∂eRemŸe
 = 
NULL
;

1862 
èbÀSize
 = 0;

1863 
	`gëExãndedUdpTabÀ
(
NULL
, &
èbÀSize
, 
FALSE
,

1864 
AF_INET6
, 
UDP_TABLE_OWNER_PID
, 0);

1866 
èbÀ
 = 
	`mÆloc
(
èbÀSize
);

1867 i‡(
èbÀ
 =
NULL
) {

1868 
	`PyEº_NoMem‹y
();

1869 
îr‹
;

1872 i‡(
	`gëExãndedUdpTabÀ
(
èbÀ
, &
èbÀSize
, 
FALSE
, 
AF_INET6
,

1873 
UDP_TABLE_OWNER_PID
, 0) == 0)

1875 
udp6TabÀ
 = 
èbÀ
;

1877 
i
 = 0; i < 
udp6TabÀ
->
dwNumE¡rõs
; i++)

1879 i‡(
pid
 != -1) {

1880 i‡(
udp6TabÀ
->
èbÀ
[
i
].
dwOwnögPid
 !
pid
) {

1885 i‡(
	`memcmp
(
udp6TabÀ
->
èbÀ
[
i
].
ucLoˇlAddr
, 
nuŒ_addªss
, 16)

1886 !0 || 
udp6TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
 != 0)

1888 
ö6_addr
 
addr
;

1890 
	`mem˝y
(&
addr
, 
udp6TabÀ
->
èbÀ
[
i
].
ucLoˇlAddr
, 16);

1891 
	`πlIpv6AddªssToSåögA
(&
addr
, 
addªssBuf„rLoˇl
);

1892 
addªssTu∂eLoˇl
 = 
	`Py_BuûdVÆue
(

1894 
addªssBuf„rLoˇl
,

1895 
	`BYTESWAP_USHORT
(
udp6TabÀ
->
èbÀ
[
i
].
dwLoˇlP‹t
));

1898 
addªssTu∂eLoˇl
 = 
	`PyTu∂e_New
(0);

1901 i‡(
addªssTu∂eLoˇl
 =
NULL
)

1902 
îr‹
;

1904 
c⁄√˘i⁄Tu∂e
 = 
	`Py_BuûdVÆue
(

1907 
AF_INET6
,

1908 
SOCK_DGRAM
,

1909 
addªssTu∂eLoˇl
,

1910 
	`PyTu∂e_New
(0),

1911 
PSUTIL_CONN_NONE
,

1912 
udp6TabÀ
->
èbÀ
[
i
].
dwOwnögPid
);

1913 i‡(!
c⁄√˘i⁄Tu∂e
)

1914 
îr‹
;

1915 i‡(
	`PyLi°_Aµíd
(
c⁄√˘i⁄sLi°
, 
c⁄√˘i⁄Tu∂e
))

1916 
îr‹
;

1917 
	`Py_DECREF
(
c⁄√˘i⁄Tu∂e
);

1921 
	`‰ì
(
èbÀ
);

1924 
	`_psutû_c⁄n_de¸ef_objs
();

1925  
c⁄√˘i⁄sLi°
;

1927 
îr‹
:

1928 
	`_psutû_c⁄n_de¸ef_objs
();

1929 
	`Py_XDECREF
(
c⁄√˘i⁄Tu∂e
);

1930 
	`Py_XDECREF
(
addªssTu∂eLoˇl
);

1931 
	`Py_XDECREF
(
addªssTu∂eRemŸe
);

1932 
	`Py_DECREF
(
c⁄√˘i⁄sLi°
);

1933 i‡(
èbÀ
 !
NULL
)

1934 
	`‰ì
(
èbÀ
);

1935  
NULL
;

1936 
	}
}

1942 
PyObje˘
 *

1943 
	$psutû_¥oc_¥i‹ôy_gë
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1945 
pid
;

1946 
DWORD
 
¥i‹ôy
;

1947 
HANDLE
 
hPro˚ss
;

1948 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

1949  
NULL
;

1952 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

1953 i‡(
hPro˚ss
 =
NULL
) {

1954  
NULL
;

1957 
¥i‹ôy
 = 
	`GëPri‹ôyCœss
(
hPro˚ss
);

1958 
	`Clo£H™dÀ
(
hPro˚ss
);

1959 i‡(
¥i‹ôy
 == 0) {

1960 
	`PyEº_SëFromWödowsEº
(0);

1961  
NULL
;

1963  
	`Py_BuûdVÆue
("i", 
¥i‹ôy
);

1964 
	}
}

1970 
PyObje˘
 *

1971 
	$psutû_¥oc_¥i‹ôy_£t
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

1973 
pid
;

1974 
¥i‹ôy
;

1975 
ªtvÆ
;

1976 
HANDLE
 
hPro˚ss
;

1977 
DWORD
 
dwDesúedAc˚ss
 = \

1978 
PROCESS_QUERY_INFORMATION
 | 
PROCESS_SET_INFORMATION
;

1979 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "li", &
pid
, &
¥i‹ôy
)) {

1980  
NULL
;

1983 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid_wac˚ss
(
pid
, 
dwDesúedAc˚ss
);

1984 i‡(
hPro˚ss
 =
NULL
) {

1985  
NULL
;

1988 
ªtvÆ
 = 
	`SëPri‹ôyCœss
(
hPro˚ss
, 
¥i‹ôy
);

1989 
	`Clo£H™dÀ
(
hPro˚ss
);

1990 i‡(
ªtvÆ
 == 0) {

1991 
	`PyEº_SëFromWödowsEº
(0);

1992  
NULL
;

1994 
	`Py_INCREF
(
Py_N⁄e
);

1995  
Py_N⁄e
;

1996 
	}
}

1999 #i‡(
_WIN32_WINNT
 >= 0x0600)

2003 
PyObje˘
 *

2004 
	$psutû_¥oc_io_¥i‹ôy_gë
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2006 
pid
;

2007 
HANDLE
 
hPro˚ss
;

2008 
PULONG
 
IoPri‹ôy
;

2010 
_NtQuîyInf‹m©i⁄Pro˚ss
 
NtQuîyInf‹m©i⁄Pro˚ss
 =

2011 (
_NtQuîyInf‹m©i⁄Pro˚ss
)
	`GëProcAddªss
(

2012 
	`GëModuÀH™dÀA
("ntdll.dll"), "NtQueryInformationProcess");

2014 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2015  
NULL
;

2017 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

2018 i‡(
hPro˚ss
 =
NULL
) {

2019  
NULL
;

2022 
	`NtQuîyInf‹m©i⁄Pro˚ss
(

2023 
hPro˚ss
,

2024 
Pro˚ssIoPri‹ôy
,

2025 &
IoPri‹ôy
,

2026 (
ULONG
),

2027 
NULL


2029 
	`Clo£H™dÀ
(
hPro˚ss
);

2030  
	`Py_BuûdVÆue
("i", 
IoPri‹ôy
);

2031 
	}
}

2037 
PyObje˘
 *

2038 
	$psutû_¥oc_io_¥i‹ôy_£t
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2040 
pid
;

2041 
¥io
;

2042 
HANDLE
 
hPro˚ss
;

2044 
_NtSëInf‹m©i⁄Pro˚ss
 
NtSëInf‹m©i⁄Pro˚ss
 =

2045 (
_NtSëInf‹m©i⁄Pro˚ss
)
	`GëProcAddªss
(

2046 
	`GëModuÀH™dÀA
("ntdll.dll"), "NtSetInformationProcess");

2048 i‡(
NtSëInf‹m©i⁄Pro˚ss
 =
NULL
) {

2049 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
,

2051  
NULL
;

2054 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "li", &
pid
, &
¥io
)) {

2055  
NULL
;

2057 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid_wac˚ss
(
pid
, 
PROCESS_ALL_ACCESS
);

2058 i‡(
hPro˚ss
 =
NULL
) {

2059  
NULL
;

2062 
	`NtSëInf‹m©i⁄Pro˚ss
(

2063 
hPro˚ss
,

2064 
Pro˚ssIoPri‹ôy
,

2065 (
PVOID
)&
¥io
,

2066 ((
PVOID
)
¥io
)

2069 
	`Clo£H™dÀ
(
hPro˚ss
);

2070 
	`Py_INCREF
(
Py_N⁄e
);

2071  
Py_N⁄e
;

2072 
	}
}

2079 
PyObje˘
 *

2080 
	$psutû_¥oc_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2082 
DWORD
 
pid
;

2083 
HANDLE
 
hPro˚ss
;

2084 
IO_COUNTERS
 
IoCou¡îs
;

2086 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2087  
NULL
;

2089 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

2090 i‡(
NULL
 =
hPro˚ss
) {

2091  
NULL
;

2093 i‡(! 
	`GëPro˚ssIoCou¡îs
(
hPro˚ss
, &
IoCou¡îs
)) {

2094 
	`Clo£H™dÀ
(
hPro˚ss
);

2095  
	`PyEº_SëFromWödowsEº
(0);

2097 
	`Clo£H™dÀ
(
hPro˚ss
);

2098  
	`Py_BuûdVÆue
("(KKKK)",

2099 
IoCou¡îs
.
RódO≥øti⁄Cou¡
,

2100 
IoCou¡îs
.
WrôeO≥øti⁄Cou¡
,

2101 
IoCou¡îs
.
RódTøns„rCou¡
,

2102 
IoCou¡îs
.
WrôeTøns„rCou¡
);

2103 
	}
}

2109 
PyObje˘
 *

2110 
	$psutû_¥oc_io_cou¡îs_2
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2112 
DWORD
 
pid
;

2113 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

2114 
PVOID
 
buf„r
;

2115 
LONGLONG
 
rcou¡
, 
wcou¡
, 
rbyãs
, 
wbyãs
;

2117 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2118  
NULL
;

2120 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

2121  
NULL
;

2123 
rcou¡
 = 
¥o˚ss
->
RódO≥øti⁄Cou¡
.
QuadP¨t
;

2124 
wcou¡
 = 
¥o˚ss
->
WrôeO≥øti⁄Cou¡
.
QuadP¨t
;

2125 
rbyãs
 = 
¥o˚ss
->
RódTøns„rCou¡
.
QuadP¨t
;

2126 
wbyãs
 = 
¥o˚ss
->
WrôeTøns„rCou¡
.
QuadP¨t
;

2127 
	`‰ì
(
buf„r
);

2128  
	`Py_BuûdVÆue
("KKKK", 
rcou¡
, 
wcou¡
, 
rbyãs
, 
wbyãs
);

2129 
	}
}

2135 
PyObje˘
 *

2136 
	$psutû_¥oc_˝u_afföôy_gë
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2138 
DWORD
 
pid
;

2139 
HANDLE
 
hPro˚ss
;

2140 
PDWORD_PTR
 
¥oc_mask
;

2141 
PDWORD_PTR
 
sy°em_mask
;

2143 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2144  
NULL
;

2146 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

2147 i‡(
hPro˚ss
 =
NULL
) {

2148  
NULL
;

2150 i‡(
	`GëPro˚ssAfföôyMask
(
hPro˚ss
, &
¥oc_mask
, &
sy°em_mask
) == 0) {

2151 
	`Clo£H™dÀ
(
hPro˚ss
);

2152  
	`PyEº_SëFromWödowsEº
(0);

2155 
	`Clo£H™dÀ
(
hPro˚ss
);

2156 #ifde‡
_WIN64


2157  
	`Py_BuûdVÆue
("K", ()
¥oc_mask
);

2159  
	`Py_BuûdVÆue
("k", ()
¥oc_mask
);

2161 
	}
}

2167 
PyObje˘
 *

2168 
	$psutû_¥oc_˝u_afföôy_£t
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2170 
DWORD
 
pid
;

2171 
HANDLE
 
hPro˚ss
;

2172 
DWORD
 
dwDesúedAc˚ss
 = \

2173 
PROCESS_QUERY_INFORMATION
 | 
PROCESS_SET_INFORMATION
;

2174 
DWORD_PTR
 
mask
;

2176 #ifde‡
_WIN64


2177 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "lK", &
pid
, &
mask
))

2179 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "lk", &
pid
, &
mask
))

2182  
NULL
;

2184 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid_wac˚ss
(
pid
, 
dwDesúedAc˚ss
);

2185 i‡(
hPro˚ss
 =
NULL
) {

2186  
NULL
;

2189 i‡(
	`SëPro˚ssAfföôyMask
(
hPro˚ss
, 
mask
) == 0) {

2190 
	`Clo£H™dÀ
(
hPro˚ss
);

2191  
	`PyEº_SëFromWödowsEº
(0);

2194 
	`Clo£H™dÀ
(
hPro˚ss
);

2195 
	`Py_INCREF
(
Py_N⁄e
);

2196  
Py_N⁄e
;

2197 
	}
}

2204 
PyObje˘
 *

2205 
	$psutû_¥oc_is_su•íded
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2207 
DWORD
 
pid
;

2208 
ULONG
 
i
;

2209 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

2210 
PVOID
 
buf„r
;

2212 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2213  
NULL
;

2215 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

2216  
NULL
;

2218 
i
 = 0; i < 
¥o˚ss
->
NumbîOfThªads
; i++) {

2219 i‡(
¥o˚ss
->
Thªads
[
i
].
ThªadSèã
 !
Waôög
 ||

2220 
¥o˚ss
->
Thªads
[
i
].
WaôRós⁄
 !
Su•íded
)

2222 
	`‰ì
(
buf„r
);

2223 
Py_RETURN_FALSE
;

2226 
	`‰ì
(
buf„r
);

2227 
Py_RETURN_TRUE
;

2228 
	}
}

2234 
PyObje˘
 *

2235 
	$psutû_disk_ußge
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2237 
BOOL
 
ªtvÆ
;

2238 
ULARGE_INTEGER
 
_
, 
tŸÆ
, 
‰ì
;

2239 *
∑th
;

2241 i‡(
	`PyArg_P¨£Tu∂e
(
¨gs
, "u", &
∑th
)) {

2242 
Py_BEGIN_ALLOW_THREADS


2243 
ªtvÆ
 = 
	`GëDiskFªeS∑˚ExW
((
LPCWSTR
)
∑th
, &
_
, &
tŸÆ
, &
‰ì
);

2244 
Py_END_ALLOW_THREADS


2245 
ªtu∫_
;

2250 #i‡
PY_MAJOR_VERSION
 <= 2

2251 
	`PyEº_CÀ¨
();

2252 i‡(
	`PyArg_P¨£Tu∂e
(
¨gs
, "s", &
∑th
)) {

2253 
Py_BEGIN_ALLOW_THREADS


2254 
ªtvÆ
 = 
	`GëDiskFªeS∑˚Ex
(
∑th
, &
_
, &
tŸÆ
, &
‰ì
);

2255 
Py_END_ALLOW_THREADS


2256 
ªtu∫_
;

2260  
NULL
;

2262 
ªtu∫_
:

2263 i‡(
ªtvÆ
 == 0)

2264  
	`PyEº_SëFromWödowsEº
(0);

2266  
	`Py_BuûdVÆue
("(LL)", 
tŸÆ
.
QuadP¨t
, 
‰ì
.QuadPart);

2267 
	}
}

2273 
PyObje˘
 *

2274 
	$psutû_√t_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2276 
©ãm±s
 = 0;

2277 
i
;

2278 
outBufLí
 = 15000;

2279 
i‚ame
[
MAX_PATH
];

2280 
DWORD
 
dwRëVÆ
 = 0;

2281 
MIB_IFROW
 *
pIfRow
 = 
NULL
;

2282 
ULONG
 
Êags
 = 0;

2283 
ULONG
 
Ámûy
 = 
AF_UNSPEC
;

2284 
PIP_ADAPTER_ADDRESSES
 
pAddªs£s
 = 
NULL
;

2285 
PIP_ADAPTER_ADDRESSES
 
pCuºAddªs£s
 = 
NULL
;

2287 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

2288 
PyObje˘
 *
py_nic_öfo
 = 
NULL
;

2289 
PyObje˘
 *
py_nic_«me
 = 
NULL
;

2291 i‡(
py_ªtdi˘
 =
NULL
) {

2292  
NULL
;

2295 
pAddªs£s
 = (
IP_ADAPTER_ADDRESSES
 *Ë
	`mÆloc
(
outBufLí
);

2296 i‡(
pAddªs£s
 =
NULL
) {

2297 
	`PyEº_NoMem‹y
();

2298 
îr‹
;

2301 
dwRëVÆ
 = 
	`GëAd≠ãrsAddªs£s
(
Ámûy
, 
Êags
, 
NULL
, 
pAddªs£s
,

2302 &
outBufLí
);

2303 i‡(
dwRëVÆ
 =
ERROR_BUFFER_OVERFLOW
) {

2304 
	`‰ì
(
pAddªs£s
);

2305 
pAddªs£s
 = 
NULL
;

2311 
©ãm±s
++;

2312 } (
dwRëVÆ
 =
ERROR_BUFFER_OVERFLOW
Ë&& (
©ãm±s
 < 3));

2314 i‡(
dwRëVÆ
 !
NO_ERROR
) {

2315 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "GetAdaptersAddresses() failed.");

2316 
îr‹
;

2319 
pCuºAddªs£s
 = 
pAddªs£s
;

2320 
pCuºAddªs£s
) {

2321 
py_nic_«me
 = 
NULL
;

2322 
py_nic_öfo
 = 
NULL
;

2323 
pIfRow
 = (
MIB_IFROW
 *Ë
	`mÆloc
((MIB_IFROW));

2325 i‡(
pIfRow
 =
NULL
) {

2326 
	`PyEº_NoMem‹y
();

2327 
îr‹
;

2330 
pIfRow
->
dwIndex
 = 
pCuºAddªs£s
->
IfIndex
;

2331 
dwRëVÆ
 = 
	`GëIfE¡ry
(
pIfRow
);

2332 i‡(
dwRëVÆ
 !
NO_ERROR
) {

2333 
	`PyEº_SëSåög
(
PyExc_Ru¡imeEº‹
, "GetIfEntry() failed.");

2334 
îr‹
;

2337 
py_nic_öfo
 = 
	`Py_BuûdVÆue
("(kkkkkkkk)",

2338 
pIfRow
->
dwOutO˘ës
,

2339 
pIfRow
->
dwInO˘ës
,

2340 
pIfRow
->
dwOutUˇ°Pkts
,

2341 
pIfRow
->
dwInUˇ°Pkts
,

2342 
pIfRow
->
dwInEº‹s
,

2343 
pIfRow
->
dwOutEº‹s
,

2344 
pIfRow
->
dwInDisˇrds
,

2345 
pIfRow
->
dwOutDisˇrds
);

2346 i‡(!
py_nic_öfo
)

2347 
îr‹
;

2349 
	`•rötf
(
i‚ame
, "%wS", 
pCuºAddªs£s
->
FrõndlyName
);

2351 #i‡
PY_MAJOR_VERSION
 >= 3

2354 
i
 = 0; i < 
MAX_PATH
; i++) {

2355 i‡(*(
i‚ame
+
i
) < 0 || *(ifname+i) > 256) {

2357 *(
i‚ame
+
i
) = '?';

2359 i‡(*(
i‚ame
+
i
) == '\0') {

2364 
py_nic_«me
 = 
	`Py_BuûdVÆue
("s", 
i‚ame
);

2365 i‡(
py_nic_«me
 =
NULL
)

2366 
îr‹
;

2367 i‡(
	`PyDi˘_SëIãm
(
py_ªtdi˘
, 
py_nic_«me
, 
py_nic_öfo
))

2368 
îr‹
;

2369 
	`Py_XDECREF
(
py_nic_«me
);

2370 
	`Py_XDECREF
(
py_nic_öfo
);

2372 
	`‰ì
(
pIfRow
);

2373 
pCuºAddªs£s
 =ÖCuºAddªs£s->
Next
;

2376 
	`‰ì
(
pAddªs£s
);

2377  
py_ªtdi˘
;

2379 
îr‹
:

2380 
	`Py_XDECREF
(
py_nic_«me
);

2381 
	`Py_XDECREF
(
py_nic_öfo
);

2382 
	`Py_DECREF
(
py_ªtdi˘
);

2383 i‡(
pAddªs£s
 !
NULL
)

2384 
	`‰ì
(
pAddªs£s
);

2385 i‡(
pIfRow
 !
NULL
)

2386 
	`‰ì
(
pIfRow
);

2387  
NULL
;

2388 
	}
}

2392 
	s_DISK_PERFORMANCE_WIN_2008
 {

2393 
LARGE_INTEGER
 
	mByãsRód
;

2394 
LARGE_INTEGER
 
	mByãsWrôãn
;

2395 
LARGE_INTEGER
 
	mRódTime
;

2396 
LARGE_INTEGER
 
	mWrôeTime
;

2397 
LARGE_INTEGER
 
	mIdÀTime
;

2398 
DWORD
 
	mRódCou¡
;

2399 
DWORD
 
	mWrôeCou¡
;

2400 
DWORD
 
	mQueueDïth
;

2401 
DWORD
 
	mS∂ôCou¡
;

2402 
LARGE_INTEGER
 
	mQuîyTime
;

2403 
DWORD
 
	mSt‹ageDevi˚Numbî
;

2404 
WCHAR
 
	mSt‹ageM™agîName
[8];

2405 } 
	tDISK_PERFORMANCE_WIN_2008
;

2410 
PyObje˘
 *

2411 
	$psutû_disk_io_cou¡îs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2413 
DISK_PERFORMANCE_WIN_2008
 
diskPîf‹m™˚
;

2414 
DWORD
 
dwSize
;

2415 
HANDLE
 
hDevi˚
 = 
NULL
;

2416 
szDevi˚
[
MAX_PATH
];

2417 
szDevi˚Di•œy
[
MAX_PATH
];

2418 
devNum
;

2419 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

2420 
PyObje˘
 *
py_disk_öfo
 = 
NULL
;

2421 i‡(
py_ªtdi˘
 =
NULL
) {

2422  
NULL
;

2429 
devNum
 = 0; devNum <= 32; ++devNum) {

2430 
py_disk_öfo
 = 
NULL
;

2431 
	`•rötf
(
szDevi˚
, "\\\\.\\PhysiˇlDrive%d", 
devNum
);

2432 
hDevi˚
 = 
	`Cª©eFûe
(
szDevi˚
, 0, 
FILE_SHARE_READ
 | 
FILE_SHARE_WRITE
,

2433 
NULL
, 
OPEN_EXISTING
, 0, NULL);

2435 i‡(
hDevi˚
 =
INVALID_HANDLE_VALUE
) {

2438 i‡(
	`Devi˚IoC⁄åﬁ
(
hDevi˚
, 
IOCTL_DISK_PERFORMANCE
, 
NULL
, 0,

2439 &
diskPîf‹m™˚
, (diskPerformance),

2440 &
dwSize
, 
NULL
))

2442 
	`•rötf
(
szDevi˚Di•œy
, "PhysiˇlDrive%d", 
devNum
);

2443 
py_disk_öfo
 = 
	`Py_BuûdVÆue
(

2445 
diskPîf‹m™˚
.
RódCou¡
,

2446 
diskPîf‹m™˚
.
WrôeCou¡
,

2447 
diskPîf‹m™˚
.
ByãsRód
,

2448 
diskPîf‹m™˚
.
ByãsWrôãn
,

2449 (
diskPîf‹m™˚
.
RódTime
.
QuadP¨t
 * 10) / 1000,

2450 (
diskPîf‹m™˚
.
WrôeTime
.
QuadP¨t
 * 10) / 1000);

2451 i‡(!
py_disk_öfo
)

2452 
îr‹
;

2453 i‡(
	`PyDi˘_SëIãmSåög
(
py_ªtdi˘
, 
szDevi˚Di•œy
,

2454 
py_disk_öfo
))

2456 
îr‹
;

2458 
	`Py_XDECREF
(
py_disk_öfo
);

2467 
	`Clo£H™dÀ
(
hDevi˚
);

2470  
py_ªtdi˘
;

2472 
îr‹
:

2473 
	`Py_XDECREF
(
py_disk_öfo
);

2474 
	`Py_DECREF
(
py_ªtdi˘
);

2475 i‡(
hDevi˚
 !
NULL
)

2476 
	`Clo£H™dÀ
(
hDevi˚
);

2477  
NULL
;

2478 
	}
}

2481 *
	$psutû_gë_drive_ty≥
(
ty≥
)

2483 
ty≥
) {

2484 
DRIVE_FIXED
:

2486 
DRIVE_CDROM
:

2488 
DRIVE_REMOVABLE
:

2490 
DRIVE_UNKNOWN
:

2492 
DRIVE_NO_ROOT_DIR
:

2494 
DRIVE_REMOTE
:

2496 
DRIVE_RAMDISK
:

2501 
	}
}

2504 #i‚de‡
_ARRAYSIZE


2505 
	#_ARRAYSIZE
(
a
Ë(◊)/◊[0]))

	)

2512 
PyObje˘
 *

2513 
	$psutû_disk_∑πôi⁄s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2515 
DWORD
 
num_byãs
;

2516 
drive_°rögs
[255];

2517 *
drive_Àâî
 = 
drive_°rögs
;

2518 
Æl
;

2519 
ty≥
;

2520 
ªt
;

2521 
›ts
[20];

2522 
LPTSTR
 
fs_ty≥
[
MAX_PATH
 + 1] = { 0 };

2523 
DWORD
 
pÊags
 = 0;

2524 
PyObje˘
 *
py_Æl
;

2525 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

2526 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

2528 i‡(
py_ªéi°
 =
NULL
) {

2529  
NULL
;

2534 
	`SëEº‹Mode
(
SEM_FAILCRITICALERRORS
);

2536 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "O", &
py_Æl
)) {

2537 
îr‹
;

2539 
Æl
 = 
	`PyObje˘_IsTrue
(
py_Æl
);

2541 
Py_BEGIN_ALLOW_THREADS


2542 
num_byãs
 = 
	`GëLogiˇlDriveSåögs
(254, 
drive_Àâî
);

2543 
Py_END_ALLOW_THREADS


2545 i‡(
num_byãs
 == 0) {

2546 
	`PyEº_SëFromWödowsEº
(0);

2547 
îr‹
;

2550 *
drive_Àâî
 != 0) {

2551 
py_tu∂e
 = 
NULL
;

2552 
›ts
[0] = 0;

2553 
fs_ty≥
[0] = 0;

2555 
Py_BEGIN_ALLOW_THREADS


2556 
ty≥
 = 
	`GëDriveTy≥
(
drive_Àâî
);

2557 
Py_END_ALLOW_THREADS


2560 i‡(
Æl
 == 0) {

2561 i‡((
ty≥
 =
DRIVE_UNKNOWN
) ||

2562 (
ty≥
 =
DRIVE_NO_ROOT_DIR
) ||

2563 (
ty≥
 =
DRIVE_REMOTE
) ||

2564 (
ty≥
 =
DRIVE_RAMDISK
)) {

2565 
√xt
;

2569 i‡((
ty≥
 =
DRIVE_REMOVABLE
) &&

2570 (
	`°rcmp
(
drive_Àâî
, "A:\\") == 0)) {

2571 
√xt
;

2575 
ªt
 = 
	`GëVﬁumeInf‹m©i⁄
(

2576 (
LPCTSTR
)
drive_Àâî
, 
NULL
, 
	`_ARRAYSIZE
(drive_letter),

2577 
NULL
, NULL, &
pÊags
, (
LPTSTR
)
fs_ty≥
, 
	`_ARRAYSIZE
(fs_type));

2578 i‡(
ªt
 == 0) {

2583 
	`°rˇt
(
›ts
, "");

2584 
	`SëLa°Eº‹
(0);

2587 i‡(
pÊags
 & 
FILE_READ_ONLY_VOLUME
) {

2588 
	`°rˇt
(
›ts
, "ro");

2591 
	`°rˇt
(
›ts
, "rw");

2593 i‡(
pÊags
 & 
FILE_VOLUME_IS_COMPRESSED
) {

2594 
	`°rˇt
(
›ts
, ",compressed");

2598 i‡(
	`°æí
(
›ts
) > 0) {

2599 
	`°rˇt
(
›ts
, ",");

2601 
	`°rˇt
(
›ts
, 
	`psutû_gë_drive_ty≥
(
ty≥
));

2603 
py_tu∂e
 = 
	`Py_BuûdVÆue
(

2605 
drive_Àâî
,

2606 
drive_Àâî
,

2607 
fs_ty≥
,

2608 
›ts
);

2609 i‡(!
py_tu∂e
)

2610 
îr‹
;

2611 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

2612 
îr‹
;

2613 
	`Py_DECREF
(
py_tu∂e
);

2614 
√xt
;

2616 
√xt
:

2617 
drive_Àâî
 = 
	`°rchr
(drive_letter, 0) + 1;

2620 
	`SëEº‹Mode
(0);

2621  
py_ªéi°
;

2623 
îr‹
:

2624 
	`SëEº‹Mode
(0);

2625 
	`Py_XDECREF
(
py_tu∂e
);

2626 
	`Py_DECREF
(
py_ªéi°
);

2627  
NULL
;

2628 
	}
}

2631 #ifde‡
UNICODE


2632 
	#WTSO≥nSîvî
 
WTSO≥nSîvîW


	)

2634 
	#WTSO≥nSîvî
 
WTSO≥nSîvîA


	)

2641 
PyObje˘
 *

2642 
	$psutû_u£rs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2644 
HANDLE
 
hSîvî
 = 
NULL
;

2645 
LPTSTR
 
buf„r_u£r
 = 
NULL
;

2646 
LPTSTR
 
buf„r_addr
 = 
NULL
;

2647 
PWTS_SESSION_INFO
 
£ssi⁄s
 = 
NULL
;

2648 
DWORD
 
cou¡
;

2649 
DWORD
 
i
;

2650 
DWORD
 
£ssi⁄Id
;

2651 
DWORD
 
byãs
;

2652 
PWTS_CLIENT_ADDRESS
 
addªss
;

2653 
addªss_°r
[50];

2654 
unix_time
;

2656 
PWINSTATIONQUERYINFORMATIONW
 
WöSèti⁄QuîyInf‹m©i⁄W
;

2657 
WINSTATION_INFO
 
°©i⁄_öfo
;

2658 
HINSTANCE
 
hIn°WöSè
 = 
NULL
;

2659 
ULONG
 
ªtu∫Lí
;

2661 
PyObje˘
 *
py_ªéi°
 = 
	`PyLi°_New
(0);

2662 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

2663 
PyObje˘
 *
py_addªss
 = 
NULL
;

2664 i‡(
py_ªéi°
 =
NULL
) {

2665  
NULL
;

2668 
hIn°WöSè
 = 
	`LﬂdLibøryA
("winsta.dll");

2669 
WöSèti⁄QuîyInf‹m©i⁄W
 = (
PWINSTATIONQUERYINFORMATIONW
) \

2670 
	`GëProcAddªss
(
hIn°WöSè
, "WinStationQueryInformationW");

2672 
hSîvî
 = 
	`WTSO≥nSîvî
('\0');

2673 i‡(
hSîvî
 =
NULL
) {

2674 
	`PyEº_SëFromWödowsEº
(0);

2675 
îr‹
;

2678 i‡(
	`WTSEnumî©eSessi⁄s
(
hSîvî
, 0, 1, &
£ssi⁄s
, &
cou¡
) == 0) {

2679 
	`PyEº_SëFromWödowsEº
(0);

2680 
îr‹
;

2683 
i
 = 0; i < 
cou¡
; i++) {

2684 
py_addªss
 = 
NULL
;

2685 
py_tu∂e
 = 
NULL
;

2686 
£ssi⁄Id
 = 
£ssi⁄s
[
i
].
Sessi⁄Id
;

2687 i‡(
buf„r_u£r
 !
NULL
) {

2688 
	`WTSFªeMem‹y
(
buf„r_u£r
);

2690 i‡(
buf„r_addr
 !
NULL
) {

2691 
	`WTSFªeMem‹y
(
buf„r_addr
);

2694 
buf„r_u£r
 = 
NULL
;

2695 
buf„r_addr
 = 
NULL
;

2698 
byãs
 = 0;

2699 i‡(
	`WTSQuîySessi⁄Inf‹m©i⁄
(
hSîvî
, 
£ssi⁄Id
, 
WTSU£rName
,

2700 &
buf„r_u£r
, &
byãs
) == 0) {

2701 
	`PyEº_SëFromWödowsEº
(0);

2702 
îr‹
;

2704 i‡(
byãs
 == 1) {

2709 
byãs
 = 0;

2710 i‡(
	`WTSQuîySessi⁄Inf‹m©i⁄
(
hSîvî
, 
£ssi⁄Id
, 
WTSClõ¡Addªss
,

2711 &
buf„r_addr
, &
byãs
) == 0) {

2712 
	`PyEº_SëFromWödowsEº
(0);

2713 
îr‹
;

2716 
addªss
 = (
PWTS_CLIENT_ADDRESS
)
buf„r_addr
;

2717 i‡(
addªss
->
AddªssFamûy
 == 0) {

2718 
	`•rötf
(
addªss_°r
,

2720 
addªss
->
Addªss
[0],

2721 
addªss
->
Addªss
[1],

2722 
addªss
->
Addªss
[2],

2723 
addªss
->
Addªss
[3]);

2724 
py_addªss
 = 
	`Py_BuûdVÆue
("s", 
addªss_°r
);

2725 i‡(!
py_addªss
)

2726 
îr‹
;

2729 
py_addªss
 = 
Py_N⁄e
;

2733 i‡(!
	`WöSèti⁄QuîyInf‹m©i⁄W
(
hSîvî
,

2734 
£ssi⁄Id
,

2735 
WöSèti⁄Inf‹m©i⁄
,

2736 &
°©i⁄_öfo
,

2737 (
°©i⁄_öfo
),

2738 &
ªtu∫Lí
))

2740 
îr‹
;

2743 
unix_time
 = ((
LONGLONG
)
°©i⁄_öfo
.
C⁄√˘Time
.
dwHighD©eTime
) << 32;

2744 
unix_time
 += \

2745 
°©i⁄_öfo
.
C⁄√˘Time
.
dwLowD©eTime
 - 116444736000000000LL;

2746 
unix_time
 /= 10000000;

2748 
py_tu∂e
 = 
	`Py_BuûdVÆue
("sOd", 
buf„r_u£r
, 
py_addªss
,

2749 ()
unix_time
);

2750 i‡(!
py_tu∂e
)

2751 
îr‹
;

2752 i‡(
	`PyLi°_Aµíd
(
py_ªéi°
, 
py_tu∂e
))

2753 
îr‹
;

2754 
	`Py_XDECREF
(
py_addªss
);

2755 
	`Py_XDECREF
(
py_tu∂e
);

2758 
	`WTSClo£Sîvî
(
hSîvî
);

2759 
	`WTSFªeMem‹y
(
£ssi⁄s
);

2760 
	`WTSFªeMem‹y
(
buf„r_u£r
);

2761 
	`WTSFªeMem‹y
(
buf„r_addr
);

2762 
	`FªeLibøry
(
hIn°WöSè
);

2763  
py_ªéi°
;

2765 
îr‹
:

2766 
	`Py_XDECREF
(
py_tu∂e
);

2767 
	`Py_XDECREF
(
py_addªss
);

2768 
	`Py_DECREF
(
py_ªéi°
);

2770 i‡(
hIn°WöSè
 !
NULL
) {

2771 
	`FªeLibøry
(
hIn°WöSè
);

2773 i‡(
hSîvî
 !
NULL
) {

2774 
	`WTSClo£Sîvî
(
hSîvî
);

2776 i‡(
£ssi⁄s
 !
NULL
) {

2777 
	`WTSFªeMem‹y
(
£ssi⁄s
);

2779 i‡(
buf„r_u£r
 !
NULL
) {

2780 
	`WTSFªeMem‹y
(
buf„r_u£r
);

2782 i‡(
buf„r_addr
 !
NULL
) {

2783 
	`WTSFªeMem‹y
(
buf„r_addr
);

2785  
NULL
;

2786 
	}
}

2792 
PyObje˘
 *

2793 
	$psutû_¥oc_num_h™dÀs
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2795 
DWORD
 
pid
;

2796 
HANDLE
 
hPro˚ss
;

2797 
DWORD
 
h™dÀCou¡
;

2799 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2800  
NULL
;

2802 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

2803 i‡(
NULL
 =
hPro˚ss
) {

2804  
NULL
;

2806 i‡(! 
	`GëPro˚ssH™dÀCou¡
(
hPro˚ss
, &
h™dÀCou¡
)) {

2807 
	`Clo£H™dÀ
(
hPro˚ss
);

2808  
	`PyEº_SëFromWödowsEº
(0);

2810 
	`Clo£H™dÀ
(
hPro˚ss
);

2811  
	`Py_BuûdVÆue
("k", 
h™dÀCou¡
);

2812 
	}
}

2818 
PyObje˘
 *

2819 
	$psutû_¥oc_num_h™dÀs_2
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2821 
DWORD
 
pid
;

2822 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

2823 
PVOID
 
buf„r
;

2824 
ULONG
 
cou¡
;

2826 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2827  
NULL
;

2829 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

2830  
NULL
;

2832 
cou¡
 = 
¥o˚ss
->
H™dÀCou¡
;

2833 
	`‰ì
(
buf„r
);

2834  
	`Py_BuûdVÆue
("k", 
cou¡
);

2835 
	}
}

2841 
PyObje˘
 *

2842 
	$psutû_¥oc_num_˘x_swôches
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2844 
DWORD
 
pid
;

2845 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

2846 
PVOID
 
buf„r
;

2847 
ULONG
 
i
;

2848 
ULONG
 
tŸÆ
 = 0;

2850 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2851  
NULL
;

2853 i‡(! 
	`psutû_gë_¥oc_öfo
(
pid
, &
¥o˚ss
, &
buf„r
)) {

2854  
NULL
;

2856 
i
 = 0; i < 
¥o˚ss
->
NumbîOfThªads
; i++) {

2857 
tŸÆ
 +
¥o˚ss
->
Thªads
[
i
].
C⁄ãxtSwôches
;

2859 
	`‰ì
(
buf„r
);

2860  
	`Py_BuûdVÆue
("ki", 
tŸÆ
, 0);

2861 
	}
}

2864 *
	$gë_ªgi⁄_¥Ÿe˘i⁄_°rög
(
ULONG
 
¥Ÿe˘i⁄
)

2866 
¥Ÿe˘i⁄
 & 0xff) {

2867 
PAGE_NOACCESS
:

2869 
PAGE_READONLY
:

2871 
PAGE_READWRITE
:

2873 
PAGE_WRITECOPY
:

2875 
PAGE_EXECUTE
:

2877 
PAGE_EXECUTE_READ
:

2879 
PAGE_EXECUTE_READWRITE
:

2881 
PAGE_EXECUTE_WRITECOPY
:

2886 
	}
}

2892 
PyObje˘
 *

2893 
	$psutû_¥oc_mem‹y_m≠s
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2895 
DWORD
 
pid
;

2896 
HANDLE
 
hPro˚ss
 = 
NULL
;

2897 
MEMORY_BASIC_INFORMATION
 
basicInfo
;

2898 
PVOID
 
ba£Addªss
;

2899 
PVOID
 
¥eviousAŒoˇti⁄Ba£
;

2900 
CHAR
 
m≠≥dFûeName
[
MAX_PATH
];

2901 
SYSTEM_INFO
 
sy°em_öfo
;

2902 
LPVOID
 
maxAddr
;

2903 
PyObje˘
 *
py_li°
 = 
	`PyLi°_New
(0);

2904 
PyObje˘
 *
py_tu∂e
 = 
NULL
;

2906 i‡(
py_li°
 =
NULL
) {

2907  
NULL
;

2909 i‡(! 
	`PyArg_P¨£Tu∂e
(
¨gs
, "l", &
pid
)) {

2910 
îr‹
;

2912 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

2913 i‡(
NULL
 =
hPro˚ss
) {

2914 
îr‹
;

2917 
	`GëSy°emInfo
(&
sy°em_öfo
);

2918 
maxAddr
 = 
sy°em_öfo
.
ÕMaximumAµliˇti⁄Addªss
;

2919 
ba£Addªss
 = 
NULL
;

2920 
¥eviousAŒoˇti⁄Ba£
 = 
NULL
;

2922 
	`VútuÆQuîyEx
(
hPro˚ss
, 
ba£Addªss
, &
basicInfo
,

2923 (
MEMORY_BASIC_INFORMATION
)))

2925 
py_tu∂e
 = 
NULL
;

2926 i‡(
ba£Addªss
 > 
maxAddr
) {

2929 i‡(
	`GëM≠≥dFûeNameA
(
hPro˚ss
, 
ba£Addªss
, 
m≠≥dFûeName
,

2930 (
m≠≥dFûeName
)))

2932 
py_tu∂e
 = 
	`Py_BuûdVÆue
(

2934 ()
ba£Addªss
,

2935 
	`gë_ªgi⁄_¥Ÿe˘i⁄_°rög
(
basicInfo
.
PrŸe˘
),

2936 
m≠≥dFûeName
,

2937 
basicInfo
.
Regi⁄Size
);

2938 i‡(!
py_tu∂e
)

2939 
îr‹
;

2940 i‡(
	`PyLi°_Aµíd
(
py_li°
, 
py_tu∂e
))

2941 
îr‹
;

2942 
	`Py_DECREF
(
py_tu∂e
);

2944 
¥eviousAŒoˇti⁄Ba£
 = 
basicInfo
.
AŒoˇti⁄Ba£
;

2945 
ba£Addªss
 = (
PCHAR
)ba£Addªs†+ 
basicInfo
.
Regi⁄Size
;

2948 
	`Clo£H™dÀ
(
hPro˚ss
);

2949  
py_li°
;

2951 
îr‹
:

2952 
	`Py_XDECREF
(
py_tu∂e
);

2953 
	`Py_DECREF
(
py_li°
);

2954 i‡(
hPro˚ss
 !
NULL
)

2955 
	`Clo£H™dÀ
(
hPro˚ss
);

2956  
NULL
;

2957 
	}
}

2963 
PyObje˘
 *

2964 
	$psutû_µid_m≠
(
PyObje˘
 *
£lf
, PyObje˘ *
¨gs
)

2966 
PyObje˘
 *
pid
 = 
NULL
;

2967 
PyObje˘
 *
µid
 = 
NULL
;

2968 
PyObje˘
 *
py_ªtdi˘
 = 
	`PyDi˘_New
();

2969 
HANDLE
 
h™dÀ
 = 
NULL
;

2970 
PROCESSENTRY32
 
≥
 = {0};

2971 
≥
.
dwSize
 = (
PROCESSENTRY32
);

2973 i‡(
py_ªtdi˘
 =
NULL
)

2974  
NULL
;

2975 
h™dÀ
 = 
	`Cª©eToﬁhñp32S«pshŸ
(
TH32CS_SNAPPROCESS
, 0);

2976 i‡(
h™dÀ
 =
INVALID_HANDLE_VALUE
) {

2977 
	`PyEº_SëFromWödowsEº
(0);

2978 
	`Py_DECREF
(
py_ªtdi˘
);

2979  
NULL
;

2982 i‡(
	`Pro˚ss32Fú°
(
h™dÀ
, &
≥
)) {

2984 
pid
 = 
	`Py_BuûdVÆue
("I", 
≥
.
th32Pro˚ssID
);

2985 i‡(
pid
 =
NULL
)

2986 
îr‹
;

2987 
µid
 = 
	`Py_BuûdVÆue
("I", 
≥
.
th32P¨ítPro˚ssID
);

2988 i‡(
µid
 =
NULL
)

2989 
îr‹
;

2990 i‡(
	`PyDi˘_SëIãm
(
py_ªtdi˘
, 
pid
, 
µid
))

2991 
îr‹
;

2992 
	`Py_DECREF
(
pid
);

2993 
	`Py_DECREF
(
µid
);

2994 } 
	`Pro˚ss32Next
(
h™dÀ
, &
≥
));

2997 
	`Clo£H™dÀ
(
h™dÀ
);

2998  
py_ªtdi˘
;

3000 
îr‹
:

3001 
	`Py_XDECREF
(
pid
);

3002 
	`Py_XDECREF
(
µid
);

3003 
	`Py_DECREF
(
py_ªtdi˘
);

3004 
	`Clo£H™dÀ
(
h™dÀ
);

3005  
NULL
;

3006 
	}
}

3011 
PyMëhodDef


3012 
	gPsutûMëhods
[] =

3016 {"¥oc_cmdlöe", 
psutû_¥oc_cmdlöe
, 
METH_VARARGS
,

3018 {"¥oc_exe", 
psutû_¥oc_exe
, 
METH_VARARGS
,

3020 {"¥oc_kûl", 
psutû_¥oc_kûl
, 
METH_VARARGS
,

3022 {"¥oc_˝u_times", 
psutû_¥oc_˝u_times
, 
METH_VARARGS
,

3024 {"¥oc_¸óã_time", 
psutû_¥oc_¸óã_time
, 
METH_VARARGS
,

3027 {"¥oc_mem‹y_öfo", 
psutû_¥oc_mem‹y_öfo
, 
METH_VARARGS
,

3029 {"¥oc_cwd", 
psutû_¥oc_cwd
, 
METH_VARARGS
,

3031 {"¥oc_su•íd", 
psutû_¥oc_su•íd
, 
METH_VARARGS
,

3033 {"¥oc_ªsume", 
psutû_¥oc_ªsume
, 
METH_VARARGS
,

3035 {"¥oc_›í_fûes", 
psutû_¥oc_›í_fûes
, 
METH_VARARGS
,

3037 {"¥oc_u£∫ame", 
psutû_¥oc_u£∫ame
, 
METH_VARARGS
,

3039 {"¥oc_num_thªads", 
psutû_¥oc_num_thªads
, 
METH_VARARGS
,

3041 {"¥oc_thªads", 
psutû_¥oc_thªads
, 
METH_VARARGS
,

3043 {"¥oc_waô", 
psutû_¥oc_waô
, 
METH_VARARGS
,

3045 {"¥oc_¥i‹ôy_gë", 
psutû_¥oc_¥i‹ôy_gë
, 
METH_VARARGS
,

3047 {"¥oc_¥i‹ôy_£t", 
psutû_¥oc_¥i‹ôy_£t
, 
METH_VARARGS
,

3049 #i‡(
_WIN32_WINNT
 >= 0x0600)

3050 {"¥oc_io_¥i‹ôy_gë", 
psutû_¥oc_io_¥i‹ôy_gë
, 
METH_VARARGS
,

3052 {"¥oc_io_¥i‹ôy_£t", 
psutû_¥oc_io_¥i‹ôy_£t
, 
METH_VARARGS
,

3055 {"¥oc_˝u_afföôy_gë", 
psutû_¥oc_˝u_afföôy_gë
, 
METH_VARARGS
,

3057 {"¥oc_˝u_afföôy_£t", 
psutû_¥oc_˝u_afföôy_£t
, 
METH_VARARGS
,

3059 {"¥oc_io_cou¡îs", 
psutû_¥oc_io_cou¡îs
, 
METH_VARARGS
,

3061 {"¥oc_is_su•íded", 
psutû_¥oc_is_su•íded
, 
METH_VARARGS
,

3063 {"¥oc_num_h™dÀs", 
psutû_¥oc_num_h™dÀs
, 
METH_VARARGS
,

3065 {"¥oc_num_˘x_swôches", 
psutû_¥oc_num_˘x_swôches
, 
METH_VARARGS
,

3067 {"¥oc_mem‹y_m≠s", 
psutû_¥oc_mem‹y_m≠s
, 
METH_VARARGS
,

3071 {"¥oc_˝u_times_2", 
psutû_¥oc_˝u_times_2
, 
METH_VARARGS
,

3073 {"¥oc_¸óã_time_2", 
psutû_¥oc_¸óã_time_2
, 
METH_VARARGS
,

3075 {"¥oc_num_h™dÀs_2", 
psutû_¥oc_num_h™dÀs_2
, 
METH_VARARGS
,

3077 {"¥oc_io_cou¡îs_2", 
psutû_¥oc_io_cou¡îs_2
, 
METH_VARARGS
,

3079 {"¥oc_mem‹y_öfo_2", 
psutû_¥oc_mem‹y_öfo_2
, 
METH_VARARGS
,

3083 {"pids", 
psutû_pids
, 
METH_VARARGS
,

3085 {"µid_m≠", 
psutû_µid_m≠
, 
METH_VARARGS
,

3087 {"pid_exi°s", 
psutû_pid_exi°s
, 
METH_VARARGS
,

3089 {"˝u_cou¡_logiˇl", 
psutû_˝u_cou¡_logiˇl
, 
METH_VARARGS
,

3091 {"˝u_cou¡_phys", 
psutû_˝u_cou¡_phys
, 
METH_VARARGS
,

3093 {"boŸ_time", 
psutû_boŸ_time
, 
METH_VARARGS
,

3095 {"vútuÆ_mem", 
psutû_vútuÆ_mem
, 
METH_VARARGS
,

3097 {"˝u_times", 
psutû_˝u_times
, 
METH_VARARGS
,

3099 {"≥r_˝u_times", 
psutû_≥r_˝u_times
, 
METH_VARARGS
,

3101 {"disk_ußge", 
psutû_disk_ußge
, 
METH_VARARGS
,

3103 {"√t_io_cou¡îs", 
psutû_√t_io_cou¡îs
, 
METH_VARARGS
,

3105 {"disk_io_cou¡îs", 
psutû_disk_io_cou¡îs
, 
METH_VARARGS
,

3107 {"u£rs", 
psutû_u£rs
, 
METH_VARARGS
,

3109 {"disk_∑πôi⁄s", 
psutû_disk_∑πôi⁄s
, 
METH_VARARGS
,

3111 {"√t_c⁄√˘i⁄s", 
psutû_√t_c⁄√˘i⁄s
, 
METH_VARARGS
,

3116 {"wö32_QuîyDosDevi˚", 
psutû_wö32_QuîyDosDevi˚
, 
METH_VARARGS
,

3119 {
NULL
, NULL, 0, NULL}

3123 
	smoduÀ_°©e
 {

3124 
PyObje˘
 *
	mîr‹
;

3127 #i‡
PY_MAJOR_VERSION
 >= 3

3128 
	#GETSTATE
(
m
Ë((
moduÀ_°©e
*)
	`PyModuÀ_GëSèã
(m))

	)

3130 
	#GETSTATE
(
m
Ë(&
_°©e
)

	)

3131 
moduÀ_°©e
 
	g_°©e
;

3134 #i‡
PY_MAJOR_VERSION
 >= 3

3136 
	$psutû_wödows_åavî£
(
PyObje˘
 *
m
, 
visô¥oc
 
visô
, *
¨g
) {

3137 
	`Py_VISIT
(
	`GETSTATE
(
m
)->
îr‹
);

3139 
	}
}

3141 
	$psutû_wödows_˛ór
(
PyObje˘
 *
m
) {

3142 
	`Py_CLEAR
(
	`GETSTATE
(
m
)->
îr‹
);

3144 
	}
}

3146 
PyModuÀDef
 
	gmoduÀdef
 = {

3147 
PyModuÀDef_HEAD_INIT
,

3149 
NULL
,

3150 (
moduÀ_°©e
),

3151 
PsutûMëhods
,

3152 
NULL
,

3153 
psutû_wödows_åavî£
,

3154 
psutû_wödows_˛ór
,

3155 
NULL


3158 
	#INITERROR
  
NULL


	)

3160 
PyMODINIT_FUNC
 
	$PyInô__psutû_wödows
()

3163 
	#INITERROR
 

	)

3164 
	$öô_psutû_wödows
()

3167 
moduÀ_°©e
 *
°
 = 
NULL
;

3168 #i‡
PY_MAJOR_VERSION
 >= 3

3169 
PyObje˘
 *
moduÀ
 = 
	`PyModuÀ_Cª©e
(&
moduÀdef
);

3171 
PyObje˘
 *
moduÀ
 = 
	`Py_InôModuÀ
("_psutû_wödows", 
PsutûMëhods
);

3174 i‡(
moduÀ
 =
NULL
) {

3175 
INITERROR
;

3178 
°
 = 
	`GETSTATE
(
moduÀ
);

3179 
°
->
îr‹
 = 
	`PyEº_NewEx˚±i⁄
("_psutû_wödows.Eº‹", 
NULL
, NULL);

3180 i‡(
°
->
îr‹
 =
NULL
) {

3181 
	`Py_DECREF
(
moduÀ
);

3182 
INITERROR
;

3187 
	`PyModuÀ_AddI¡C⁄°™t
(

3188 
moduÀ
, "ABOVE_NORMAL_PRIORITY_CLASS", 
ABOVE_NORMAL_PRIORITY_CLASS
);

3189 
	`PyModuÀ_AddI¡C⁄°™t
(

3190 
moduÀ
, "BELOW_NORMAL_PRIORITY_CLASS", 
BELOW_NORMAL_PRIORITY_CLASS
);

3191 
	`PyModuÀ_AddI¡C⁄°™t
(

3192 
moduÀ
, "HIGH_PRIORITY_CLASS", 
HIGH_PRIORITY_CLASS
);

3193 
	`PyModuÀ_AddI¡C⁄°™t
(

3194 
moduÀ
, "IDLE_PRIORITY_CLASS", 
IDLE_PRIORITY_CLASS
);

3195 
	`PyModuÀ_AddI¡C⁄°™t
(

3196 
moduÀ
, "NORMAL_PRIORITY_CLASS", 
NORMAL_PRIORITY_CLASS
);

3197 
	`PyModuÀ_AddI¡C⁄°™t
(

3198 
moduÀ
, "REALTIME_PRIORITY_CLASS", 
REALTIME_PRIORITY_CLASS
);

3201 
	`PyModuÀ_AddI¡C⁄°™t
(

3202 
moduÀ
, "MIB_TCP_STATE_CLOSED", 
MIB_TCP_STATE_CLOSED
);

3203 
	`PyModuÀ_AddI¡C⁄°™t
(

3204 
moduÀ
, "MIB_TCP_STATE_CLOSING", 
MIB_TCP_STATE_CLOSING
);

3205 
	`PyModuÀ_AddI¡C⁄°™t
(

3206 
moduÀ
, "MIB_TCP_STATE_CLOSE_WAIT", 
MIB_TCP_STATE_CLOSE_WAIT
);

3207 
	`PyModuÀ_AddI¡C⁄°™t
(

3208 
moduÀ
, "MIB_TCP_STATE_LISTEN", 
MIB_TCP_STATE_LISTEN
);

3209 
	`PyModuÀ_AddI¡C⁄°™t
(

3210 
moduÀ
, "MIB_TCP_STATE_ESTAB", 
MIB_TCP_STATE_ESTAB
);

3211 
	`PyModuÀ_AddI¡C⁄°™t
(

3212 
moduÀ
, "MIB_TCP_STATE_SYN_SENT", 
MIB_TCP_STATE_SYN_SENT
);

3213 
	`PyModuÀ_AddI¡C⁄°™t
(

3214 
moduÀ
, "MIB_TCP_STATE_SYN_RCVD", 
MIB_TCP_STATE_SYN_RCVD
);

3215 
	`PyModuÀ_AddI¡C⁄°™t
(

3216 
moduÀ
, "MIB_TCP_STATE_FIN_WAIT1", 
MIB_TCP_STATE_FIN_WAIT1
);

3217 
	`PyModuÀ_AddI¡C⁄°™t
(

3218 
moduÀ
, "MIB_TCP_STATE_FIN_WAIT2", 
MIB_TCP_STATE_FIN_WAIT2
);

3219 
	`PyModuÀ_AddI¡C⁄°™t
(

3220 
moduÀ
, "MIB_TCP_STATE_LAST_ACK", 
MIB_TCP_STATE_LAST_ACK
);

3221 
	`PyModuÀ_AddI¡C⁄°™t
(

3222 
moduÀ
, "MIB_TCP_STATE_TIME_WAIT", 
MIB_TCP_STATE_TIME_WAIT
);

3223 
	`PyModuÀ_AddI¡C⁄°™t
(

3224 
moduÀ
, "MIB_TCP_STATE_TIME_WAIT", 
MIB_TCP_STATE_TIME_WAIT
);

3225 
	`PyModuÀ_AddI¡C⁄°™t
(

3226 
moduÀ
, "MIB_TCP_STATE_DELETE_TCB", 
MIB_TCP_STATE_DELETE_TCB
);

3227 
	`PyModuÀ_AddI¡C⁄°™t
(

3228 
moduÀ
, "PSUTIL_CONN_NONE", 
PSUTIL_CONN_NONE
);

3230 
	`PyModuÀ_AddI¡C⁄°™t
(

3231 
moduÀ
, "INFINITE", 
INFINITE
);

3232 
	`PyModuÀ_AddI¡C⁄°™t
(

3233 
moduÀ
, "ERROR_ACCESS_DENIED", 
ERROR_ACCESS_DENIED
);

3236 
	`psutû_£t_£_debug
();

3238 #i‡
PY_MAJOR_VERSION
 >= 3

3239  
moduÀ
;

3241 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_windows.h

7 
	~<Pyth⁄.h
>

8 
	~<wödows.h
>

12 
PyObje˘
* 
psutû_¥oc_cmdlöe
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

13 
PyObje˘
* 
psutû_¥oc_˝u_afföôy_gë
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

14 
PyObje˘
* 
psutû_¥oc_˝u_afföôy_£t
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

15 
PyObje˘
* 
psutû_¥oc_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

16 
PyObje˘
* 
psutû_¥oc_˝u_times_2
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

17 
PyObje˘
* 
psutû_¥oc_¸óã_time
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

18 
PyObje˘
* 
psutû_¥oc_¸óã_time_2
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

19 
PyObje˘
* 
psutû_¥oc_cwd
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

20 
PyObje˘
* 
psutû_¥oc_exe
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

21 
PyObje˘
* 
psutû_¥oc_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

22 
PyObje˘
* 
psutû_¥oc_io_cou¡îs_2
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

23 
PyObje˘
* 
psutû_¥oc_is_su•íded
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

24 
PyObje˘
* 
psutû_¥oc_kûl
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

25 
PyObje˘
* 
psutû_¥oc_mem‹y_öfo
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

26 
PyObje˘
* 
psutû_¥oc_mem‹y_öfo_2
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

27 
PyObje˘
* 
psutû_¥oc_mem‹y_m≠s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

28 
PyObje˘
* 
psutû_¥oc_num_˘x_swôches
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

29 
PyObje˘
* 
psutû_¥oc_num_h™dÀs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

30 
PyObje˘
* 
psutû_¥oc_num_h™dÀs_2
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

31 
PyObje˘
* 
psutû_¥oc_num_thªads
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

32 
PyObje˘
* 
psutû_¥oc_›í_fûes
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

33 
PyObje˘
* 
psutû_¥oc_¥i‹ôy_gë
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

34 
PyObje˘
* 
psutû_¥oc_¥i‹ôy_£t
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

35 
PyObje˘
* 
psutû_¥oc_ªsume
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

36 
PyObje˘
* 
psutû_¥oc_su•íd
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

37 
PyObje˘
* 
psutû_¥oc_thªads
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

38 
PyObje˘
* 
psutû_¥oc_u£∫ame
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

39 
PyObje˘
* 
psutû_¥oc_waô
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

41 #i‡(
PSUTIL_WINVER
 >= 0x0600)

42 
PyObje˘
* 
psutû_¥oc_io_¥i‹ôy_gë
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

43 
PyObje˘
* 
psutû_¥oc_io_¥i‹ôy_£t
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

48 
PyObje˘
* 
psutû_boŸ_time
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

49 
PyObje˘
* 
psutû_˝u_cou¡_logiˇl
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

50 
PyObje˘
* 
psutû_˝u_cou¡_phys
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

51 
PyObje˘
* 
psutû_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

52 
PyObje˘
* 
psutû_disk_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

53 
PyObje˘
* 
psutû_disk_∑πôi⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

54 
PyObje˘
* 
psutû_disk_ußge
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

55 
PyObje˘
* 
psutû_√t_c⁄√˘i⁄s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

56 
PyObje˘
* 
psutû_√t_io_cou¡îs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

57 
PyObje˘
* 
psutû_≥r_˝u_times
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

58 
PyObje˘
* 
psutû_pid_exi°s
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

59 
PyObje˘
* 
psutû_pids
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

60 
PyObje˘
* 
psutû_µid_m≠
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

61 
PyObje˘
* 
psutû_u£rs
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

62 
PyObje˘
* 
psutû_vútuÆ_mem
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

66 
PyObje˘
* 
psutû_wö32_QuîyDosDevi˚
(PyObje˘* 
£lf
, PyObje˘* 
¨gs
);

70 
psutû_¥oc_su•íd_‹_ªsume
(
DWORD
 
pid
, 
su•íd
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\bsd\process_info.c

11 
	~<Pyth⁄.h
>

12 
	~<as£π.h
>

13 
	~<î∫o.h
>

14 
	~<°dlib.h
>

15 
	~<°dio.h
>

16 
	~<°rög.h
>

17 
	~<sys/ty≥s.h
>

18 
	~<sys/sys˘l.h
>

19 
	~<sys/∑øm.h
>

20 
	~<sys/u£r.h
>

21 
	~<sys/¥oc.h
>

22 
	~<sig«l.h
>

24 
	~"¥o˚ss_öfo.h
"

36 
	$psutû_gë_¥oc_li°
(
köfo_¥oc
 **
¥ocLi°
, 
size_t
 *
¥ocCou¡
)

38 
îr
;

39 
köfo_¥oc
 *
ªsu…
;

40 
d⁄e
;

41 c⁄° 
«me
[] = { 
CTL_KERN
, 
KERN_PROC
, 
KERN_PROC_PROC
, 0 };

44 
size_t
 
Àngth
;

46 
	`as£π
–
¥ocLi°
 !
NULL
);

47 
	`as£π
(*
¥ocLi°
 =
NULL
);

48 
	`as£π
(
¥ocCou¡
 !
NULL
);

50 *
¥ocCou¡
 = 0;

63 
ªsu…
 = 
NULL
;

64 
d⁄e
 = 0;

66 
	`as£π
(
ªsu…
 =
NULL
);

68 
Àngth
 = 0;

69 
îr
 = 
	`sys˘l
((*)
«me
, ((name) / (*name)) - 1,

70 
NULL
, &
Àngth
, NULL, 0);

71 i‡(
îr
 == -1)

72 
îr
 = 
î∫o
;

76 i‡(
îr
 == 0) {

77 
ªsu…
 = 
	`mÆloc
(
Àngth
);

78 i‡(
ªsu…
 =
NULL
)

79 
îr
 = 
ENOMEM
;

84 i‡(
îr
 == 0) {

85 
îr
 = 
	`sys˘l
((*Ë
«me
, ((name) / (*name)) - 1,

86 
ªsu…
, &
Àngth
, 
NULL
, 0);

87 i‡(
îr
 == -1)

88 
îr
 = 
î∫o
;

89 i‡(
îr
 == 0) {

90 
d⁄e
 = 1;

92 i‡(
îr
 =
ENOMEM
) {

93 
	`as£π
(
ªsu…
 !
NULL
);

94 
	`‰ì
(
ªsu…
);

95 
ªsu…
 = 
NULL
;

96 
îr
 = 0;

99 } 
îr
 =0 && ! 
d⁄e
);

102 i‡(
îr
 !0 && 
ªsu…
 !
NULL
) {

103 
	`‰ì
(
ªsu…
);

104 
ªsu…
 = 
NULL
;

107 *
¥ocLi°
 = 
ªsu…
;

108 *
¥ocCou¡
 = 
Àngth
 / (
köfo_¥oc
);

110 
	`as£π
((
îr
 =0Ë=(*
¥ocLi°
 !
NULL
));

111  
îr
;

112 
	}
}

116 *
	$psutû_gë_cmd_∑th
(
pid
, 
size_t
 *
∑thsize
)

118 
mib
[4];

119 *
∑th
;

120 
size_t
 
size
 = 0;

125 
mib
[0] = 
CTL_KERN
;

126 
mib
[1] = 
KERN_PROC
;

127 
mib
[2] = 
KERN_PROC_PATHNAME
;

128 
mib
[3] = 
pid
;

131 i‡(
	`sys˘l
(
mib
, 4, 
NULL
, &
size
, NULL, 0) == -1) {

132  
NULL
;

135 
∑th
 = 
	`mÆloc
(
size
);

136 i‡(
∑th
 =
NULL
) {

137 
	`PyEº_NoMem‹y
();

138  
NULL
;

141 *
∑thsize
 = 
size
;

142 i‡(
	`sys˘l
(
mib
, 4, 
∑th
, &
size
, 
NULL
, 0) == -1) {

143 
	`‰ì
(
∑th
);

144  
NULL
;

147  
∑th
;

148 
	}
}

165 *
	$psutû_gë_cmd_¨gs
(
pid
, 
size_t
 *
¨gsize
)

167 
mib
[4], 
¨gmax
;

168 
size_t
 
size
 = (
¨gmax
);

169 *
¥oˇrgs
 = 
NULL
;

172 
mib
[0] = 
CTL_KERN
;

173 
mib
[1] = 
KERN_ARGMAX
;

175 
size
 = (
¨gmax
);

176 i‡(
	`sys˘l
(
mib
, 2, &
¨gmax
, &
size
, 
NULL
, 0) == -1)

177  
NULL
;

180 
¥oˇrgs
 = (*)
	`mÆloc
(
¨gmax
);

181 i‡(
¥oˇrgs
 =
NULL
) {

182 
	`PyEº_NoMem‹y
();

183  
NULL
;

189 
mib
[0] = 
CTL_KERN
;

190 
mib
[1] = 
KERN_PROC
;

191 
mib
[2] = 
KERN_PROC_ARGS
;

192 
mib
[3] = 
pid
;

194 
size
 = 
¨gmax
;

195 i‡(
	`sys˘l
(
mib
, 4, 
¥oˇrgs
, &
size
, 
NULL
, 0) == -1) {

196 
	`‰ì
(
¥oˇrgs
);

197  
NULL
;

201 *
¨gsize
 = 
size
;

202  
¥oˇrgs
;

203 
	}
}

207 
PyObje˘
 *

208 
	$psutû_gë_¨g_li°
(
pid
)

210 *
¨g°r
 = 
NULL
;

211 
pos
 = 0;

212 
size_t
 
¨gsize
 = 0;

213 
PyObje˘
 *
ªéi°
 = 
	`Py_BuûdVÆue
("[]");

214 
PyObje˘
 *
ôem
 = 
NULL
;

216 i‡(
pid
 < 0) {

217  
ªéi°
;

220 
¨g°r
 = 
	`psutû_gë_cmd_¨gs
(
pid
, &
¨gsize
);

221 i‡(
¨g°r
 =
NULL
) {

222 
îr‹
;

228 i‡(
¨gsize
 > 0) {

229 
pos
 < 
¨gsize
) {

230 
ôem
 = 
	`Py_BuûdVÆue
("s", &
¨g°r
[
pos
]);

231 i‡(!
ôem
)

232 
îr‹
;

233 i‡(
	`PyLi°_Aµíd
(
ªéi°
, 
ôem
))

234 
îr‹
;

235 
	`Py_DECREF
(
ôem
);

236 
pos
 =Öo†+ 
	`°æí
(&
¨g°r
[pos]) + 1;

240 
	`‰ì
(
¨g°r
);

241  
ªéi°
;

243 
îr‹
:

244 
	`Py_XDECREF
(
ôem
);

245 
	`Py_DECREF
(
ªéi°
);

246 i‡(
¨g°r
 !
NULL
)

247 
	`‰ì
(
¨g°r
);

248  
NULL
;

249 
	}
}

256 
	$psutû_pid_exi°s
(
pid
)

258 
kûl_ªt
;

259 i‡(
pid
 < 0) {

264 
kûl_ªt
 = 
	`kûl
(
pid
 , 0);

265 i‡((0 =
kûl_ªt
Ë|| (
EPERM
 =
î∫o
)) {

271 
	}
}

278 
	$psutû_øi£_ad_‹_n•
(
pid
) {

279 i‡(
	`psutû_pid_exi°s
(
pid
) == 0) {

280 
	`NoSuchPro˚ss
();

283 
	`Ac˚ssDíõd
();

285 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\bsd\process_info.h

7 
	~<Pyth⁄.h
>

9 
köfo_¥oc
 
	tköfo_¥oc
;

11 *
psutû_gë_cmd_¨gs
(
pid
, 
size_t
 *
¨gsize
);

12 *
psutû_gë_cmd_∑th
(
pid
, 
size_t
 *
∑thsize
);

13 
psutû_gë_¥oc_li°
(
köfo_¥oc
 **
¥ocLi°
, 
size_t
 *
¥ocCou¡
);

14 
psutû_pid_exi°s
(
pid
);

15 
PyObje˘
* 
psutû_gë_¨g_li°
(
pid
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\osx\process_info.c

11 
	~<Pyth⁄.h
>

12 
	~<as£π.h
>

13 
	~<î∫o.h
>

14 
	~<limôs.h
>

15 
	~<°dboﬁ.h
>

16 
	~<°dlib.h
>

17 
	~<°dio.h
>

18 
	~<sig«l.h
>

19 
	~<sys/sys˘l.h
>

20 
	~<lib¥oc.h
>

22 
	~"¥o˚ss_öfo.h
"

23 
	~"../../_psutû_comm⁄.h
"

30 
	$psutû_pid_exi°s
(
pid
)

32 
kûl_ªt
;

35 i‡(
pid
 < 0) {

40 
kûl_ªt
 = 
	`kûl
(
pid
 , 0);

41 i‡–(0 =
kûl_ªt
Ë|| (
EPERM
 =
î∫o
) ) {

47 
	}
}

59 
	$psutû_gë_¥oc_li°
(
köfo_¥oc
 **
¥ocLi°
, 
size_t
 *
¥ocCou¡
)

63 c⁄° 
mib3
[3] = { 
CTL_KERN
, 
KERN_PROC
, 
KERN_PROC_ALL
 };

64 
size_t
 
size
, 
size2
;

65 *
±r
;

66 
îr
, 
lim
 = 8;

68 
	`as£π
–
¥ocLi°
 !
NULL
);

69 
	`as£π
(*
¥ocLi°
 =
NULL
);

70 
	`as£π
(
¥ocCou¡
 !
NULL
);

72 *
¥ocCou¡
 = 0;

86 
lim
-- > 0) {

87 
size
 = 0;

88 i‡(
	`sys˘l
((*)
mib3
, 3, 
NULL
, &
size
, NULL, 0) == -1) {

89  
î∫o
;

92 
size2
 = 
size
 + (size >> 3);

93 i‡(
size2
 > 
size
) {

94 
±r
 = 
	`mÆloc
(
size2
);

95 i‡(
±r
 =
NULL
) {

96 
±r
 = 
	`mÆloc
(
size
);

98 
size
 = 
size2
;

102 
±r
 = 
	`mÆloc
(
size
);

104 i‡(
±r
 =
NULL
) {

105  
ENOMEM
;

108 i‡(
	`sys˘l
((*)
mib3
, 3, 
±r
, &
size
, 
NULL
, 0) == -1) {

109 
îr
 = 
î∫o
;

110 
	`‰ì
(
±r
);

111 i‡(
îr
 !
ENOMEM
) {

112  
îr
;

116 *
¥ocLi°
 = (
köfo_¥oc
 *)
±r
;

117 *
¥ocCou¡
 = 
size
 / (
köfo_¥oc
);

121  
ENOMEM
;

122 
	}
}

127 
	$psutû_gë_¨gmax
()

129 
¨gmax
;

130 
mib
[] = { 
CTL_KERN
, 
KERN_ARGMAX
 };

131 
size_t
 
size
 = (
¨gmax
);

133 i‡(
	`sys˘l
(
mib
, 2, &
¨gmax
, &
size
, 
NULL
, 0) == 0) {

134  
¨gmax
;

137 
	}
}

141 
PyObje˘
 *

142 
	$psutû_gë_¨g_li°
(
pid
)

144 
mib
[3];

145 
«rgs
;

146 
Àn
;

147 *
¥oˇrgs
 = 
NULL
;

148 *
¨g_±r
;

149 *
¨g_íd
;

150 *
cuº_¨g
;

151 
size_t
 
¨gmax
;

152 
PyObje˘
 *
¨g
 = 
NULL
;

153 
PyObje˘
 *
¨gli°
 = 
NULL
;

156 i‡(
pid
 == 0) {

157  
	`Py_BuûdVÆue
("[]");

161 
¨gmax
 = 
	`psutû_gë_¨gmax
();

162 i‡(! 
¨gmax
) {

163 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

164 
îr‹
;

167 
¥oˇrgs
 = (*)
	`mÆloc
(
¨gmax
);

168 i‡(
NULL
 =
¥oˇrgs
) {

169 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

170 
îr‹
;

174 
mib
[0] = 
CTL_KERN
;

175 
mib
[1] = 
KERN_PROCARGS2
;

176 
mib
[2] = 
pid
;

177 i‡(
	`sys˘l
(
mib
, 3, 
¥oˇrgs
, &
¨gmax
, 
NULL
, 0) < 0) {

178 i‡(
EINVAL
 =
î∫o
) {

180 i‡–
	`psutû_pid_exi°s
(
pid
) ) {

181 
	`Ac˚ssDíõd
();

183 
	`NoSuchPro˚ss
();

186 
îr‹
;

189 
¨g_íd
 = &
¥oˇrgs
[
¨gmax
];

191 
	`mem˝y
(&
«rgs
, 
¥oˇrgs
, (nargs));

193 
¨g_±r
 = 
¥oˇrgs
 + (
«rgs
);

194 
Àn
 = 
	`°æí
(
¨g_±r
);

195 
¨g_±r
 +
Àn
 + 1;

197 i‡(
¨g_±r
 =
¨g_íd
) {

198 
	`‰ì
(
¥oˇrgs
);

199  
	`Py_BuûdVÆue
("[]");

203 ; 
¨g_±r
 < 
¨g_íd
;árg_ptr++) {

204 i‡(*
¨g_±r
 != '\0') {

210 
cuº_¨g
 = 
¨g_±r
;

211 
¨gli°
 = 
	`Py_BuûdVÆue
("[]");

212 i‡(!
¨gli°
)

213 
îr‹
;

214 
¨g_±r
 < 
¨g_íd
 && 
«rgs
 > 0) {

215 i‡(*
¨g_±r
++ == '\0') {

216 
¨g
 = 
	`Py_BuûdVÆue
("s", 
cuº_¨g
);

217 i‡(!
¨g
)

218 
îr‹
;

219 i‡(
	`PyLi°_Aµíd
(
¨gli°
, 
¨g
))

220 
îr‹
;

221 
	`Py_DECREF
(
¨g
);

223 
cuº_¨g
 = 
¨g_±r
;

224 
«rgs
--;

228 
	`‰ì
(
¥oˇrgs
);

229  
¨gli°
;

231 
îr‹
:

232 
	`Py_XDECREF
(
¨g
);

233 
	`Py_XDECREF
(
¨gli°
);

234 i‡(
¥oˇrgs
 !
NULL
)

235 
	`‰ì
(
¥oˇrgs
);

236  
NULL
;

237 
	}
}

241 
	$psutû_gë_köfo_¥oc
(
pid_t
 
pid
, 
köfo_¥oc
 *
kp
)

243 
mib
[4];

244 
size_t
 
Àn
;

245 
mib
[0] = 
CTL_KERN
;

246 
mib
[1] = 
KERN_PROC
;

247 
mib
[2] = 
KERN_PROC_PID
;

248 
mib
[3] = 
pid
;

251 
Àn
 = (
köfo_¥oc
);

254 i‡(
	`sys˘l
(
mib
, 4, 
kp
, &
Àn
, 
NULL
, 0) == -1) {

256 
	`PyEº_SëFromEºno
(
PyExc_OSEº‹
);

261 i‡(
Àn
 == 0) {

262 
	`NoSuchPro˚ss
();

266 
	}
}

273 
	$psutû_¥oc_pidöfo
(
pid
, 
Êav‹
, *
±i
, 
size
)

275 
ªt
 = 
	`¥oc_pidöfo
(()
pid
, 
Êav‹
, 0, 
±i
, 
size
);

276 i‡(
ªt
 == 0) {

277 i‡(! 
	`psutû_pid_exi°s
(
pid
)) {

278 
	`NoSuchPro˚ss
();

282 
	`Ac˚ssDíõd
();

286 i‡(
ªt
 !
size
) {

287 
	`Ac˚ssDíõd
();

293 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\osx\process_info.h

7 
	~<Pyth⁄.h
>

9 
köfo_¥oc
 
	tköfo_¥oc
;

11 
psutû_gë_¨gmax
();

12 
psutû_gë_köfo_¥oc
(
pid_t
 
pid
, 
köfo_¥oc
 *
kp
);

13 
psutû_gë_¥oc_li°
(
köfo_¥oc
 **
¥ocLi°
, 
size_t
 *
¥ocCou¡
);

14 
psutû_pid_exi°s
(
pid
);

15 
psutû_¥oc_pidöfo
(
pid
, 
Êav‹
, *
±i
, 
size
);

16 
PyObje˘
* 
psutû_gë_¨g_li°
(
pid
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\glpi.h

3 
	e_LOGICAL_PROCESSOR_RELATIONSHIP
 {

4 
	mRñ©i⁄Pro˚ss‹C‹e
,

5 
	mRñ©i⁄NumaNode
,

6 
	mRñ©i⁄Cache
,

7 
	mRñ©i⁄Pro˚ss‹Package
,

8 
	mRñ©i⁄Group
,

9 
	mRñ©i⁄AŒ
=0xffff

10 } 
	tLOGICAL_PROCESSOR_RELATIONSHIP
;

12 
	e_PROCESSOR_CACHE_TYPE
 {

13 
	mCacheUnifõd
,
	mCacheIn°ru˘i⁄
,
	mCacheD©a
,
	mCacheTø˚


14 } 
	tPROCESSOR_CACHE_TYPE
;

16 
	s_CACHE_DESCRIPTOR
 {

17 
BYTE
 
	mLevñ
;

18 
BYTE
 
	mAssocütivôy
;

19 
WORD
 
	mLöeSize
;

20 
DWORD
 
	mSize
;

21 
PROCESSOR_CACHE_TYPE
 
	mTy≥
;

22 } 
	tCACHE_DESCRIPTOR
,*
	tPCACHE_DESCRIPTOR
;

24 
	s_SYSTEM_LOGICAL_PROCESSOR_INFORMATION
 {

25 
ULONG_PTR
 
	mPro˚ss‹Mask
;

26 
LOGICAL_PROCESSOR_RELATIONSHIP
 
	mRñ©i⁄shù
;

29 
BYTE
 
	mFœgs
;

30 } 
	mPro˚ss‹C‹e
;

32 
DWORD
 
	mNodeNumbî
;

33 } 
	mNumaNode
;

34 
CACHE_DESCRIPTOR
 
	mCache
;

35 
ULONGLONG
 
	mRe£rved
[2];

37 } 
	tSYSTEM_LOGICAL_PROCESSOR_INFORMATION
,*
	tPSYSTEM_LOGICAL_PROCESSOR_INFORMATION
;

39 
WINBASEAPI
 
WINBOOL
 
WINAPI


40 
GëLogiˇlPro˚ss‹Inf‹m©i⁄
(
PSYSTEM_LOGICAL_PROCESSOR_INFORMATION
 
Buf„r
,

41 
PDWORD
 
Rëu∫edLígth
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\ntextapi.h

7 
	e_KTHREAD_STATE
 {

8 
	mInôülized
,

9 
	mRódy
,

10 
	mRu¬ög
,

11 
	mSèndby
,

12 
	mTîmö©ed
,

13 
	mWaôög
,

14 
	mTønsôi⁄
,

15 
	mDe„ºedRódy
,

16 
	mG©eWaô
,

17 
	mMaximumThªadSèã


18 } 
	tKTHREAD_STATE
, *
	tPKTHREAD_STATE
;

20 
	e_KWAIT_REASON
 {

21 
	mExecutive
 = 0,

22 
	mFªePage
 = 1,

23 
	mPageIn
 = 2,

24 
	mPoﬁAŒoˇti⁄
 = 3,

25 
	mDñayExecuti⁄
 = 4,

26 
	mSu•íded
 = 5,

27 
	mU£rReque°
 = 6,

28 
	mWrExecutive
 = 7,

29 
	mWrFªePage
 = 8,

30 
	mWrPageIn
 = 9,

31 
	mWrPoﬁAŒoˇti⁄
 = 10,

32 
	mWrDñayExecuti⁄
 = 11,

33 
	mWrSu•íded
 = 12,

34 
	mWrU£rReque°
 = 13,

35 
	mWrEvítPaú
 = 14,

36 
	mWrQueue
 = 15,

37 
	mWrLpcRe˚ive
 = 16,

38 
	mWrLpcRïly
 = 17,

39 
	mWrVútuÆMem‹y
 = 18,

40 
	mWrPageOut
 = 19,

41 
	mWrRídezvous
 = 20,

42 
	mS∑ª2
 = 21,

43 
	mS∑ª3
 = 22,

44 
	mS∑ª4
 = 23,

45 
	mS∑ª5
 = 24,

46 
	mWrCÆloutSèck
 = 25,

47 
	mWrKî√l
 = 26,

48 
	mWrResour˚
 = 27,

49 
	mWrPushLock
 = 28,

50 
	mWrMuãx
 = 29,

51 
	mWrQu™tumEnd
 = 30,

52 
	mWrDi•©chI¡
 = 31,

53 
	mWrPªem±ed
 = 32,

54 
	mWrYõldExecuti⁄
 = 33,

55 
	mWrFa°Muãx
 = 34,

56 
	mWrGu¨dedMuãx
 = 35,

57 
	mWrRundown
 = 36,

58 
	mMaximumWaôRós⁄
 = 37

59 } 
	tKWAIT_REASON
, *
	tPKWAIT_REASON
;

61 
	s_CLIENT_ID
 {

62 
HANDLE
 
	mUniquePro˚ss
;

63 
HANDLE
 
	mUniqueThªad
;

64 } 
	tCLIENT_ID
, *
	tPCLIENT_ID
;

67 
	s_UNICODE_STRING
 {

68 
USHORT
 
	mLígth
;

69 
USHORT
 
	mMaximumLígth
;

70 
PWSTR
 
	mBuf„r
;

71 } 
	tUNICODE_STRING
, *
	tPUNICODE_STRING
;

73 
	s_SYSTEM_TIMEOFDAY_INFORMATION
 {

74 
LARGE_INTEGER
 
	mBoŸTime
;

75 
LARGE_INTEGER
 
	mCuºítTime
;

76 
LARGE_INTEGER
 
	mTimeZ⁄eBüs
;

77 
ULONG
 
	mTimeZ⁄eId
;

78 
ULONG
 
	mRe£rved
;

79 
ULONGLONG
 
	mBoŸTimeBüs
;

80 
ULONGLONG
 
	mSÀïTimeBüs
;

81 } 
	tSYSTEM_TIMEOFDAY_INFORMATION
, *
	tPSYSTEM_TIMEOFDAY_INFORMATION
;

83 
	s_SYSTEM_THREAD_INFORMATION
 {

84 
LARGE_INTEGER
 
	mKî√lTime
;

85 
LARGE_INTEGER
 
	mU£rTime
;

86 
LARGE_INTEGER
 
	mCª©eTime
;

87 
ULONG
 
	mWaôTime
;

88 
PVOID
 
	mSèπAddªss
;

89 
CLIENT_ID
 
	mClõ¡Id
;

90 
LONG
 
	mPri‹ôy
;

91 
LONG
 
	mBa£Pri‹ôy
;

92 
ULONG
 
	mC⁄ãxtSwôches
;

93 
ULONG
 
	mThªadSèã
;

94 
KWAIT_REASON
 
	mWaôRós⁄
;

95 } 
	tSYSTEM_THREAD_INFORMATION
, *
	tPSYSTEM_THREAD_INFORMATION
;

97 
_TEB
 *
	tPTEB
;

100 
	s_SYSTEM_EXTENDED_THREAD_INFORMATION
 {

101 
SYSTEM_THREAD_INFORMATION
 
	mThªadInfo
;

102 
PVOID
 
	mSèckBa£
;

103 
PVOID
 
	mSèckLimô
;

104 
PVOID
 
	mWö32SèπAddªss
;

105 
PTEB
 
	mTebBa£
;

106 
ULONG_PTR
 
	mRe£rved2
;

107 
ULONG_PTR
 
	mRe£rved3
;

108 
ULONG_PTR
 
	mRe£rved4
;

109 } 
	tSYSTEM_EXTENDED_THREAD_INFORMATION
, *
	tPSYSTEM_EXTENDED_THREAD_INFORMATION
;

111 
	s_SYSTEM_PROCESS_INFORMATION
 {

112 
ULONG
 
	mNextE¡ryOff£t
;

113 
ULONG
 
	mNumbîOfThªads
;

114 
LARGE_INTEGER
 
	mS∑ªLi1
;

115 
LARGE_INTEGER
 
	mS∑ªLi2
;

116 
LARGE_INTEGER
 
	mS∑ªLi3
;

117 
LARGE_INTEGER
 
	mCª©eTime
;

118 
LARGE_INTEGER
 
	mU£rTime
;

119 
LARGE_INTEGER
 
	mKî√lTime
;

120 
UNICODE_STRING
 
	mImageName
;

121 
LONG
 
	mBa£Pri‹ôy
;

122 
HANDLE
 
	mUniquePro˚ssId
;

123 
HANDLE
 
	mInhîôedFromUniquePro˚ssId
;

124 
ULONG
 
	mH™dÀCou¡
;

125 
ULONG
 
	mSessi⁄Id
;

126 
ULONG_PTR
 
	mPageDúe˘‹yBa£
;

127 
SIZE_T
 
	mPókVútuÆSize
;

128 
SIZE_T
 
	mVútuÆSize
;

129 
DWORD
 
	mPageFau…Cou¡
;

130 
SIZE_T
 
	mPókW‹kögSëSize
;

131 
SIZE_T
 
	mW‹kögSëSize
;

132 
SIZE_T
 
	mQuŸaPókPagedPoﬁUßge
;

133 
SIZE_T
 
	mQuŸaPagedPoﬁUßge
;

134 
SIZE_T
 
	mQuŸaPókN⁄PagedPoﬁUßge
;

135 
SIZE_T
 
	mQuŸaN⁄PagedPoﬁUßge
;

136 
SIZE_T
 
	mPagefûeUßge
;

137 
SIZE_T
 
	mPókPagefûeUßge
;

138 
SIZE_T
 
	mPriv©ePageCou¡
;

139 
LARGE_INTEGER
 
	mRódO≥øti⁄Cou¡
;

140 
LARGE_INTEGER
 
	mWrôeO≥øti⁄Cou¡
;

141 
LARGE_INTEGER
 
	mOthîO≥øti⁄Cou¡
;

142 
LARGE_INTEGER
 
	mRódTøns„rCou¡
;

143 
LARGE_INTEGER
 
	mWrôeTøns„rCou¡
;

144 
LARGE_INTEGER
 
	mOthîTøns„rCou¡
;

145 
SYSTEM_THREAD_INFORMATION
 
	mThªads
[1];

146 } 
	tSYSTEM_PROCESS_INFORMATION
, *
	tPSYSTEM_PROCESS_INFORMATION
;

150 
	s_SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION
 {

151 
LARGE_INTEGER
 
	mIdÀTime
;

152 
LARGE_INTEGER
 
	mKî√lTime
;

153 
LARGE_INTEGER
 
	mU£rTime
;

154 
LARGE_INTEGER
 
	mRe£rved1
[2];

155 
ULONG
 
	mRe£rved2
;

156 } 
	tSYSTEM_PROCESSOR_PERFORMANCE_INFORMATION
,

157 *
	tPSYSTEM_PROCESSOR_PERFORMANCE_INFORMATION
;

160 
	e_SYSTEM_INFORMATION_CLASS
 {

161 
	mSy°emBasicInf‹m©i⁄
 = 0,

162 
	mSy°emPîf‹m™˚Inf‹m©i⁄
 = 2,

163 
	mSy°emTimeOfDayInf‹m©i⁄
 = 3,

164 
	mSy°emPro˚ssInf‹m©i⁄
 = 5,

165 
	mSy°emPro˚ss‹Pîf‹m™˚Inf‹m©i⁄
 = 8,

166 
	mSy°emI¡îru±Inf‹m©i⁄
 = 23,

167 
	mSy°emEx˚±i⁄Inf‹m©i⁄
 = 33,

168 
	mSy°emRegi°ryQuŸaInf‹m©i⁄
 = 37,

169 
	mSy°emLookasideInf‹m©i⁄
 = 45

170 } 
	tSYSTEM_INFORMATION_CLASS
;

177 
	s_WINSTATION_INFO
 {

178 
BYTE
 
	mRe£rved1
[72];

179 
ULONG
 
	mSessi⁄Id
;

180 
BYTE
 
	mRe£rved2
[4];

181 
FILETIME
 
	mC⁄√˘Time
;

182 
FILETIME
 
	mDisc⁄√˘Time
;

183 
FILETIME
 
	mLa°I≈utTime
;

184 
FILETIME
 
	mLogöTime
;

185 
BYTE
 
	mRe£rved3
[1096];

186 
FILETIME
 
	mCuºítTime
;

187 } 
	tWINSTATION_INFO
, *
	tPWINSTATION_INFO
;

189 
	e_WINSTATIONINFOCLASS
 {

190 
	mWöSèti⁄Inf‹m©i⁄
 = 8

191 } 
	tWINSTATIONINFOCLASS
;

193 
	$BOOLEAN
 (
	tWINAPI
 * 
	tPWINSTATIONQUERYINFORMATIONW
)

194 (
	tHANDLE
,
	tULONG
,
	tWINSTATIONINFOCLASS
,
	tPVOID
,ULONG,
	tPULONG
);

196 
	s_WINSTATIONINFORMATIONW
 {

197 
BYTE
 
Re£rved2
[70];

198 
ULONG
 
Log⁄Id
;

199 
BYTE
 
Re£rved3
[1140];

200 } 
	tWINSTATIONINFORMATIONW
, *
	tPWINSTATIONINFORMATIONW
;

204 #i‚de‡
_INC_WTSAPI


205 
	s_WTS_CLIENT_ADDRESS
 {

206 
DWORD
 
AddªssFamûy
;

207 
BYTE
 
Addªss
[20];

208 } 
	tWTS_CLIENT_ADDRESS
, * 
	tPWTS_CLIENT_ADDRESS
;

210 
HANDLE
 
WINAPI
 
	`WTSO≥nSîvîA
(
IN
 
LPSTR
 
pSîvîName
);

212 
VOID
 
WINAPI
 
	`WTSClo£Sîvî
(
IN
 
HANDLE
 
hSîvî
);

221 
LONG
 
	tNTSTATUS
;

223 
	$NTSTATUS
 (
	tNTAPI
 *
	t_NtQuîyInf‹m©i⁄Pro˚ss
)(

224 
	tHANDLE
 
	tPro˚ssH™dÀ
,

225 
	tDWORD
 
	tPro˚ssInf‹m©i⁄Cœss
,

226 
	tPVOID
 
	tPro˚ssInf‹m©i⁄
,

227 
	tDWORD
 
	tPro˚ssInf‹m©i⁄Lígth
,

228 
	tPDWORD
 
	tRëu∫Lígth


231 
	$NTSTATUS
 (
	tNTAPI
 *
	t_NtSëInf‹m©i⁄Pro˚ss
)(

232 
	tHANDLE
 
	tPro˚ssH™dÀ
,

233 
	tDWORD
 
	tPro˚ssInf‹m©i⁄Cœss
,

234 
	tPVOID
 
	tPro˚ssInf‹m©i⁄
,

235 
	tDWORD
 
	tPro˚ssInf‹m©i⁄Lígth


238 
	s_PROCESS_BASIC_INFORMATION
 {

239 
PVOID
 
Re£rved1
;

240 
PVOID
 
PebBa£Addªss
;

241 
PVOID
 
Re£rved2
[2];

242 
ULONG_PTR
 
UniquePro˚ssId
;

243 
PVOID
 
Re£rved3
;

244 } 
	tPROCESS_BASIC_INFORMATION
, *
	tPPROCESS_BASIC_INFORMATION
;

246 
	e_PROCESSINFOCLASS
 {

247 
Pro˚ssBasicInf‹m©i⁄
,

248 
Pro˚ssQuŸaLimôs
,

249 
Pro˚ssIoCou¡îs
,

250 
Pro˚ssVmCou¡îs
,

251 
Pro˚ssTimes
,

252 
Pro˚ssBa£Pri‹ôy
,

253 
Pro˚ssRai£Pri‹ôy
,

254 
Pro˚ssDebugP‹t
,

255 
Pro˚ssEx˚±i⁄P‹t
,

256 
Pro˚ssAc˚ssTokí
,

257 
Pro˚ssLdtInf‹m©i⁄
,

258 
Pro˚ssLdtSize
,

259 
Pro˚ssDeÁu…H¨dEº‹Mode
,

260 
Pro˚ssIoP‹tH™dÀrs
,

261 
Pro˚ssPoﬁedUßgeAndLimôs
,

262 
Pro˚ssW‹kögSëW©ch
,

263 
Pro˚ssU£rModeIOPL
,

264 
Pro˚ssE«bÀAlignmítFau…Fixup
,

265 
Pro˚ssPri‹ôyCœss
,

266 
Pro˚ssWx86Inf‹m©i⁄
,

267 
Pro˚ssH™dÀCou¡
,

268 
Pro˚ssAfföôyMask
,

269 
Pro˚ssPri‹ôyBoo°
,

270 
Pro˚ssDevi˚M≠
,

271 
Pro˚ssSessi⁄Inf‹m©i⁄
,

272 
Pro˚ssF‹egroundInf‹m©i⁄
,

273 
Pro˚ssWow64Inf‹m©i⁄
,

275 
Pro˚ssImageFûeName
,

276 
Pro˚ssLUIDDevi˚M≠sE«bÀd
,

277 
Pro˚ssBªakOnTîmö©i⁄
,

278 
Pro˚ssDebugObje˘H™dÀ
,

279 
Pro˚ssDebugFœgs
,

280 
Pro˚ssH™dÀTøcög
,

281 
Pro˚ssIoPri‹ôy
,

282 
Pro˚ssExecuãFœgs
,

283 
Pro˚ssResour˚M™agemít
,

284 
Pro˚ssCookõ
,

285 
Pro˚ssImageInf‹m©i⁄
,

286 
MaxPro˚ssInfoCœss


287 } 
	tPROCESSINFOCLASS
;

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_handles.c

8 #i‚de‡
UNICODE


9 
	#UNICODE


	)

12 
	~<Pyth⁄.h
>

13 
	~<wödows.h
>

14 
	~<°dio.h
>

15 
	~"¥o˚ss_h™dÀs.h
"

17 #i‚de‡
NT_SUCCESS


18 
	#NT_SUCCESS
(
x
Ë((xË>0)

	)

20 
	#STATUS_INFO_LENGTH_MISMATCH
 0xc0000004

	)

22 
	#Sy°emH™dÀInf‹m©i⁄
 16

	)

23 
	#Obje˘BasicInf‹m©i⁄
 0

	)

24 
	#Obje˘NameInf‹m©i⁄
 1

	)

25 
	#Obje˘Ty≥Inf‹m©i⁄
 2

	)

28 
LONG
 
	tNTSTATUS
;

30 
	s_UNICODE_STRING
 {

31 
USHORT
 
	mLígth
;

32 
USHORT
 
	mMaximumLígth
;

33 
PWSTR
 
	mBuf„r
;

34 } 
	tUNICODE_STRING
, *
	tPUNICODE_STRING
;

36 
	$NTSTATUS
 (
	tNTAPI
 *
	t_NtQuîySy°emInf‹m©i⁄
)(

37 
	tULONG
 
	tSy°emInf‹m©i⁄Cœss
,

38 
	tPVOID
 
	tSy°emInf‹m©i⁄
,

39 
	tULONG
 
	tSy°emInf‹m©i⁄Lígth
,

40 
	tPULONG
 
	tRëu∫Lígth


43 
	$NTSTATUS
 (
	tNTAPI
 *
	t_NtDu∂iˇãObje˘
)(

44 
	tHANDLE
 
	tSour˚Pro˚ssH™dÀ
,

45 
	tHANDLE
 
	tSour˚H™dÀ
,

46 
	tHANDLE
 
	tT¨gëPro˚ssH™dÀ
,

47 
	tPHANDLE
 
	tT¨gëH™dÀ
,

48 
	tACCESS_MASK
 
	tDesúedAc˚ss
,

49 
	tULONG
 
	tAâribuãs
,

50 
	tULONG
 
	tO±i⁄s


53 
	$NTSTATUS
 (
	tNTAPI
 *
	t_NtQuîyObje˘
)(

54 
	tHANDLE
 
	tObje˘H™dÀ
,

55 
	tULONG
 
	tObje˘Inf‹m©i⁄Cœss
,

56 
	tPVOID
 
	tObje˘Inf‹m©i⁄
,

57 
	tULONG
 
	tObje˘Inf‹m©i⁄Lígth
,

58 
	tPULONG
 
	tRëu∫Lígth


61 
	s_SYSTEM_HANDLE
 {

62 
ULONG
 
Pro˚ssId
;

63 
BYTE
 
Obje˘Ty≥Numbî
;

64 
BYTE
 
Fœgs
;

65 
USHORT
 
H™dÀ
;

66 
PVOID
 
Obje˘
;

67 
ACCESS_MASK
 
Gø¡edAc˚ss
;

68 } 
	tSYSTEM_HANDLE
, *
	tPSYSTEM_HANDLE
;

70 
	s_SYSTEM_HANDLE_INFORMATION
 {

71 
ULONG
 
H™dÀCou¡
;

72 
SYSTEM_HANDLE
 
H™dÀs
[1];

73 } 
	tSYSTEM_HANDLE_INFORMATION
, *
	tPSYSTEM_HANDLE_INFORMATION
;

75 
	e_POOL_TYPE
 {

76 
N⁄PagedPoﬁ
,

77 
PagedPoﬁ
,

78 
N⁄PagedPoﬁMu°Suc˚ed
,

79 
D⁄tU£ThisTy≥
,

80 
N⁄PagedPoﬁCacheAlig√d
,

81 
PagedPoﬁCacheAlig√d
,

82 
N⁄PagedPoﬁCacheAlig√dMu°S


83 } 
	tPOOL_TYPE
, *
	tPPOOL_TYPE
;

85 
	s_OBJECT_TYPE_INFORMATION
 {

86 
UNICODE_STRING
 
Name
;

87 
ULONG
 
TŸÆNumbîOfObje˘s
;

88 
ULONG
 
TŸÆNumbîOfH™dÀs
;

89 
ULONG
 
TŸÆPagedPoﬁUßge
;

90 
ULONG
 
TŸÆN⁄PagedPoﬁUßge
;

91 
ULONG
 
TŸÆNamePoﬁUßge
;

92 
ULONG
 
TŸÆH™dÀTabÀUßge
;

93 
ULONG
 
HighW©îNumbîOfObje˘s
;

94 
ULONG
 
HighW©îNumbîOfH™dÀs
;

95 
ULONG
 
HighW©îPagedPoﬁUßge
;

96 
ULONG
 
HighW©îN⁄PagedPoﬁUßge
;

97 
ULONG
 
HighW©îNamePoﬁUßge
;

98 
ULONG
 
HighW©îH™dÀTabÀUßge
;

99 
ULONG
 
InvÆidAâribuãs
;

100 
GENERIC_MAPPING
 
GíîicM≠pög
;

101 
ULONG
 
VÆidAc˚ss
;

102 
BOOLEAN
 
SecurôyRequúed
;

103 
BOOLEAN
 
MaöèöH™dÀCou¡
;

104 
USHORT
 
MaöèöTy≥Li°
;

105 
POOL_TYPE
 
PoﬁTy≥
;

106 
ULONG
 
PagedPoﬁUßge
;

107 
ULONG
 
N⁄PagedPoﬁUßge
;

108 } 
	tOBJECT_TYPE_INFORMATION
, *
	tPOBJECT_TYPE_INFORMATION
;

111 
PVOID


112 
	$GëLibøryProcAddªss
(
PSTR
 
LibøryName
, PSTR 
ProcName
)

114  
	`GëProcAddªss
(
	`GëModuÀH™dÀA
(
LibøryName
), 
ProcName
);

115 
	}
}

118 
PyObje˘
 *

119 
	$psutû_gë_›í_fûes
(
pid
, 
HANDLE
 
¥o˚ssH™dÀ
)

121 
_NtQuîySy°emInf‹m©i⁄
 
NtQuîySy°emInf‹m©i⁄
 =

122 
	`GëLibøryProcAddªss
("ntdll.dll", "NtQuerySystemInformation");

123 
_NtQuîyObje˘
 
NtQuîyObje˘
 =

124 
	`GëLibøryProcAddªss
("ntdll.dll", "NtQueryObject");

126 
NTSTATUS
 
°©us
;

127 
PSYSTEM_HANDLE_INFORMATION
 
h™dÀInfo
;

128 
ULONG
 
h™dÀInfoSize
 = 0x10000;

129 
ULONG
 
i
;

130 
ULONG
 
fûeNameLígth
;

131 
PyObje˘
 *
fûesLi°
 = 
	`Py_BuûdVÆue
("[]");

132 
PyObje˘
 *
¨g
 = 
NULL
;

133 
PyObje˘
 *
fûeFromWch¨
 = 
NULL
;

135 i‡(
fûesLi°
 =
NULL
)

136  
NULL
;

138 
h™dÀInfo
 = (
PSYSTEM_HANDLE_INFORMATION
)
	`mÆloc
(
h™dÀInfoSize
);

139 i‡(
h™dÀInfo
 =
NULL
) {

140 
	`Py_DECREF
(
fûesLi°
);

141 
	`PyEº_NoMem‹y
();

142  
NULL
;

147 (
°©us
 = 
	`NtQuîySy°emInf‹m©i⁄
(

148 
Sy°emH™dÀInf‹m©i⁄
,

149 
h™dÀInfo
,

150 
h™dÀInfoSize
,

151 
NULL


152 )Ë=
STATUS_INFO_LENGTH_MISMATCH
)

154 
h™dÀInfo
 = (
PSYSTEM_HANDLE_INFORMATION
) \

155 
	`ªÆloc
(
h™dÀInfo
, 
h™dÀInfoSize
 *= 2);

159 i‡(!
	`NT_SUCCESS
(
°©us
)) {

160 
	`Py_DECREF
(
fûesLi°
);

161 
	`‰ì
(
h™dÀInfo
);

162  
NULL
;

165 
i
 = 0; i < 
h™dÀInfo
->
H™dÀCou¡
; i++) {

166 
SYSTEM_HANDLE
 
h™dÀ
 = 
h™dÀInfo
->
H™dÀs
[
i
];

167 
HANDLE
 
dupH™dÀ
 = 
NULL
;

168 
HANDLE
 
m≠H™dÀ
 = 
NULL
;

169 
POBJECT_TYPE_INFORMATION
 
obje˘Ty≥Info
 = 
NULL
;

170 
PVOID
 
obje˘NameInfo
;

171 
UNICODE_STRING
 
obje˘Name
;

172 
ULONG
 
ªtu∫Lígth
;

173 
DWORD
 
îr‹
 = 0;

174 
fûeFromWch¨
 = 
NULL
;

175 
¨g
 = 
NULL
;

178 i‡(
h™dÀ
.
Pro˚ssId
 !
pid
)

183 i‡((
h™dÀ
.
Gø¡edAc˚ss
 == 0x0012019f)

184 || (
h™dÀ
.
Gø¡edAc˚ss
 == 0x001a019f)

185 || (
h™dÀ
.
Gø¡edAc˚ss
 == 0x00120189)

186 || (
h™dÀ
.
Gø¡edAc˚ss
 == 0x00100000)) {

190 i‡(!
	`Du∂iˇãH™dÀ
(
¥o˚ssH™dÀ
,

191 
h™dÀ
.
H™dÀ
,

192 
	`GëCuºítPro˚ss
(),

193 &
dupH™dÀ
,

195 
TRUE
,

196 
DUPLICATE_SAME_ACCESS
))

203 
m≠H™dÀ
 = 
	`Cª©eFûeM≠pög
(
dupH™dÀ
,

204 
NULL
,

205 
PAGE_READONLY
,

208 
NULL
);

209 i‡(
m≠H™dÀ
 =
NULL
 &&

210 (
îr‹
 =
ERROR_INVALID_HANDLE
 ||

211 
îr‹
 =
ERROR_BAD_EXE_FORMAT
)) {

212 
	`Clo£H™dÀ
(
dupH™dÀ
);

216 
	`Clo£H™dÀ
(
m≠H™dÀ
);

219 
obje˘Ty≥Info
 = (
POBJECT_TYPE_INFORMATION
)
	`mÆloc
(0x1000);

220 i‡(!
	`NT_SUCCESS
(
	`NtQuîyObje˘
(

221 
dupH™dÀ
,

222 
Obje˘Ty≥Inf‹m©i⁄
,

223 
obje˘Ty≥Info
,

225 
NULL


228 
	`‰ì
(
obje˘Ty≥Info
);

229 
	`Clo£H™dÀ
(
dupH™dÀ
);

233 
obje˘NameInfo
 = 
	`mÆloc
(0x1000);

234 i‡(!
	`NT_SUCCESS
(
	`NtQuîyObje˘
(

235 
dupH™dÀ
,

236 
Obje˘NameInf‹m©i⁄
,

237 
obje˘NameInfo
,

239 &
ªtu∫Lígth


243 
obje˘NameInfo
 = 
	`ªÆloc
(obje˘NameInfo, 
ªtu∫Lígth
);

244 i‡(!
	`NT_SUCCESS
(
	`NtQuîyObje˘
(

245 
dupH™dÀ
,

246 
Obje˘NameInf‹m©i⁄
,

247 
obje˘NameInfo
,

248 
ªtu∫Lígth
,

249 
NULL


261 
	`‰ì
(
obje˘Ty≥Info
);

262 
	`‰ì
(
obje˘NameInfo
);

263 
	`Clo£H™dÀ
(
dupH™dÀ
);

270 
obje˘Name
 = *(
PUNICODE_STRING
)
obje˘NameInfo
;

273 i‡(
obje˘Name
.
Lígth
)

277 
fûeNameLígth
 = 
obje˘Name
.
Lígth
 / 2;

278 i‡(
	`wcscmp
(
obje˘Ty≥Info
->
Name
.
Buf„r
, 
L
"File") == 0) {

280 
fûeFromWch¨
 = 
	`PyUnicode_FromWideCh¨
(
obje˘Name
.
Buf„r
,

281 
fûeNameLígth
);

282 i‡(
fûeFromWch¨
 =
NULL
)

283 
îr‹_py_fun
;

284 #i‡
PY_MAJOR_VERSION
 >= 3

285 
¨g
 = 
	`Py_BuûdVÆue
("N",

286 
	`PyUnicode_AsUTF8Såög
(
fûeFromWch¨
));

288 
¨g
 = 
	`Py_BuûdVÆue
("N",

289 
	`PyUnicode_FromObje˘
(
fûeFromWch¨
));

291 i‡(!
¨g
)

292 
îr‹_py_fun
;

293 
	`Py_XDECREF
(
fûeFromWch¨
);

294 
fûeFromWch¨
 = 
NULL
;

295 i‡(
	`PyLi°_Aµíd
(
fûesLi°
, 
¨g
))

296 
îr‹_py_fun
;

297 
	`Py_XDECREF
(
¨g
);

323 
	`‰ì
(
obje˘Ty≥Info
);

324 
	`‰ì
(
obje˘NameInfo
);

325 
	`Clo£H™dÀ
(
dupH™dÀ
);

327 
	`‰ì
(
h™dÀInfo
);

328 
	`Clo£H™dÀ
(
¥o˚ssH™dÀ
);

329  
fûesLi°
;

331 
îr‹_py_fun
:

332 
	`Py_XDECREF
(
¨g
);

333 
	`Py_XDECREF
(
fûeFromWch¨
);

334 
	`Py_DECREF
(
fûesLi°
);

335  
NULL
;

336 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_handles.h

7 
	~<Pyth⁄.h
>

8 
	~<wödows.h
>

10 
PyObje˘
* 
psutû_gë_›í_fûes
(
pid
, 
HANDLE
 
¥o˚ssH™dÀ
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_info.c

10 
	~<Pyth⁄.h
>

11 
	~<wödows.h
>

12 
	~<Pßpi.h
>

13 
	~<éhñp32.h
>

15 
	~"£curôy.h
"

16 
	~"¥o˚ss_öfo.h
"

17 
	~"¡exèpi.h
"

18 
	~"../../_psutû_comm⁄.h
"

28 
HANDLE


29 
	$psutû_h™dÀ_‰om_pid_wac˚ss
(
DWORD
 
pid
, DWORD 
dwDesúedAc˚ss
)

31 
HANDLE
 
hPro˚ss
;

32 
DWORD
 
¥o˚ssExôCode
 = 0;

34 i‡(
pid
 == 0) {

36  
	`Ac˚ssDíõd
();

39 
hPro˚ss
 = 
	`O≥nPro˚ss
(
dwDesúedAc˚ss
, 
FALSE
, 
pid
);

40 i‡(
hPro˚ss
 =
NULL
) {

41 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_INVALID_PARAMETER
) {

42 
	`NoSuchPro˚ss
();

45 
	`PyEº_SëFromWödowsEº
(0);

47  
NULL
;

51 
	`GëExôCodePro˚ss
(
hPro˚ss
, &
¥o˚ssExôCode
);

52 i‡(
¥o˚ssExôCode
 == 0) {

53 
	`NoSuchPro˚ss
();

54 
	`Clo£H™dÀ
(
hPro˚ss
);

55  
NULL
;

57  
hPro˚ss
;

58 
	}
}

66 
HANDLE


67 
	$psutû_h™dÀ_‰om_pid
(
DWORD
 
pid
) {

68 
DWORD
 
dwDesúedAc˚ss
 = 
PROCESS_QUERY_INFORMATION
 | 
PROCESS_VM_READ
;

69  
	`psutû_h™dÀ_‰om_pid_wac˚ss
(
pid
, 
dwDesúedAc˚ss
);

70 
	}
}

74 
PVOID


75 
	$psutû_gë_≥b_addªss
(
HANDLE
 
Pro˚ssH™dÀ
)

77 
_NtQuîyInf‹m©i⁄Pro˚ss
 
NtQuîyInf‹m©i⁄Pro˚ss
 =

78 (
_NtQuîyInf‹m©i⁄Pro˚ss
)
	`GëProcAddªss
(

79 
	`GëModuÀH™dÀA
("ntdll.dll"), "NtQueryInformationProcess");

80 
PROCESS_BASIC_INFORMATION
 
pbi
;

82 
	`NtQuîyInf‹m©i⁄Pro˚ss
(
Pro˚ssH™dÀ
, 0, &
pbi
, ’bi), 
NULL
);

83  
pbi
.
PebBa£Addªss
;

84 
	}
}

87 
DWORD
 *

88 
	$psutû_gë_pids
(
DWORD
 *
numbîOfRëu∫edPIDs
) {

95 
DWORD
 *
¥ocAºay
 = 
NULL
;

96 
DWORD
 
¥ocAºayByãSz
;

97 
¥ocAºaySz
 = 0;

100 
DWORD
 
íumRëu∫Sz
 = 0;

103 
¥ocAºaySz
 += 1024;

104 
	`‰ì
(
¥ocAºay
);

105 
¥ocAºayByãSz
 = 
¥ocAºaySz
 * (
DWORD
);

106 
¥ocAºay
 = 
	`mÆloc
(
¥ocAºayByãSz
);

107 i‡(
¥ocAºay
 =
NULL
) {

108 
	`PyEº_NoMem‹y
();

109  
NULL
;

111 i‡(! 
	`EnumPro˚s£s
(
¥ocAºay
, 
¥ocAºayByãSz
, &
íumRëu∫Sz
)) {

112 
	`‰ì
(
¥ocAºay
);

113 
	`PyEº_SëFromWödowsEº
(0);

114  
NULL
;

116 } 
íumRëu∫Sz
 =
¥ocAºaySz
 * (
DWORD
));

119 *
numbîOfRëu∫edPIDs
 = 
íumRëu∫Sz
 / (
DWORD
);

121  
¥ocAºay
;

122 
	}
}

126 
	$psutû_pid_is_ru¬ög
(
DWORD
 
pid
)

128 
HANDLE
 
hPro˚ss
;

129 
DWORD
 
exôCode
;

132 i‡(
pid
 == 0) {

136 i‡(
pid
 < 0) {

140 
hPro˚ss
 = 
	`O≥nPro˚ss
(
PROCESS_QUERY_INFORMATION
 | 
PROCESS_VM_READ
,

141 
FALSE
, 
pid
);

142 i‡(
NULL
 =
hPro˚ss
) {

144 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_INVALID_PARAMETER
) {

145 
	`Clo£H™dÀ
(
hPro˚ss
);

150 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_ACCESS_DENIED
) {

151 
	`Clo£H™dÀ
(
hPro˚ss
);

155 
	`Clo£H™dÀ
(
hPro˚ss
);

156 
	`PyEº_SëFromWödowsEº
(0);

160 i‡(
	`GëExôCodePro˚ss
(
hPro˚ss
, &
exôCode
)) {

161 
	`Clo£H™dÀ
(
hPro˚ss
);

162  (
exôCode
 =
STILL_ACTIVE
);

167 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_ACCESS_DENIED
) {

168 
	`Clo£H™dÀ
(
hPro˚ss
);

172 
	`PyEº_SëFromWödowsEº
(0);

173 
	`Clo£H™dÀ
(
hPro˚ss
);

175 
	}
}

179 
	$psutû_pid_ö_¥o˛i°
(
DWORD
 
pid
)

181 
DWORD
 *
¥o˛i°
 = 
NULL
;

182 
DWORD
 
numbîOfRëu∫edPIDs
;

183 
DWORD
 
i
;

185 
¥o˛i°
 = 
	`psutû_gë_pids
(&
numbîOfRëu∫edPIDs
);

186 i‡(
NULL
 =
¥o˛i°
) {

190 
i
 = 0; i < 
numbîOfRëu∫edPIDs
; i++) {

191 i‡(
pid
 =
¥o˛i°
[
i
]) {

192 
	`‰ì
(
¥o˛i°
);

197 
	`‰ì
(
¥o˛i°
);

199 
	}
}

205 
	$h™dÀp_is_ru¬ög
(
HANDLE
 
hPro˚ss
)

207 
DWORD
 
dwCode
;

208 i‡(
NULL
 =
hPro˚ss
) {

211 i‡(
	`GëExôCodePro˚ss
(
hPro˚ss
, &
dwCode
)) {

212 i‡(
dwCode
 =
STILL_ACTIVE
) {

217 
	}
}

224 
PyObje˘
 *

225 
	$psutû_gë_¨g_li°
(
pid
)

227 
nArgs
, 
i
;

228 
LPWSTR
 *
szArgli°
 = 
NULL
;

229 
HANDLE
 
hPro˚ss
 = 
NULL
;

230 
PVOID
 
≥bAddªss
;

231 
PVOID
 
πlU£rProcP¨amsAddªss
;

232 
UNICODE_STRING
 
comm™dLöe
;

233 
WCHAR
 *
comm™dLöeC⁄ã¡s
 = 
NULL
;

234 
PyObje˘
 *
¨g
 = 
NULL
;

235 
PyObje˘
 *
¨g_‰om_wch¨
 = 
NULL
;

236 
PyObje˘
 *
¨gLi°
 = 
NULL
;

238 
hPro˚ss
 = 
	`psutû_h™dÀ_‰om_pid
(
pid
);

239 i‡(
hPro˚ss
 =
NULL
) {

240  
NULL
;

243 
≥bAddªss
 = 
	`psutû_gë_≥b_addªss
(
hPro˚ss
);

246 #ifde‡
_WIN64


247 i‡(!
	`RódPro˚ssMem‹y
(
hPro˚ss
, (
PCHAR
)
≥bAddªss
 + 32,

248 &
πlU£rProcP¨amsAddªss
, (
PVOID
), 
NULL
))

250 i‡(!
	`RódPro˚ssMem‹y
(
hPro˚ss
, (
PCHAR
)
≥bAddªss
 + 0x10,

251 &
πlU£rProcP¨amsAddªss
, (
PVOID
), 
NULL
))

255 
	`PyEº_SëFromWödowsEº
(0);

256 
îr‹
;

260 #ifde‡
_WIN64


261 i‡(!
	`RódPro˚ssMem‹y
(
hPro˚ss
, (
PCHAR
)
πlU£rProcP¨amsAddªss
 + 112,

262 &
comm™dLöe
, (comm™dLöe), 
NULL
))

264 i‡(!
	`RódPro˚ssMem‹y
(
hPro˚ss
, (
PCHAR
)
πlU£rProcP¨amsAddªss
 + 0x40,

265 &
comm™dLöe
, (comm™dLöe), 
NULL
))

268 
	`PyEº_SëFromWödowsEº
(0);

269 
îr‹
;

274 
comm™dLöeC⁄ã¡s
 = (
WCHAR
 *)
	`mÆloc
(
comm™dLöe
.
Lígth
 + 1);

275 i‡(
comm™dLöeC⁄ã¡s
 =
NULL
) {

276 
	`PyEº_NoMem‹y
();

277 
îr‹
;

281 i‡(!
	`RódPro˚ssMem‹y
(
hPro˚ss
, 
comm™dLöe
.
Buf„r
,

282 
comm™dLöeC⁄ã¡s
, 
comm™dLöe
.
Lígth
, 
NULL
))

284 
	`PyEº_SëFromWödowsEº
(0);

285 
îr‹
;

291 
comm™dLöeC⁄ã¡s
[(
comm™dLöe
.
Lígth
 / (
WCHAR
))] = '\0';

295 
szArgli°
 = 
	`Comm™dLöeToArgvW
(
comm™dLöeC⁄ã¡s
, &
nArgs
);

296 i‡(
NULL
 =
szArgli°
) {

299 
¨g_‰om_wch¨
 = 
	`PyUnicode_FromWideCh¨
(
comm™dLöeC⁄ã¡s
,

300 
comm™dLöe
.
Lígth
 / 2);

301 i‡(
¨g_‰om_wch¨
 =
NULL
)

302 
îr‹
;

303 #i‡
PY_MAJOR_VERSION
 >= 3

304 
¨gLi°
 = 
	`Py_BuûdVÆue
("N", 
	`PyUnicode_AsUTF8Såög
(
¨g_‰om_wch¨
));

306 
¨gLi°
 = 
	`Py_BuûdVÆue
("N", 
	`PyUnicode_FromObje˘
(
¨g_‰om_wch¨
));

308 i‡(!
¨gLi°
)

309 
îr‹
;

314 
¨gLi°
 = 
	`Py_BuûdVÆue
("[]");

315 i‡(
¨gLi°
 =
NULL
)

316 
îr‹
;

317 
i
 = 0; i < 
nArgs
; i++) {

318 
¨g_‰om_wch¨
 = 
NULL
;

319 
¨g
 = 
NULL
;

320 
¨g_‰om_wch¨
 = 
	`PyUnicode_FromWideCh¨
(
szArgli°
[
i
],

321 
	`wc¶í
(
szArgli°
[
i
]));

322 i‡(
¨g_‰om_wch¨
 =
NULL
)

323 
îr‹
;

324 #i‡
PY_MAJOR_VERSION
 >= 3

325 
¨g
 = 
	`PyUnicode_FromObje˘
(
¨g_‰om_wch¨
);

327 
¨g
 = 
	`PyUnicode_AsUTF8Såög
(
¨g_‰om_wch¨
);

329 i‡(
¨g
 =
NULL
)

330 
îr‹
;

331 
	`Py_XDECREF
(
¨g_‰om_wch¨
);

332 i‡(
	`PyLi°_Aµíd
(
¨gLi°
, 
¨g
))

333 
îr‹
;

334 
	`Py_XDECREF
(
¨g
);

338 i‡(
szArgli°
 !
NULL
)

339 
	`LoˇlFªe
(
szArgli°
);

340 
	`‰ì
(
comm™dLöeC⁄ã¡s
);

341 
	`Clo£H™dÀ
(
hPro˚ss
);

342  
¨gLi°
;

344 
îr‹
:

345 
	`Py_XDECREF
(
¨g
);

346 
	`Py_XDECREF
(
¨g_‰om_wch¨
);

347 
	`Py_XDECREF
(
¨gLi°
);

348 i‡(
hPro˚ss
 !
NULL
)

349 
	`Clo£H™dÀ
(
hPro˚ss
);

350 i‡(
comm™dLöeC⁄ã¡s
 !
NULL
)

351 
	`‰ì
(
comm™dLöeC⁄ã¡s
);

352 i‡(
szArgli°
 !
NULL
)

353 
	`LoˇlFªe
(
szArgli°
);

354  
NULL
;

355 
	}
}

358 
	#PH_FIRST_PROCESS
(
Pro˚s£s
Ë((
PSYSTEM_PROCESS_INFORMATION
)(Pro˚s£s))

	)

359 
	#PH_NEXT_PROCESS
(
Pro˚ss
) ( \

360 ((
PSYSTEM_PROCESS_INFORMATION
)(
Pro˚ss
))->
NextE¡ryOff£t
 ? \

361 (
PSYSTEM_PROCESS_INFORMATION
)((
PCHAR
)(
Pro˚ss
) + \

362 ((
PSYSTEM_PROCESS_INFORMATION
)(
Pro˚ss
))->
NextE¡ryOff£t
) : \

363 
NULL
)

	)

365 c⁄° 
	gSTATUS_INFO_LENGTH_MISMATCH
 = 0xC0000004;

366 c⁄° 
	gSTATUS_BUFFER_TOO_SMALL
 = 0xC0000023L;

374 
	$psutû_gë_¥oc_öfo
(
DWORD
 
pid
, 
PSYSTEM_PROCESS_INFORMATION
 *
ªtPro˚ss
,

375 
PVOID
 *
ªtBuf„r
)

377 
ULONG
 
öôülBuf„rSize
 = 0x4000;

378 
NTSTATUS
 
°©us
;

379 
PVOID
 
buf„r
;

380 
ULONG
 
buf„rSize
;

381 
PSYSTEM_PROCESS_INFORMATION
 
¥o˚ss
;

384 
	`DWORD
 (
	t_°dˇŒ
 * 
	tNTQSI_PROC
Ë(, 
	tPVOID
, 
	tULONG
, 
	tPULONG
);

385 
NTQSI_PROC
 
NtQuîySy°emInf‹m©i⁄
;

386 
HINSTANCE
 
hNtDŒ
;

387 
hNtDŒ
 = 
	`LﬂdLibøry
(
	`TEXT
("ntdll.dll"));

388 
NtQuîySy°emInf‹m©i⁄
 = (
NTQSI_PROC
)
	`GëProcAddªss
(

389 
hNtDŒ
, "NtQuerySystemInformation");

391 
buf„rSize
 = 
öôülBuf„rSize
;

392 
buf„r
 = 
	`mÆloc
(
buf„rSize
);

393 i‡(
buf„r
 =
NULL
) {

394 
	`PyEº_NoMem‹y
();

395 
îr‹
;

398 
TRUE
) {

399 
°©us
 = 
	`NtQuîySy°emInf‹m©i⁄
(
Sy°emPro˚ssInf‹m©i⁄
, 
buf„r
,

400 
buf„rSize
, &bufferSize);

402 i‡(
°©us
 =
STATUS_BUFFER_TOO_SMALL
 ||

403 
°©us
 =
STATUS_INFO_LENGTH_MISMATCH
)

405 
	`‰ì
(
buf„r
);

406 
buf„r
 = 
	`mÆloc
(
buf„rSize
);

407 i‡(
buf„r
 =
NULL
) {

408 
	`PyEº_NoMem‹y
();

409 
îr‹
;

417 i‡(
°©us
 != 0) {

418 
	`PyEº_F‹m©
(
PyExc_Ru¡imeEº‹
, "NtQuerySystemInformation() failed");

419 
îr‹
;

422 i‡(
buf„rSize
 <= 0x20000) {

423 
öôülBuf„rSize
 = 
buf„rSize
;

426 
¥o˚ss
 = 
	`PH_FIRST_PROCESS
(
buf„r
);

428 i‡(
¥o˚ss
->
UniquePro˚ssId
 =(
HANDLE
)
pid
) {

429 *
ªtPro˚ss
 = 
¥o˚ss
;

430 *
ªtBuf„r
 = 
buf„r
;

433 }  (
¥o˚ss
 = 
	`PH_NEXT_PROCESS
(process)) );

435 
	`NoSuchPro˚ss
();

436 
îr‹
;

438 
îr‹
:

439 
	`FªeLibøry
(
hNtDŒ
);

440 i‡(
buf„r
 !
NULL
)

441 
	`‰ì
(
buf„r
);

443 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_info.h

7 
	~<Pyth⁄.h
>

8 
	~<wödows.h
>

10 
DWORD
* 
psutû_gë_pids
(DWORD *
numbîOfRëu∫edPIDs
);

11 
HANDLE
 
psutû_h™dÀ_‰om_pid
(
DWORD
 
pid
);

12 
HANDLE
 
psutû_h™dÀ_‰om_pid_wac˚ss
(
DWORD
 
pid
, DWORD 
dwDesúedAc˚ss
);

13 
psutû_h™dÀp_is_ru¬ög
(
HANDLE
 
hPro˚ss
);

14 
psutû_pid_ö_¥o˛i°
(
DWORD
 
pid
);

15 
psutû_pid_is_ru¬ög
(
DWORD
 
pid
);

16 
PVOID
 
psutû_gë_≥b_addªss
(
HANDLE
 
Pro˚ssH™dÀ
);

17 
PyObje˘
* 
psutû_gë_¨g_li°
(
pid
);

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\security.c

10 
	~<wödows.h
>

11 
	~<Pyth⁄.h
>

17 
HANDLE


18 
	$psutû_tokí_‰om_h™dÀ
(
HANDLE
 
hPro˚ss
) {

19 
HANDLE
 
hTokí
 = 
NULL
;

21 i‡(! 
	`O≥nPro˚ssTokí
(
hPro˚ss
, 
TOKEN_QUERY
, &
hTokí
)) {

22  
	`PyEº_SëFromWödowsEº
(0);

24  
hTokí
;

25 
	}
}

42 
	$psutû_has_sy°em_¥ivûege
(
HANDLE
 
hPro˚ss
) {

43 
DWORD
 
i
;

44 
DWORD
 
dwSize
 = 0;

45 
DWORD
 
dwRëvÆ
 = 0;

46 
TCHAR
 
¥ivName
[256];

47 
DWORD
 
dwNameSize
 = 256;

49 
BYTE
 *
pBuf„r
 = 
NULL
;

50 
TOKEN_PRIVILEGES
 *
ç
 = 
NULL
;

51 
HANDLE
 
hTokí
 = 
	`psutû_tokí_‰om_h™dÀ
(
hPro˚ss
);

53 i‡(
NULL
 =
hTokí
) {

58 i‡(! 
	`GëTokíInf‹m©i⁄
(
hTokí
, 
TokíPrivûeges
, 
NULL
, 0, &
dwSize
)) {

59 
dwRëvÆ
 = 
	`GëLa°Eº‹
();

61 i‡(
dwRëvÆ
 !
ERROR_INSUFFICIENT_BUFFER
 ) {

62 
	`PyEº_SëFromWödowsEº
(
dwRëvÆ
);

69 
pBuf„r
 = (
BYTE
 *Ë
	`mÆloc
(
dwSize
);

70 i‡(
pBuf„r
 =
NULL
) {

71 
	`PyEº_NoMem‹y
();

75 i‡(! 
	`GëTokíInf‹m©i⁄
(
hTokí
, 
TokíPrivûeges
, 
pBuf„r
,

76 
dwSize
, &dwSize))

78 
	`PyEº_SëFromWödowsEº
(0);

79 
	`‰ì
(
pBuf„r
);

84 
ç
 = (
TOKEN_PRIVILEGES
 *)
pBuf„r
;

87 
i
 = 0; i < 
ç
->
PrivûegeCou¡
; i++) {

89 
	`°r˝y
(
¥ivName
, "");

90 
dwNameSize
 = (
¥ivName
Ë/ (
TCHAR
);

91 i‡(! 
	`LookupPrivûegeName
(
NULL
,

92 &
ç
->
Privûeges
[
i
].
Luid
,

93 (
LPTSTR
)
¥ivName
,

94 &
dwNameSize
))

96 
	`PyEº_SëFromWödowsEº
(0);

97 
	`‰ì
(
pBuf„r
);

102 i‡(! 
	`l°rcmpi
(
¥ivName
, 
	`TEXT
("SeTcbPrivilege"))) {

103 
	`‰ì
(
pBuf„r
);

108 
	`‰ì
(
pBuf„r
);

110 
	}
}

113 
BOOL


114 
	$psutû_£t_¥ivûege
(
HANDLE
 
hTokí
, 
LPCTSTR
 
Privûege
, 
BOOL
 
bE«bÀPrivûege
)

116 
TOKEN_PRIVILEGES
 
ç
;

117 
LUID
 
luid
;

118 
TOKEN_PRIVILEGES
 
çPªvious
;

119 
DWORD
 
cbPªvious
 = (
TOKEN_PRIVILEGES
);

121 i‡(!
	`LookupPrivûegeVÆue
–
NULL
, 
Privûege
, &
luid
 )Ë 
FALSE
;

124 
ç
.
PrivûegeCou¡
 = 1;

125 
ç
.
Privûeges
[0].
Luid
 = 
luid
;

126 
ç
.
Privûeges
[0].
Aâribuãs
 = 0;

128 
	`Adju°TokíPrivûeges
(

129 
hTokí
,

130 
FALSE
,

131 &
ç
,

132 (
TOKEN_PRIVILEGES
),

133 &
çPªvious
,

134 &
cbPªvious


137 i‡(
	`GëLa°Eº‹
(Ë!
ERROR_SUCCESS
Ë 
FALSE
;

140 
çPªvious
.
PrivûegeCou¡
 = 1;

141 
çPªvious
.
Privûeges
[0].
Luid
 = 
luid
;

143 i‡(
bE«bÀPrivûege
) {

144 
çPªvious
.
Privûeges
[0].
Aâribuãs
 |(
SE_PRIVILEGE_ENABLED
);

148 
çPªvious
.
Privûeges
[0].
Aâribuãs
 ^=

149 (
SE_PRIVILEGE_ENABLED
 & 
çPªvious
.
Privûeges
[0].
Aâribuãs
);

152 
	`Adju°TokíPrivûeges
(

153 
hTokí
,

154 
FALSE
,

155 &
çPªvious
,

156 
cbPªvious
,

157 
NULL
,

158 
NULL


161 i‡(
	`GëLa°Eº‹
(Ë!
ERROR_SUCCESS
Ë 
FALSE
;

163  
TRUE
;

164 
	}
}

168 
	$psutû_£t_£_debug
()

170 
HANDLE
 
hTokí
;

171 i‡(! 
	`O≥nThªadTokí
(
	`GëCuºítThªad
(),

172 
TOKEN_ADJUST_PRIVILEGES
 | 
TOKEN_QUERY
,

173 
FALSE
,

174 &
hTokí
)

176 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_NO_TOKEN
) {

177 i‡(!
	`Im≥rs⁄©eSñf
(
SecurôyIm≥rs⁄©i⁄
)) {

178 
	`Clo£H™dÀ
(
hTokí
);

181 i‡(!
	`O≥nThªadTokí
(
	`GëCuºítThªad
(),

182 
TOKEN_ADJUST_PRIVILEGES
 | 
TOKEN_QUERY
,

183 
FALSE
,

184 &
hTokí
)

186 
	`RevîtToSñf
();

187 
	`Clo£H™dÀ
(
hTokí
);

194 i‡(! 
	`psutû_£t_¥ivûege
(
hTokí
, 
SE_DEBUG_NAME
, 
TRUE
)) {

195 
	`RevîtToSñf
();

196 
	`Clo£H™dÀ
(
hTokí
);

200 
	`RevîtToSñf
();

201 
	`Clo£H™dÀ
(
hTokí
);

203 
	}
}

207 
	$psutû_un£t_£_debug
()

209 
HANDLE
 
hTokí
;

210 i‡(! 
	`O≥nThªadTokí
(
	`GëCuºítThªad
(),

211 
TOKEN_ADJUST_PRIVILEGES
 | 
TOKEN_QUERY
,

212 
FALSE
,

213 &
hTokí
)

215 i‡(
	`GëLa°Eº‹
(Ë=
ERROR_NO_TOKEN
) {

216 i‡(! 
	`Im≥rs⁄©eSñf
(
SecurôyIm≥rs⁄©i⁄
)) {

220 i‡(!
	`O≥nThªadTokí
(
	`GëCuºítThªad
(),

221 
TOKEN_ADJUST_PRIVILEGES
 | 
TOKEN_QUERY
,

222 
FALSE
,

223 &
hTokí
)

232 i‡(! 
	`psutû_£t_¥ivûege
(
hTokí
, 
SE_DEBUG_NAME
, 
FALSE
)) {

236 
	`Clo£H™dÀ
(
hTokí
);

238 
	}
}

	@E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\security.h

10 
	~<wödows.h
>

12 
BOOL
 
psutû_£t_¥ivûege
(
HANDLE
 
hTokí
, 
LPCTSTR
 
Privûege
, BOOL 
bE«bÀPrivûege
);

13 
HANDLE
 
psutû_tokí_‰om_h™dÀ
(HANDLE 
hPro˚ss
);

14 
psutû_has_sy°em_¥ivûege
(
HANDLE
 
hPro˚ss
);

15 
psutû_£t_£_debug
();

16 
psutû_un£t_£_debug
();

	@
1
.
0
46
3505
E:\GitHub\ChromeFuzzer\PocSmplify\GrayHatPython-master\ghpython_src\src\addnum.cpp
E:\GitHub\ChromeFuzzer\PocSmplify\GrayHatPython-master\ghpython_src\src\ghp_inject.cpp
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\Exception.c
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\Exception.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\MacDll.c
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\MacDll.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\MacX.c
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\dyld.c
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\dyld.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\implementation.c
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\implementation.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\main.c
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\MacOSX\macdll\windows.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\olly_callbacks.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\olly_redefines.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\paimei_ollydbg_connector.cpp
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\paimei_ollydbg_connector.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\plugin.h
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\stdafx.cpp
E:\GitHub\ChromeFuzzer\PocSmplify\paimei-master\ollydbg_connector\stdafx.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_bsd.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_bsd.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_common.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_common.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_linux.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_linux.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_osx.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_osx.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_posix.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_posix.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_sunos.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_sunos.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_windows.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\_psutil_windows.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\bsd\process_info.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\bsd\process_info.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\osx\process_info.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\osx\process_info.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\glpi.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\ntextapi.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_handles.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_handles.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_info.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\process_info.h
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\security.c
E:\GitHub\ChromeFuzzer\PocSmplify\psutil-master\psutil\arch\windows\security.h
